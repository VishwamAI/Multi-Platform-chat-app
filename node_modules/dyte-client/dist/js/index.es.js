import*as e from"react";import t,{useState as n,useEffect as i,useContext as r,createContext as o,useRef as a,Component as s,useCallback as c,memo as l}from"react";import{useDispatch as u,useSelector as d,batch as p,Provider as m,useStore as f}from"react-redux";import{createAction as h,createReducer as g,configureStore as v,nanoid as y}from"@reduxjs/toolkit";import{v4 as b}from"uuid";import{createStandaloneToast as E,Stack as w,Spinner as S,Text as _,Button as k,HStack as C,ChakraProvider as x,extendTheme as T,Img as I,Box as P,OrderedList as A,ListItem as O,Modal as D,ModalOverlay as N,ModalContent as R,useDisclosure as M,useClipboard as z,Flex as L,Center as j,InputGroup as B,Input as F,InputRightAddon as V,IconButton as W,Icon as U,ModalCloseButton as q,useOutsideClick as H,Avatar as G,useTheme as J,Divider as Y,Spacer as K,Grid as Z,ModalBody as Q,InputLeftElement as X,Fade as $,Heading as ee,VStack as te,Tooltip as ne,Image as ie,AlertDialog as re,AlertDialogOverlay as oe,AlertDialogContent as ae,AlertDialogHeader as se,AlertDialogBody as ce,AlertDialogFooter as le,Menu as ue,MenuButton as de,MenuList as pe,MenuDivider as me,MenuOptionGroup as fe,MenuItemOption as he,MenuItem as ge,Textarea as ve,Checkbox as ye,Badge as be,InputRightElement as Ee,Link as we,Tabs as Se,TabPanels as _e,TabPanel as ke,Popover as Ce,PopoverTrigger as xe,PopoverContent as Te,PopoverHeader as Ie,PopoverFooter as Pe,ModalHeader as Ae,ModalFooter as Oe,PopoverArrow as De,PopoverCloseButton as Ne,Alert as Re,AlertIcon as Me,AlertTitle as ze,AlertDescription as Le,TabList as je,Tab as Be,useStyleConfig as Fe,FormControl as Ve,FormLabel as We}from"@chakra-ui/react";import Ue from"logrocket";import{GraphQLClient as qe,ClientContext as He,useMutation as Ge,useManualQuery as Je}from"graphql-hooks";import{Refresh as Ye,Check as Ke,ContentCopy as Ze,MicOff as Qe,Fullscreen as Xe,ScreenShare as $e,PushPin as et,Search as tt,Visibility as nt,GppGood as it,Lock as rt,Group as ot,Close as at,OpenInFull as st,CloseFullscreen as ct,StopScreenShare as lt,Notifications as ut,ChevronLeft as dt,ChevronRight as pt,AutoFixHigh as mt,FiberManualRecord as ft,DisabledByDefault as ht,PictureInPicture as gt,MoreVert as vt,Add as yt,Download as bt,ArrowDownward as Et,InsertDriveFile as wt,Poll as St,Image as _t,Send as kt,VerticalAlignBottom as Ct,Mic as xt,Videocam as Tt,VideocamOff as It,FullscreenExit as Pt,ViewSidebar as At,ViewModule as Ot,Chat as Dt,Groups as Nt,Share as Rt,VoiceOverOff as Mt,CallEnd as zt,ExpandMore as Lt,ExpandLess as jt,VolumeOff as Bt,PlayArrow as Ft,VolumeUp as Vt,SignalCellularAlt as Wt}from"@styled-icons/material-rounded";import"@styled-icons/boxicons-logos";import{StyledIconBase as Ut}from"@styled-icons/styled-icon";import qt from"bowser";import{mode as Ht,cssVar as Gt}from"@chakra-ui/theme-tools";import Jt from"axios";import Yt,{EventEmitter as Kt}from"events";import{CallStats as Zt}from"@dyteinternals/callstats";import{ClientEnvType as Qt}from"@dyteinternals/callstats/dist/types";import Xt from"classnames";import $t from"hark";import{ThemeContext as en}from"@emotion/react";import{Device as tn}from"@dytesdk/mediasoup-client";import nn from"socket.io-client";import rn,{createPortal as on}from"react-dom";import an from"react-shadow/emotion";import sn from"i18next";import{initReactI18next as cn,useTranslation as ln}from"react-i18next";import{motion as un,AnimatePresence as dn}from"framer-motion";import{useForm as pn}from"react-hook-form";import mn from"hotkeys-js";import fn from"react-intersection-observer";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var hn=function(e,t){return(hn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function gn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}hn(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var vn,yn=function(){return(yn=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function bn(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function En(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))}function wn(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function Sn(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var _n,kn,Cn,xn,Tn=h("session/join-room"),In=h("websocket/room-state"),Pn=h("websocket/peer-joined"),An=h("websocket/peer-closed"),On=h("session/reset-peers"),Dn=h("websocket/get-page"),Nn=h("websocket/selected-peers"),Rn=h("websocket/peer-muted"),Mn=h("websocket/peer-visibility"),zn=h("websocket/peer-unmuted"),Ln=h("session/set-peer-video-transform"),jn=h("websocket/peer-added-to-stage"),Bn=h("websocket/peer-rejected-to-join-stage"),Fn=h("websocket/peer-removed-from-stage"),Vn=h("websocket/peer-started-presenting"),Wn=h("websocket/peer-stopped-presenting"),Un=h("session/all-peer-visibility"),qn=h("session/switch-webinar"),Hn=h("websocket/metadata-update"),Gn=h("session/peer-label"),Jn=g({joinedPeers:[],currentPagePeerIds:[],activeSpeakerPagePeerIds:[],recordingPeer:null,videoTransforms:{}},((vn={})[On.toString()]=function(e){e.joinedPeers=[],e.recordingPeer=null},vn[Dn.toString()]=function(e,t){e.currentPagePeerIds=Sn([],t.payload.peerIds,!0)},vn[Nn.toString()]=function(e,t){e.activeSpeakerPagePeerIds=Sn([],t.payload.peerIds,!0)},vn[Tn.toString()]=function(e,t){var n=t.payload.peers;e.recordingPeer=n?n.find((function(e){var t;return null===(t=e.flags)||void 0===t?void 0:t.recorder})):null,e.joinedPeers=n?n.filter((function(e){var t;return!(null===(t=e.flags)||void 0===t?void 0:t.recorder)})):[]},vn[In.toString()]=function(e,t){var n=t.payload.roomState.peers;e.recordingPeer=n?n.find((function(e){var t;return null===(t=e.flags)||void 0===t?void 0:t.recorder})):null,e.joinedPeers=n?n.filter((function(e){var t;return!(null===(t=e.flags)||void 0===t?void 0:t.recorder)})):[]},vn[Pn.toString()]=function(e,t){var n,i=t.payload;(null===(n=i.flags)||void 0===n?void 0:n.recorder)?e.recordingPeer=i:e.joinedPeers=e.joinedPeers.filter((function(e){return e.id!==i.id})).concat(i)},vn[An.toString()]=function(e,t){var n,i=t.payload;(null===(n=e.recordingPeer)||void 0===n?void 0:n.id)===i.id?e.recordingPeer=null:e.joinedPeers=e.joinedPeers.filter((function(e){return e.id!==i.id}))},vn[Mn.toString()]=function(e,t){var n=e.joinedPeers.find((function(e){return e.id===t.payload.peerId}));n&&(n.hiddenParticipant=t.payload.visibility,e.joinedPeers=e.joinedPeers.filter((function(e){return e.id!==n.id})).concat([yn({},n)]))},vn[Un.toString()]=function(e,t){e.joinedPeers=e.joinedPeers.map((function(e){return e.flags.recorder||(e.hiddenParticipant=t.payload.hidden),e}))},vn[Rn.toString()]=function(e,t){var n=e.joinedPeers.find((function(e){return e.id===t.payload.peerId}));n&&(n.audioMuted=!0,e.joinedPeers=e.joinedPeers.filter((function(e){return e.id!==n.id})).concat([yn({},n)]))},vn[zn.toString()]=function(e,t){var n=e.joinedPeers.find((function(e){return e.id===t.payload.peerId}));n&&(n.audioMuted=!1,e.joinedPeers=e.joinedPeers.filter((function(e){return e.id!==n.id})).concat([yn({},n)]))},vn[Ln.toString()]=function(e,t){e.videoTransforms[t.peerId]=t.transform},vn[jn.toString()]=function(e,t){var n=e.joinedPeers.find((function(e){return e.id===t.payload.id}));n&&(n.requestToJoinType=t.payload.requestToJoinType,e.joinedPeers=e.joinedPeers.filter((function(e){return e.id!==n.id})).concat([yn({},n)]))},vn[Bn.toString()]=function(e,t){var n=e.joinedPeers.find((function(e){return e.id===t.payload.id}));n&&(n.webinarHiddenParticipant=!0,e.joinedPeers=e.joinedPeers.filter((function(e){return e.id!==n.id})).concat([yn({},n)]))},vn[Fn.toString()]=function(e,t){var n=e.joinedPeers.find((function(e){return e.id===t.payload.id}));n&&(delete n.requestToJoinType,n.webinarHiddenParticipant=!0,n.audioMuted=!0,e.joinedPeers=e.joinedPeers.filter((function(e){return e.id!==n.id})).concat([yn({},n)]))},vn[Vn.toString()]=function(e,t){var n=e.joinedPeers.find((function(e){return e.id===t.payload.id}));n&&(n.webinarHiddenParticipant=!1,e.joinedPeers=e.joinedPeers.filter((function(e){return e.id!==n.id})).concat([yn({},n)]))},vn[Wn.toString()]=function(e,t){var n=e.joinedPeers.find((function(e){return e.id===t.payload.id}));n&&(delete n.requestToJoinType,n.webinarHiddenParticipant=!0,n.audioMuted=!0,e.joinedPeers=e.joinedPeers.filter((function(e){return e.id!==n.id})).concat([yn({},n)]))},vn[qn.toString()]=function(e,t){e.joinedPeers=Sn([],e.joinedPeers.map((function(e){return e.webinarHiddenParticipant=!0,e})),!0)},vn[Hn.toString()]=function(e,t){var n=e.joinedPeers.find((function(e){return e.id===t.payload.id}));n&&(n.metadata.preset_name=t.payload.preset_name,n.metadata.view_type=t.payload.view_type,e.joinedPeers=e.joinedPeers.filter((function(e){return e.id!==n.id})).concat([yn({},n)]))},vn[Gn.toString()]=function(e,t){var n=e.joinedPeers.find((function(e){return e.id===t.payload.id}));n&&(n.label=t.payload.label,e.joinedPeers=e.joinedPeers.filter((function(e){return e.id!==n.id})).concat([yn({},n)]))},vn));!function(e){e.NOT_STARTED="NOT_STARTED",e.CONNECTING="CONNECTING",e.FETCHED="FETCHED",e.LOADED="LOADED",e.STOPPING="STOPPING",e.NOT_APPLICABLE="NOT_APPLICABLE"}(kn||(kn={})),function(e){e.NOT_STARTED="NOT_STARTED",e.CONNECTED="CONNECTED",e.DISCONNECTED="DISCONNECTED",e.ERRORED="ERRORED",e.RECONNECT="RECONNECT"}(Cn||(Cn={})),function(e){e[e.NONE=0]="NONE",e[e.WAITING=1]="WAITING",e[e.ACCEPTED=2]="ACCEPTED",e[e.REJECTED=3]="REJECTED"}(xn||(xn={}));var Yn={initialGUMFetch:!1,routerState:kn.NOT_APPLICABLE,producersState:kn.NOT_APPLICABLE,roomDisplayTitleState:kn.NOT_STARTED,socketState:Cn.NOT_STARTED,polls:{},chatMessages:[],legacyMode:!1,joined:!1,roomDisplayTitle:"",activeSpeakerPeerId:"",roomUUID:"",startedAt:null,pipMode:!1,maxPreferredStreams:10,roomNodeLink:"",waitingState:xn.NONE,waitlistedPeers:[],password:"",roomName:"",gridView:"multi",gridViewSaved:"multi",currentPage:0,pinnedPeerId:null,kicked:"",presetFetched:!1,roomViewType:null,requestToJoinPeersList:[],selectedScreenSharingPeer:""},Kn=h("session/set-pip-mode"),Zn=h("websocket/router-capability");h("websocket/create-transport"),h("websocket/connect-transport");var Qn=h("session/socket-state"),Xn=h("session/preset-fetched"),$n=h("session/router-state"),ei=h("session/room-display-title-state"),ti=h("session/room-node-link"),ni=h("session/producers-state"),ii=h("session/reset-room"),ri=h("session/set-room-name"),oi=h("session/initial-get-user-media-fetch"),ai=h("websocket/new-chat-message"),si=h("websocket/get-chat-messages"),ci=h("websocket/get-polls"),li=h("websocket/update-poll"),ui=h("websocket/room-legacy-mode"),di=h("websocket/room-state"),pi=h("websocket/room-display-title"),mi=h("websocket/active-speaker"),fi=h("websocket/no-active-speaker"),hi=h("websocket/waitlist-accepted"),gi=h("websocket/waitlist-rejected"),vi=h("websocket/waitlist-peer-added"),yi=h("websocket/waitlist-peer-closed"),bi=h("session/room-password"),Ei=h("session/mark-messages-read"),wi=h("session/room-grid-view"),Si=h("websocket/pin-peer"),_i=h("websocket/kicked"),ki=h("websocket/room-view-type"),Ci=h("session/set-current-page"),xi=h("websocket/request-to-join-stage-peer-added"),Ti=h("websocket/peer-added-to-stage"),Ii=h("websocket/peer-rejected-to-join-stage"),Pi=h("room/seen-all-participant"),Ai=h("session/set-active-screenshare"),Oi=g(Yn,((_n={})[ii.toString()]=function(e){Object.keys(Yn).forEach((function(t){e[t]=Yn[t]}))},_n[Qn.toString()]=function(e,t){e.socketState=t.payload},_n[$n.toString()]=function(e,t){e.routerState=t.payload},_n[Xn.toString()]=function(e,t){e.presetFetched=t.payload},_n[oi.toString()]=function(e,t){e.initialGUMFetch=t.payload},_n[Zn.toString()]=function(e){e.routerState=kn.FETCHED},_n[ki.toString()]=function(e,t){e.roomViewType=t.payload},_n[ai.toString()]=function(e,t){e.chatMessages=Sn(Sn([],e.chatMessages,!0),[yn(yn({},t.payload),{read:!1})],!1)},_n[si.toString()]=function(e,t){e.chatMessages=t.payload.messages.map((function(e){return yn(yn({},e),{read:!0})}))},_n[Ei.toString()]=function(e,t){e.chatMessages=e.chatMessages.map((function(e){return t.payload&&e.type!==t.payload?e:yn(yn({},e),{read:!0})}))},_n[li.toString()]=function(e,t){var n=t.payload.poll;e.polls[n.id]=n},_n[ci.toString()]=function(e,t){e.polls=t.payload.polls},_n[pi.toString()]=function(e,t){e.roomDisplayTitle=t.payload.displayTitle},_n[ei.toString()]=function(e,t){e.roomDisplayTitleState=t.payload},_n[di.toString()]=function(e,t){var n=t.payload.roomState,i=n.roomUUID,r=n.displayTitle,o=n.roomName;e.roomDisplayTitle=r,e.roomUUID=i,e.roomName=o},_n[Tn.toString()]=function(e,t){e.legacyMode=t.payload.legacyMode||Yn.legacyMode,e.startedAt=t.payload.waitlisted?null:t.payload.startedAt,e.maxPreferredStreams=t.payload.maxPreferredStreams||Yn.maxPreferredStreams,e.joined=!0,e.waitingState=t.payload.waitlisted?xn.WAITING:xn.NONE,e.pinnedPeerId=t.payload.pinnedPeerId,e.gridView=t.payload.pinnedPeerId?"highlighted":e.gridView,t.payload.waitlistedPeers&&(e.waitlistedPeers=t.payload.waitlistedPeers),t.payload.requestToJoinPeersList&&(e.requestToJoinPeersList=t.payload.requestToJoinPeersList)},_n[ui.toString()]=function(e,t){e.legacyMode=t.payload.turnOn},_n[Ci.toString()]=function(e,t){e.currentPage=t.payload},_n[mi.toString()]=function(e,t){e.activeSpeakerPeerId=t.payload.peerId},_n[fi.toString()]=function(e){e.activeSpeakerPeerId=""},_n[ni.toString()]=function(e,t){e.producersState=t.payload},_n[ti.toString()]=function(e,t){e.roomNodeLink=t.payload},_n[hi.toString()]=function(e,t){e.waitingState=xn.ACCEPTED},_n[gi.toString()]=function(e,t){e.waitingState=xn.REJECTED},_n[vi.toString()]=function(e,t){e.waitlistedPeers=Sn(Sn([],e.waitlistedPeers.filter((function(e){return e.id!==t.payload.id})),!0),[t.payload],!1)},_n[yi.toString()]=function(e,t){e.waitlistedPeers=e.waitlistedPeers.filter((function(e){return e.id!==t.payload.id}))},_n[bi.toString()]=function(e,t){e.password=t.payload},_n[wi.toString()]=function(e,t){e.gridView=t.payload},_n[Si.toString()]=function(e,t){t.payload.peerId?(e.gridViewSaved=e.gridViewSaved?e.gridViewSaved:e.gridView,e.gridView="highlighted"):(e.gridView=e.gridViewSaved,e.gridViewSaved=null),e.pinnedPeerId=t.payload.peerId},_n[_i.toString()]=function(e,t){var n,i;(null===(n=t.payload)||void 0===n?void 0:n.kickType)||(e.kicked="unknown"),e.kicked=null===(i=t.payload)||void 0===i?void 0:i.kickType},_n[ri.toString()]=function(e,t){e.roomName=t.payload.roomName},_n[xi.toString()]=function(e,t){e.requestToJoinPeersList=Sn(Sn([],e.requestToJoinPeersList.filter((function(e){return e.id!==t.payload.id})),!0),[yn(yn({},t.payload),{seen:!1})],!1)},_n[Ii.toString()]=function(e,t){e.requestToJoinPeersList=e.requestToJoinPeersList.filter((function(e){return e.id!==t.payload.id}))},_n[Ti.toString()]=function(e,t){e.requestToJoinPeersList=e.requestToJoinPeersList.filter((function(e){return e.id!==t.payload.id}))},_n[Pi.toString()]=function(e){e.requestToJoinPeersList=Sn([],e.requestToJoinPeersList.map((function(e){return e.seen=!0,e})),!0)},_n[An.toString()]=function(e,t){e.requestToJoinPeersList=e.requestToJoinPeersList.filter((function(e){return e.id!==t.payload.id}))},_n[Kn.toString()]=function(e,t){e.pipMode=t.payload},_n[Ai.toString()]=function(e,t){e.selectedScreenSharingPeer=t.payload},_n)),Di=E({colorMode:"light"});function Ni(){return{width:window.innerWidth,height:window.innerHeight}}var Ri,Mi,zi,Li,ji,Bi,Fi,Vi,Wi,Ui,qi,Hi=function(){var e=n(Ni()),t=e[0],r=e[1];return i((function(){function e(){r(Ni())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),t};!function(e){e.skip="SKIP",e.onAccept="ON_ACCEPT",e.skipOnPrivilegedUserEntry="SKIP_ON_PRIVILEGED_USER_ENTRY",e.skipOnAccept="ON_ACCEPT"}(Ri||(Ri={})),function(e){e.groupCall="GROUP_CALL",e.webinar="WEBINAR",e.audioRoom="AUDIO_ROOM"}(Mi||(Mi={})),function(e){e.AUDIO="AUDIO",e.VIDEO="VIDEO",e.SPEAKER="SPEAKER"}(zi||(zi={})),function(e){e[e.REQUESTED_BY_PARTICIPANT=0]="REQUESTED_BY_PARTICIPANT",e[e.REQUESTED_BY_MODERATOR=1]="REQUESTED_BY_MODERATOR"}(Li||(Li={})),function(e){e.PARTICIPANT="PARTICIPANT",e.PEER="PEER",e.CLIENT="CLIENT"}(ji||(ji={})),function(e){e.QUICK_ZOOM="quick_zoom",e.INTERNAL_CALL_STATS="internal_call_stats",e.CFWS="cfws",e.LOGROCKET="logrocket",e.SIMULCAST="simulcast",e.SOCKET_POLLING="socket_polling",e.SOCKET_PINGSTATS="socket_pingstats",e.SKIP_REACQUIRE_AUDIO="skip_reacquire_audio",e.NOTIFY_AUDIO_TRACK_SILENCE="notify_audio_track_silence"}(Bi||(Bi={})),function(e){e.ALLOWED="allowed",e.ON_REQUEST="on_request",e.NOT_ALLOWED="not_allowed"}(Vi||(Vi={})),function(e){e[e.PRESENTING=0]="PRESENTING",e[e.NOT_PRESENTING=1]="NOT_PRESENTING",e[e.INITIATED=2]="INITIATED"}(Wi||(Wi={})),function(e){e[e.NONE=0]="NONE",e[e.WAITING=1]="WAITING",e[e.ACCEPTED=2]="ACCEPTED",e[e.REJECTED=3]="REJECTED",e[e.INITIATED=4]="INITIATED"}(Ui||(Ui={})),function(e){e.present="REQUEST_TO_PRESENT",e.ask="REQUEST_TO_ASK"}(qi||(qi={}));var Gi=h("participant/set-user"),Ji=h("participant/set-user-error"),Yi=h("participant/set-token"),Ki=h("participant/set-user-permission"),Zi=h("participant/set-logged-in"),Qi=h("participant/set-display-name"),Xi=h("participant/set-display-image"),$i=h("participant/set-video-production"),er=h("participant/set-audio-production"),tr=h("participant/set-screen-sharing-production"),nr=h("participant/set-audio-muted"),ir=h("participant/set-screen-sharing"),rr=h("participant/set-video-off"),or=h("participant/set-video-track-selection"),ar=h("participant/set-audio-track-selection"),sr=h("participant/set-speaker-track-selection"),cr=h("session/reset-pariticipant"),lr=h("websocket/mute-all"),ur=h("websocket/mute-all-video"),dr=h("websocket/disable-audio"),pr=h("websocket/disable-video"),mr=h("websocket/device-changed"),fr=h("websocket/visibility-settings"),hr=h("websocket/update-webinar-update-setting"),gr=h("websocket/update_can_update"),vr=h("websocket/request-to-join-stage-accepted"),yr=h("websocket/request-to-join-stage-rejected"),br=h("websocket/removed-from-stage"),Er=h("room/request-to-join-stage-state"),wr=h("participant/request-to-join-type"),Sr=h("websocket/started-presenting"),_r=h("websocket/stopped-presenting"),kr=h("participant/initiate-presenting"),Cr=h("websocket/peer-added-to-stage"),xr=h("websocket/update-userpreset");var Tr=g({id:"",peerId:b().toString(),device:"",email:"",displayName:"",authToken:"",organizationId:"",loggedIn:!1,displayImageURL:"",audioMuted:!1,deviceChanges:0,videoOff:!1,sharingScreen:!1,videoProduction:kn.NOT_STARTED,audioProduction:kn.NOT_STARTED,screenSharingProduction:kn.NOT_STARTED,shouldProduce:!0,canAllowParticipantAudio:!1,canAllowParticipantVideo:!1,canUnMute:!0,clientSpecificId:null,userFetchError:null,hidden:!1,webinarHiddenParticipant:!1,joinStageSettings:Vi.ALLOWED,requestToJoinStageState:Ui.NONE,presentingState:Wi.NOT_PRESENTING,canPresent:!1,metadata:{preset_name:"default",view_type:"GROUP_CALL"},preset:null},((Fi={})[cr.toString()]=function(e,t){e.sharingScreen=!1,e.videoProduction=kn.NOT_STARTED,e.audioProduction=kn.NOT_STARTED,t.payload||(e.videoOff=!1,e.webinarHiddenParticipant=!1,e.requestToJoinStageState=Ui.NONE,e.presentingState=Wi.NOT_PRESENTING),e.userFetchError=null},Fi[Gi.toString()]=function(e,t){e.authToken=t.payload.authToken,e.loggedIn=t.payload.loggedIn||!1,e.email=t.payload.email||"",e.displayImageURL=t.payload.picture||"",e.id=t.payload.id||"",e.clientSpecificId=t.payload.clientSpecificId,e.organizationId=t.payload.organizationId,e.videoOff="false"===localStorage.getItem("dyte-video"),t.payload.name&&t.payload.name.length>0&&(e.displayName=t.payload.name||"",localStorage.setItem("dyte-displayName",t.payload.name))},Fi[Ji.toString()]=function(e,t){e.userFetchError={code:t.payload.statusCode,message:t.payload.message}},Fi[fr.toString()]=function(e,t){var n=t.payload,i=n.hidden,r=n.joinStageSettings;e.hidden=i,e.joinStageSettings=r},Fi[hr.toString()]=function(e,t){e.webinarHiddenParticipant=t.payload},Fi[Yi.toString()]=function(e,t){e.authToken=t.payload,e.id=function(e){var t;return null===(t=JSON.parse(atob(e.split(".")[1])))||void 0===t?void 0:t.id}(t.payload)},Fi[Qi.toString()]=function(e,t){e.displayName=t.payload,localStorage.setItem("dyte-displayName",t.payload)},Fi[Xi.toString()]=function(e,t){e.displayImageURL=t.payload},Fi[Zi.toString()]=function(e,t){e.loggedIn=t.payload},Fi[gr.toString()]=function(e,t){e.canPresent=t.payload},Fi[$i.toString()]=function(e,t){e.videoProduction=t.payload},Fi[er.toString()]=function(e,t){e.audioProduction=t.payload},Fi[tr.toString()]=function(e,t){e.screenSharingProduction=t.payload},Fi[nr.toString()]=function(e,t){!1!==e.canUnMute&&(localStorage.setItem("dyte-audio",t.payload?"false":"true"),e.audioMuted=t.payload)},Fi[rr.toString()]=function(e,t){localStorage.setItem("dyte-video",t.payload?"false":"true"),e.videoOff=t.payload},Fi[or.toString()]=function(e,t){e.videoTrackSelection=t.payload},Fi[ar.toString()]=function(e,t){e.audioTrackSelection=t.payload},Fi[ir.toString()]=function(e,t){e.sharingScreen=t.payload},Fi[sr.toString()]=function(e,t){e.speakerTrackSelection=t.payload},Fi[Ki.toString()]=function(e,t){e.canAllowParticipantAudio=t.payload.canAllowParticipantAudio,e.canAllowParticipantVideo=t.payload.canAllowParticipantVideo},Fi[lr.toString()]=function(e,t){e.canAllowParticipantAudio||(e.audioMuted=!0,e.canUnMute=t.payload.allowUnMute)},Fi[ur.toString()]=function(e,t){e.canAllowParticipantVideo||(e.videoOff=!0)},Fi[dr.toString()]=function(e){e.audioMuted=!0},Fi[pr.toString()]=function(e){e.videoOff=!0},Fi[mr.toString()]=function(e){e.deviceChanges=e.deviceChanges+1},Fi[vr.toString()]=function(e,t){e.joinStageSettings=Vi.ALLOWED,e.requestToJoinStageState=Ui.ACCEPTED,e.presentingState=Wi.INITIATED,e.requestToJoinType=t.payload.requestToJoinType,e.canPresent=!0,Di({description:"Request Accepted",status:"success",duration:5e3,isClosable:!0,position:"top"})},Fi[yr.toString()]=function(e){e.webinarHiddenParticipant=!0,e.joinStageSettings=Vi.NOT_ALLOWED,e.requestToJoinStageState=Ui.REJECTED,e.presentingState=Wi.NOT_PRESENTING,e.screenSharingProduction=kn.NOT_STARTED,Di({description:"Request Rejected",status:"error",duration:5e3,isClosable:!0,position:"top"})},Fi[br.toString()]=function(e,t){e.webinarHiddenParticipant=!0,e.joinStageSettings=Vi.NOT_ALLOWED,e.audioMuted=!0,e.videoOff=!0,e.requestToJoinStageState=Ui.NONE,e.presentingState=Wi.NOT_PRESENTING,e.screenSharingProduction=kn.NOT_STARTED;var n=t.payload.type===Li.REQUESTED_BY_PARTICIPANT?"You are no longer Presenting":"Host has stopped you from Presenting";Di({description:n,status:"error",duration:5e3,isClosable:!0,position:"top"}),e.requestToJoinType=void 0,e.canPresent=!1},Fi[Er.toString()]=function(e,t){e.requestToJoinStageState=t.payload},Fi[wr.toString()]=function(e,t){e.requestToJoinType=t.payload},Fi[Sr.toString()]=function(e){e.webinarHiddenParticipant=!1,e.presentingState=Wi.PRESENTING},Fi[_r.toString()]=function(e){e.webinarHiddenParticipant=!0,e.presentingState=Wi.NOT_PRESENTING,e.screenSharingProduction=kn.NOT_STARTED,e.sharingScreen=!1},Fi[kr.toString()]=function(e){e.presentingState=Wi.INITIATED},Fi[Cr.toString()]=function(e,t){t.payload.id===e.peerId&&(e.requestToJoinType=t.payload.requestToJoinType)},Fi[xr.toString()]=function(e,t){e.preset=t.payload.preset},Fi[Hn.toString()]=function(e,t){e.peerId===t.payload.id&&(e.metadata.preset_name=t.payload.preset_name,e.metadata.view_type=t.payload.view_type)},Fi));var Ir=".dyte-client {\n  font-size: 14px;\n  margin: 0;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.dyte-client video {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.dyte-client-selfVideo {\n  position: fixed;\n  bottom: var(--chakra-fontSizes-md);\n  left: var(--chakra-fontSizes-md);\n}\n\n.dyte-client-selfVideo video {\n  position: fixed;\n  bottom: var(--chakra-fontSizes-md);\n  left: var(--chakra-fontSizes-md);\n  object-position: right;\n  object-fit: contain;\n  transform: scaleX(-1);\n}\n\n.dyte-client-centerAligned {\n  justify-self: center;\n}\n\n#dyte-base-elem button:focus {\n  box-shadow: unset !important;\n}\n\n.dyte-client-videoOverlay {\n  position: absolute !important;\n  bottom: var(--chakra-fontSizes-md);\n  right: var(--chakra-fontSizes-md);\n  width: 100%;\n}\n\n.dyte-client-muteIcon {\n  float: left;\n  position: absolute;\n  margin-top: calc(0.5 * var(--chakra-fontSizes-md));\n  right: var(--chakra-fontSizes-md);\n}\n\n.dyte-client-name {\n  float: right;\n  position: absolute;\n  margin-top: calc(0.5 * var(--chakra-fontSizes-md));\n  left: 1em;\n}\n\n.dyte-client-discussion {\n  margin: 0 auto;\n  display: flex;\n  flex-flow: column wrap;\n}\n\n.dyte-client-bubble {\n  padding: calc(0.35 * var(--chakra-fontSizes-md))\n    calc(0.8 * var(--chakra-fontSizes-md));\n  margin: 0.0625em;\n  min-width: 35px;\n  max-width: 200px;\n  animation: bubble-slide 0.15s ease-in;\n}\n\n.dyte-client-bubble span {\n  white-space: pre-wrap;\n}\n\n.dyte-polls {\n  max-width: 250px;\n}\n\n.dyte-client-chat-timestamp {\n  font-variant-numeric: tabular-nums;\n}\n\n.dyte-client-bubble.dyte-client-self {\n  border-radius: 1em;\n  align-self: flex-end;\n  background-color: var(--chakra-colors-primary-500);\n  color: var(--chakra-colors-text-100);\n  text-align: left;\n  text-justify: auto;\n}\n\n.dyte-client-bubble.dyte-client-type-3 {\n  background-color: var(--chakra-colors-secondary-800);\n  padding-bottom: var(--chakra-fontSizes-md);\n  width: 200px;\n}\n\n.dyte-client-bubble.dyte-client-other {\n  border-radius: 1.2em 1.2em 1.2em 1.2em;\n  align-self: flex-start;\n  background-color: var(--chakra-colors-secondary-800);\n  color: var(--chakra-colors-text-100);\n  text-align: left;\n  margin-left: calc(0.3 * var(--chakra-fontSizes-md));\n}\n\n.dyte-client-user {\n  font-size: var(--chakra-fontSizes-sm);\n  margin-left: calc(3 * var(--chakra-fontSizes-md));\n  margin-bottom: calc(0.15 * var(--chakra-fontSizes-md));\n  color: var(--chakra-colors-text-200);\n}\n\n.dyte-client-chatInput:focus {\n  background-color: var(--chakra-colors-secondary-1000);\n}\n\n/*\n  input:placeholder-shown {\n\t  background-color: var(--chakra-colors-secondary-800);\n  }\n\n  input.dark:placeholder-shown {\n\t  background-color: #171717;\n\n  }*/\n\n.dyte-client-otherText.dyte-client-last,\n.dyte-client-selfText.dyte-client-last {\n  margin-bottom: 1.7em;\n}\n\n.dyte-client-otherText.dyte-client-only,\n.dyte-client-selfText.dyte-client-only {\n  margin-bottom: 1.7em;\n}\n\n.dyte-client-first.dyte-client-self {\n  border-bottom-right-radius: 0.1em;\n}\n\n.dyte-client-bubble.dyte-client-self.dyte-client-first {\n  border-bottom-right-radius: 0.1em;\n}\n\n.dyte-client-bubble.dyte-client-self.dyte-client-last {\n  border-top-right-radius: 0.1em;\n  margin-bottom: 0;\n}\n\n.dyte-client-bubble.dyte-client-self.dyte-client-middle {\n  border-top-right-radius: 0.1em;\n  border-bottom-right-radius: 0.1em;\n}\n\n.dyte-client-bubble.dyte-client-other.dyte-client-first {\n  border-bottom-left-radius: 0.1em;\n}\n\n.dyte-client-bubble.dyte-client-other.dyte-client-last {\n  border-top-left-radius: 0.1em;\n  margin-bottom: 0;\n}\n\n.dyte-client-bubble.dyte-client-other.dyte-client-only,\n.dyte-client-bubble.dyte-client-self.dyte-client-only {\n  margin-bottom: 0;\n}\n\n.dyte-client-bubble.dyte-client-other.dyte-client-middle {\n  border-bottom-left-radius: 0.1em;\n  border-top-left-radius: 0.1em;\n}\n\n.dyte-client-outerContainer {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n\n.dyte-client-eventContainer {\n  flex: 1 1 auto;\n}\n\n.chakra-checkbox__label {\n  overflow-wrap: anywhere;\n}\n\n.dyte-client-videoStatic {\n  background-color: rgba(255, 255, 255, 0.2);\n  backdrop-filter: blur(4px);\n  padding: 0.7em;\n  visibility: hidden;\n  z-index: 10;\n  opacity: 0;\n  transition: opacity 1s ease-out;\n  transition: background-color 1s;\n}\n\n.dyte-client-videoStatic.dyte-client-active {\n  transition: box-shadow 1s;\n  -webkit-box-shadow: 0px 10px 30px 1px var(--chakra-colors-secondary-800);\n  -moz-box-shadow: 0px 10px 30px 1px var(--chakra-colors-secondary-800);\n  box-shadow: 0px 10px 30px 1px var(--chakra-colors-secondary-800);\n}\n\n.dyte-client-videoStatic.dyte-client-visible {\n  visibility: visible;\n  opacity: 1;\n}\n\n.dyte-client-videoHover:hover {\n  opacity: 1;\n  transition: background-color 1s;\n}\n\n.dyte-client-hideBackground {\n  background-color: rgba(255, 255, 255, 0) !important;\n  backdrop-filter: blur(0px) !important;\n}\n\n.dyte-client-controls {\n  display: flex;\n  width: -webkit-fill-available;\n  left: 0;\n  right: 0;\n  justify-content: center;\n}\n\n.dyte-client-round {\n  border-radius: 2em;\n}\n\n/* colorScheme bgColor bg nothing works*/\n\n.dyte-client-chatActive {\n  background: var(--chakra-colors-primary-300) !important;\n}\n\n.dyte-client option {\n  color: black;\n}\n\n.dyte-client-feedback {\n  border-radius: 0 !important;\n}\n\n.dyte-client-form-ui {\n  border-radius: 0 !important;\n}\n\n.dyte-client-form-ui:focus {\n  border: 1px solid var(--chakra-colors-primary-300) !important;\n}\n\n.dyte-client-form-ui:hover {\n  border: 1px solid var(--chakra-colors-primary-300) !important;\n}\n\n.dyte-client-mobileChat {\n  width: 100%;\n  text-shadow: 0px 0px 1px var(--chakra-colors-secondary-1000);\n}\n\n.dyte-client-selfText .dyte-client-user {\n  display: none;\n}\n\n.dyte-client-selfVideo .muteIcon {\n  position: absolute;\n  left: 0;\n}\n\n@keyframes bubble-slide {\n  0% {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  100% {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.dyte-client-invertOnly {\n  /* rotateY gives an issue on safari ipad, use this to flip horizontally */\n  -webkit-transform: scaleX(-1);\n  transform: scaleX(-1);\n}\n\n.dyte-client-activeSpeaker video {\n  border: 2px solid var(--chakra-colors-primary-300);\n}\n\n/* .dyte-client-activeSpeaker .dyte-client-peerVideo {\n  border: 2px solid var(--chakra-colors-primary-300);\n} */\n\n/*\n\tadd this class to remove the ugly blue box from links\n\tNOTE- it will override box-shadow and outline properties\n  */\n\n.dyte-client-removeFocusBox:focus {\n  box-shadow: none !important;\n  outline: none !important;\n}\n\n.dyte-client-scrollbar {\n\t/* For mozilla  */\n\tscrollbar-width: thin;\n\tscrollbar-color: var(--chakra-colors-secondary-700) var(--chakra-colors-secondary-1000);\n}\n\n/* For Blink/Webkit */\n.dyte-client-scrollbar::-webkit-scrollbar {\n\twidth: 6px;\n\tbackground-color: var(--chakra-colors-secondary-1000);\n}\n\n.dyte-client-scrollbar::-webkit-scrollbar-thumb {\n\tborder-radius: 9999px;\n\tbackground-color: var(--chakra-colors-secondary-700);\n}\n\n.dyte-client-noScrollbar {\n  scrollbar-width: none;\n}\n\n.dyte-client-noScrollbar::-webkit-scrollbar {\n  width: 0;\n  height: 0;\n}\n\n.dyte-client-noSelect {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n\n.dyte-client-selectable {\n  -webkit-touch-callout: text;\n  -webkit-user-select: text;\n  -khtml-user-select: text;\n  -moz-user-select: text;\n  -ms-user-select: text;\n  user-select: text;\n}\n\n.dyte-client-stageButton {\n  align-items: center;\n  background-color: var(--chakra-colors-secondary-800);\n  margin-left: 0px !important;\n  color: var(--chakra-colors-text-300);\n  width: 96px;\n  height: 56px;\n  justify-content: center;\n  display: inline-flex;\n  flex-direction: column;\n}\n\n.dyte-client-stageButton:focus {\n  outline: none;\n}\n\n.dyte-client-stageButton:hover {\n  background-color: var(--chakra-colors-secondary-900);\n}\n\n.dyte-client-mobileDrawer {\n  position: absolute;\n  bottom: 0;\n  background-color: var(--chakra-colors-secondary-1000);\n  width: 100%;\n  height: 82%;\n  border-top-left-radius: 4px;\n  border-top-right-radius: 4px;\n}\n\n.dyte-client-notificationBadge {\n  border-radius: 50%;\n  position: absolute;\n  border: solid 3px;\n  font-weight: bold;\n  font-size: 9px;\n  height:23px;\n  width:23px;\n  top: -1px;\n  z-index: 2;\n  right: 12px;\n}\n\n.dyte-badge-border{\n\tborder-color: var(--chakra-colors-secondary-1000);\n\ttransition: border-color 0.3s ease-out;\n}\n\n.dyte-badge-border-primary{\n\tborder-color: var(--chakra-colors-primary-500);\n\ttransition: border-color 0.3s ease-out;\n}\n.dyte-control-bar-btn-wrapper:hover .dyte-badge-border{\n\tborder:solid 3px var(--chakra-colors-secondary-800);\n\ttransition: border-color 0.3s ease-out;\n}\n\n.dyte-control-bar-btn-wrapper-small:hover .dyte-badge-border-primary{\n\tborder:solid 3px var(--chakra-colors-primary-700);\n\ttransition: border-color 0.3s ease-out;\n}\n\n.dyte-client-notificationBadge span {\n  display: inline-block;\n  padding-top: 50%;\n  padding-bottom: 50%;\n  margin-left: 0.25em;\n  margin-right: 0.3em;\n}\n\n.dyte-client-blink {\n  animation: blink 4s linear infinite;\n}\n\n@keyframes blink {\n  0%,\n  10% {\n    opacity: 0;\n  }\n  11%,\n  100% {\n    opacity: 1;\n  }\n}\n\n.dyte-client-screen-preview * {\n  -webkit-transition: width 300ms ease-in-out, height 300ms ease-in-out,\n    opacity 300ms ease-in-out 200ms;\n  -moz-transition: width 300ms ease-in-out, height 300ms ease-in-out,\n    opacity 300ms ease-in-out 200ms;\n  -o-transition: width 300ms ease-in-out, height 300ms ease-in-out,\n    opacity 300ms ease-in-out 200ms;\n  transition: width 300ms ease-in-out, height 300ms ease-in-out,\n    opacity 300ms ease-in-out 200ms;\n}\n\n.dyte-kvfysmfp {\n  overflow: hidden;\n  touch-action: none;\n  border-radius: 6px;\n  height: 100%;\n}\n\n.dyte-ufhsfnkm {\n  transform-origin: 0 0;\n}\n\n.dyte-fullWidth {\n  width: 100%;\n}\n\n.dyte-client a:hover {\n  color: var(--chakra-colors-text-100);\n}\n\n.dyte-client-type-1:hover .dyte-client-chat-img-actions {\n  display: block;\n}\n\n.dyte-client-bubble.dyte-client-type-1 {\n  padding: 0.4em;\n  border-radius: 6px;\n}\n\n.dyte-iframe {\n  height: 100%;\n}\n\n.dyte-meeting-title {\n  -webkit-line-clamp: 1;\n  -webkit-box-orient: vertical;\n}\n\n.dyte-clock {\n  font-variant-numeric: tabular-nums;\n}\n\n.dyte-peerview {\n  user-select: none;\n  -webkit-user-select: none;\n  -webkit-touch-callout: none;\n}\n\n#dyte-base-elem {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n\n.dyte-client ::-webkit-scrollbar {\n  width: 7px;\n  height: 5px;\n  background: var(--chakra-colors-secondary-1000);\n}\n\n.dyte-client ::-webkit-scrollbar-thumb {\n  background: var(--chakra-colors-secondary-800);\n  border-radius:7px;\n}\n\n.dyte-modal-content-container::-webkit-scrollbar{\n\tdisplay:none;\n}\n\n.make-session-layout{\n    flex-direction:row;\n\tjustify-content:center;\n}\n.make-session-spacer{\n    width:4rem;\n    height:3px;\n}\n.make-session-layout.mw800 {\n    flex-direction:column;\n}\n.make-session-spacer.mw800{\n    width:100%;\n    min-height:20px;\n    height:2rem;\n}\n.make-session-layout.mw800.mh600{\n    padding:2ex 0;\n    height: auto;\n\tjustify-content:flex-start;\n}\n\n.permission-denied-alert.mw800.mh600{\n\tfont-size:12px;\n}\n\n.permission-denied-alert-button.mw800.mh600{\n\tmax-width: 50px;\n}\n\n.make-session-layout.mh400.mw460{\n    padding:2ex 0;\n    height: auto;\n}";!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}(Ir);var Pr,Ar,Or,Dr=Ir,Nr={apiBase:"https://api.cluster.dyte.in"},Rr=function(e){Nr.apiBase=e},Mr={baseURL:"http://localhost:5000",createdAt:"2021-08-05T10:49:56.602Z",description:"Develop plugins on http://localhost:5000",id:"09259e3b-7be8-46f6-9801-106bf1866e1c",name:"Localhost Dev",organizationId:"4ad15a19-80e2-4105-bf43-48039fd2963e",picture:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/dyte.png",private:!1,published:!0,staggered:!1,tags:["#localhost","#dev"],type:"self_hosted",updatedAt:"2021-08-05T10:50:07.681Z"},zr=h("plugins/addView"),Lr=h("plugins/removeView"),jr=h("websocket/plugin-acl-grant"),Br=h("websocket/plugin-acl-remove"),Fr=h("plugins/initialize"),Vr=function(e,t){var n=e;return Object.entries(t).forEach((function(e){var t=e[0],i=e[1];n.searchParams.append(t,i)})),n},Wr=g({plugins:[],main:[],side:[],background:[],titlebar:[],controlbar:[],initialized:!1},((Pr={})[ii.toString()]=function(e,t){e.plugins=[],e.main=[],e.background=[],e.controlbar=[],e.side=[],e.titlebar=[]},Pr[zr.toString()]=function(e,n){var i=n.payload,r=i.plugin,o=i.meeting,a=i.config,s=i.pluginService;e.plugins.push(r);var c={auth:r.authToken,parent:window.location.origin,backend:Nr.apiBase,pluginId:r.id};if(a){var l=a.contentScript,u=a.views;if(u)Object.entries(u).forEach((function(n){var i=n[0],a=n[1];if("controlbar"===i){var l={url:Vr(new URL(a.path,r.baseURL),c).href,plugin:r.id,view:a.path,props:{icon:a.icon,label:a.label,position:a.position}};e.controlbar.push(l)}else if("sidebar"===i){var u=Vr(new URL(null!=a?a:"/",r.baseURL),c),d={url:u.href,plugin:r.id,view:null!=a?a:"/"};0===o.modules.getAll().filter((function(e){return e.sidebarComponent.name===r.name})).length&&o.modules.add({type:"sidebar",icon:t.createElement("img",{src:r.picture,width:28}),sidebarComponent:{name:r.name,component:function(){return t.createElement("iframe",{id:"dyte-plugin-sidebar",src:u.href,className:"dyte-iframe",width:"100%",height:"100%",ref:function(e){s.addIframeView(d,e)},allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"})}}}),e.side.push(d)}else{l={url:Vr(new URL(null!=a?a:"/",r.baseURL),c).href,plugin:r.id,view:null!=a?a:"/"};switch(i){case"root":e.main.push(l);break;case"titlebar":e.titlebar.push(l)}}}));else{var d={url:Vr(new URL(r.baseURL),c).href,plugin:r.id,view:"/"};e.main.push(d)}if(l){var p=r.name.replace(" ","-")+"_contentScript";if(!document.getElementById(p)){var m=new URL(l,r.baseURL),f=document.createElement("script");f.id=p,f.src=m.href,document.documentElement.appendChild(f),f.onload=function(){try{window.initDytePlugin(o)}catch(e){}}}}}else{d={url:Vr(new URL(r.baseURL),c).href,plugin:r.id,view:"/"};e.main.push(d)}},Pr[Lr.toString()]=function(e,t){var n=t.payload;e.main=e.main.filter((function(e){return e.plugin!==n.id})),e.side=e.side.filter((function(e){return e.plugin!==n.id})),e.background=e.background.filter((function(e){return e.plugin!==n.id})),e.plugins=e.plugins.filter((function(e){return e.id!==n.id})),e.titlebar=e.titlebar.filter((function(e){return e.plugin!==n.id})),e.controlbar=e.controlbar.filter((function(e){return e.plugin!==n.id}))},Pr[jr.toString()]=function(e,t){var n=t.payload,i=e.plugins.find((function(e){return e.id===n.pluginId}));if(i){var r=yn({},i);r.ACLAccessGrantedUsers.push(n.userId),r.ACLAccessRemovedUsers=r.ACLAccessRemovedUsers.filter((function(e){return e!==n.userId})),e.plugins=e.plugins.filter((function(e){return e.id!==i.id})).concat([r])}},Pr[Br.toString()]=function(e,t){var n=t.payload,i=e.plugins.find((function(e){return e.id===n.pluginId}));if(i){var r=yn({},i);r.ACLAccessRemovedUsers.push(n.userId),r.ACLAccessGrantedUsers=r.ACLAccessGrantedUsers.filter((function(e){return e!==n.userId})),e.plugins=e.plugins.filter((function(e){return e.id!==i.id})).concat([r])}},Pr[Fr.toString()]=function(e,t){var n=t.payload;e.initialized=n.initialized},Pr)),Ur=h("session/add-consumer"),qr=h("websocket/consumer-paused"),Hr=h("websocket/consumer-resumed"),Gr=h("websocket/consumer-closed"),Jr=h("websocket/consumer-score"),Yr=h("session/reset-consumers"),Kr=g({activeConsumers:[],closedConsumers:[],consumerScores:{}},((Ar={})[ii.toString()]=function(e){e.activeConsumers=[],e.closedConsumers=[]},Ar[Yr.toString()]=function(e){e.activeConsumers=[],e.closedConsumers=[]},Ar[Ur.toString()]=function(e,t){e.closedConsumers.includes(t.payload.id)?e.closedConsumers=e.closedConsumers.filter((function(e){return e!==t.payload.id})):e.activeConsumers=e.activeConsumers.filter((function(e){return e.id!==t.payload.id})).concat([t.payload])},Ar[Gr.toString()]=function(e,t){e.activeConsumers.find((function(e){return e.id===t.payload.id}))?e.activeConsumers=e.activeConsumers.filter((function(e){return e.id!==t.payload.id})):e.closedConsumers=e.closedConsumers.concat([t.payload.id])},Ar[Jr.toString()]=function(e,t){e.consumerScores[t.payload.id]={score:t.payload.score.score,id:t.payload.id,producerScore:t.payload.score.producerScore}},Ar[qr.toString()]=function(e,t){var n=e.activeConsumers.find((function(e){return e.id===t.payload.id}));n&&(n.remotelyPaused=!0,e.activeConsumers=e.activeConsumers.filter((function(e){return e.id!==t.payload.id})).concat([yn({},n)]))},Ar[Hr.toString()]=function(e,t){var n=e.activeConsumers.find((function(e){return e.id===t.payload.id}));n&&(n.remotelyPaused=!1,e.activeConsumers=e.activeConsumers.filter((function(e){return e.id!==t.payload.id})).concat([yn({},n)]))},Ar)),Zr=h("websocket/producer-connect"),Qr=h("websocket/producer-closed"),Xr=h("websocket/producer-score"),$r=h("session/reset-producers"),eo=v({reducer:{room:Oi,peers:Jn,participant:Tr,plugin:Wr,consumers:Kr,producers:g({activeProducers:[]},((Or={})[ii.toString()]=function(e){e.activeProducers=[]},Or[$r.toString()]=function(e){e.activeProducers=[]},Or[Zr.toString()]=function(e,t){e.activeProducers=e.activeProducers.filter((function(e){return e.id!==t.payload.id})).concat([t.payload])},Or[Qr.toString()]=function(e,t){e.activeProducers=e.activeProducers.filter((function(e){return e.id!==t.payload.id}))},Or[Xr.toString()]=function(e,t){var n=e.activeProducers.find((function(e){return e.id===t.payload.id}));n&&(n.score=t.payload.score[0].score,e.activeProducers=e.activeProducers.filter((function(e){return e.id!==t.payload.id})).concat([yn({},n)]))},Or))},devTools:!1,middleware:function(e){return Sn(Sn([],e({serializableCheck:{ignoredActions:["plugins/addView","plugins/removeView"]}}),!0),[Ue.reduxMiddleware()],!1)}});new qe({url:Nr.apiBase+"/graphql"});var to=function(e){return new qe({url:(e||Nr.apiBase)+"/graphql"})},no=e.forwardRef((function(t,n){var i={fill:t.fill};return e.createElement(Ut,yn({iconAttrs:i,iconVerticalAlign:"middle",iconViewBox:"0 0 24 24"},t,{ref:n}),e.createElement("path",{fill:t.fill,d:"M13.13 22.19L11.5 18.36C13.07 17.78 14.54 17 15.9 16.09L13.13 22.19M5.64 12.5L1.81 10.87L7.91 8.1C7 9.46 6.22 10.93 5.64 12.5M21.61 2.39C21.61 2.39 16.66 .269 11 5.93C8.81 8.12 7.5 10.53 6.65 12.64C6.37 13.39 6.56 14.21 7.11 14.77L9.24 16.89C9.79 17.45 10.61 17.63 11.36 17.35C13.5 16.53 15.88 15.19 18.07 13C23.73 7.34 21.61 2.39 21.61 2.39M14.54 9.46C13.76 8.68 13.76 7.41 14.54 6.63S16.59 5.85 17.37 6.63C18.14 7.41 18.15 8.68 17.37 9.46C16.59 10.24 15.32 10.24 14.54 9.46M8.88 16.53L7.47 15.12L8.88 16.53M6.24 22L9.88 18.36C9.54 18.27 9.21 18.12 8.91 17.91L4.83 22H6.24M2 22H3.41L8.18 17.24L6.76 15.83L2 20.59V22M2 19.17L6.09 15.09C5.88 14.79 5.73 14.47 5.64 14.12L2 17.76V19.17Z"}))}));no.displayName="RocketIcon";var io=e.forwardRef((function(t,n){return e.createElement(Ut,yn({iconAttrs:{fill:"currentColor"},iconVerticalAlign:"middle",iconViewBox:"0 0 18 18"},t,{ref:n}),e.createElement("path",{path:"currentColor",d:"M1 16h15V1z"}))}));io.displayName="FullSignalIcon";var ro=e.forwardRef((function(t,n){return e.createElement(Ut,yn({iconAttrs:{fill:"currentColor"},iconVerticalAlign:"middle",iconViewBox:"0 0 18 18"},t,{ref:n}),e.createElement("path",{fill:"currentColor",fillOpacity:".3",d:"M1 16h15V1z"}),e.createElement("path",{d:"M1 16h9V7z"}))}));ro.displayName="HalfSignalIcon",e.forwardRef((function(t,n){return e.createElement(Ut,yn({iconAttrs:{fill:"currentColor"},iconVerticalAlign:"middle",iconViewBox:"0 0 18 18"},t,{ref:n}),e.createElement("path",{fill:"currentColor",fillOpacity:".3",d:"M1 16h15V1z"}))})).displayName="NoSignalIcon";var oo=e.forwardRef((function(t,n){return e.createElement(Ut,yn({iconAttrs:{fill:"currentColor"},iconVerticalAlign:"middle",iconViewBox:"0 0 18 18"},t,{ref:n}),e.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"}),e.createElement("path",{d:"M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"}))}));oo.displayName="ExclamationIcon";var ao={primary:{300:"#1A90FF",500:"#2160FD",700:"#054DFF",900:"#0635AA"},secondary:{1e3:"#0E0E0E",900:"#1A1A1A",800:"#262626",700:"#474747"},text:{400:"#C4C4C4",300:"#E0E0E0",200:"#EEEEEE",100:"#F5F5F7"},logos:{google:"#DD4B39",linkedIn:"#0E76A8",apple:"#EEEEEE"},danger:{300:"#FF5A65",500:"#FF414D",700:"#FF2331"},warning:{500:"#FFC300"},success:{500:"#35F2B3"},background:"#1A1A1A"},so=function(){return qt.getParser((null===window||void 0===window?void 0:window.navigator.userAgent)||"")},co=function(){return so().getBrowserName()},lo=function(){return so().getOSVersion()},uo=function(){return"mobile"===so().getPlatformType()},po=function(){return"Blink"===so().getEngineName()},mo=function(){return"ios"===so().getOSName(!0)},fo=function(){return"android"===so().getOSName(!0)},ho=function(){return so().satisfies({edge:"<79",firefox:"<22",chrome:"<23",opera:"<18"})},go=function(){return!window.RTCPeerConnection||"Internet Explorer"===so().getBrowserName()},vo=function(){return po()&&document.pictureInPictureEnabled},yo=function(){return{isMobile:uo(),browserName:co(),osName:so().getOSName(),browserVersion:so().getBrowserVersion(),osVersionName:lo(),engineName:so().getEngineName()}},bo=function(){return"safari"===so().getBrowserName(!0)};function Eo(e){var o,a=e.text,s=e.inStage,c=e.showTextAfter,l=e.loading,u=e.showReloadButton,d=r(ua).sessionConfig,p=Hi(),m=(null===(o=d.theme)||void 0===o?void 0:o.dimensions)||p,f=m.height,h=m.width;f-=s?104:0;var g=n(0===c),v=g[0],y=g[1];i((function(){var e;return c&&(e=setTimeout((function(){return y(!0)}),1e3*c)),function(){return clearTimeout(e)}}),[]);var b=uo()&&s&&f<h;return t.createElement(w,{height:b?h:f,width:b?"auto":h,bg:"secondary.900",justify:"center",align:"center",transform:b?"rotate(90deg)":"unset",marginTop:b?"-2em":"unset"},l&&t.createElement(S,{color:"text.100",size:"xl"}),v&&a&&t.createElement(_,{textAlign:"center",color:"text.100",fontSize:"lg",px:"6",className:"dyte-client-noSelect"},a),v&&u&&t.createElement(k,{onClick:function(){return window.location.reload()},px:"6",py:"2"},t.createElement(C,{spacing:"2"},t.createElement(Ye,{color:ao.text[100],size:"1.5em"}),t.createElement(_,null,"Refresh"))))}Eo.defaultProps={text:"",inStage:!1,showTextAfter:0,loading:!0,showReloadButton:!1};var wo={px:"1px",.5:"0.125em",1:"0.25em",1.5:"0.375em",2:"0.5em",2.5:"0.625em",3:"0.75em",3.5:"0.875em",4:"1em",5:"1.25em",6:"1.5em",7:"1.75em",8:"2em",9:"2.25em",10:"2.5em",12:"3em",14:"3.5em",16:"4em",20:"5em",24:"6em",28:"7em",32:"8em",36:"9em",40:"10em",44:"11em",48:"12em",52:"13em",56:"14em",60:"15em",64:"16em",72:"18em",80:"20em",96:"24em"},So=yn(yn(yn({},wo),{max:"max-content",min:"min-content",full:"100%","3xs":"14em","2xs":"16em",xs:"20em",sm:"24em",md:"28em",lg:"32em",xl:"36em","2xl":"42em","3xl":"48em","4xl":"56em","5xl":"64em","6xl":"72em","7xl":"80em","8xl":"90em"}),{container:{sm:"640px",md:"768px",lg:"1024px",xl:"1280px"}}),_o=yn(yn({direction:"ltr",config:{useSystemColorMode:!1,initialColorMode:"light",cssVarPrefix:"chakra"},radii:{none:"0",sm:"0.125em",base:"0.25em",md:"0.375em",lg:"0.5em",xl:"0.75em","2xl":"1em","3xl":"1.5em",full:"9999px"},colors:ao},{letterSpacings:{tighter:"-0.05em",tight:"-0.025em",normal:"0",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeights:{normal:"normal",none:1,shorter:1.25,short:1.375,base:1.5,tall:1.625,taller:"2",3:".75em",4:"1em",5:"1.25em",6:"1.5em",7:"1.75em",8:"2em",9:"2.25em",10:"2.5em"},fontWeights:{hairline:100,thin:200,light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,black:900},fonts:{heading:'"Inter", sans-serif',body:'"Lato", system-ui, sans-serif',mono:"Menlo, monospace"},fontSizes:{xs:"0.75em",sm:"0.875em",md:"1em",lg:"1.125em",xl:"1.25em","2xl":"1.5em","3xl":"1.875em","4xl":"2.25em","5xl":"3em","6xl":"3.75em","7xl":"4.5em","8xl":"6em","9xl":"8em"}}),{sizes:So,space:wo});function ko(e){var t=So[e];return{container:{width:e,height:e,fontSize:"calc("+(null!=t?t:e)+" / 2.5)"},excessLabel:{width:e,height:e},label:{fontSize:"calc("+(null!=t?t:e)+" / 2.5)",lineHeight:"100%"!==e?null!=t?t:e:void 0}}}var Co,xo,To,Io,Po,Ao={sizes:{"2xs":ko("4"),xs:ko("6"),sm:ko("8"),md:ko("12"),lg:ko("16"),xl:ko("24"),"2xl":ko("32"),full:ko("100%")}},Oo={variants:{disabled:{bg:"text.200"}}},Do={baseStyle:{fontWeight:"medium",borderRadius:4,transition:"all .2s ease-in"},sizes:{md:{fontSize:"md",height:"auto",px:16,py:3},icon:{fontSize:"md"}},variants:{primaryDefault:{bg:"primary.500",color:"text.100",boxShadow:"none",fontSize:"1.075em",fontWeight:600,_hover:{bg:"primary.700",boxShadow:"none"}},controls:{bg:"secondary.1000",color:"text.400",borderRadius:0,_hover:{bg:"secondary.800",color:"text.100"}},primaryDisabled:{bg:"primary.700",color:"text.400",opacity:"0.5",_hover:{cursor:"not-allowed"}},secondaryDefault:{bg:"secondary.800",color:"text.100",_hover:{bg:"secondary.700"}},alternateDefault:{color:"primary.500",_hover:{borderColor:"primary.500"}},danger:{bg:"danger.500",color:"white",_hover:{bg:"danger.700"}},dangerSimple:{bg:"secondary.800",borderColor:"secondary.800",color:"danger.500",_hover:{bg:"secondary.900"},_active:{borderColor:"secondary.800"}},solid:{bg:"primary.500",_hover:{bg:"primary.500"}},solidDark:{border:"1px",borderColor:"secondary.800",bg:"secondary.800",color:"text.100",_hover:{color:"text.100",border:"1px",borderColor:"text.400"}},solidDarker:{border:"2px",borderColor:"secondary.900",bg:"secondary.900",color:"text.100",_hover:{fill:"primary.300",color:"text.100",borderColor:"primary.500",bg:"secondary.800"}},alternateDark:{border:"1px",borderColor:"secondary.700",bg:"secondary.800",color:"text.100",_hover:{bg:"secondary.700"}}},defaultProps:{size:"md",variant:"primaryDefault"}},No={baseStyle:{fontWeight:"500",color:"text.100",lineHeight:"150%"},variants:{content:{color:"primary.900"}}},Ro={baseStyle:{fontWeight:"normal",lineHeight:"150%",color:"text.100"},variants:{subtext:{fontSize:"12px",color:"#757575"}}},Mo={baseStyle:{bg:"secondary.900",color:"text.100"}},zo={variants:{primary:{color:"text.100",height:"3em",backgroundColor:"secondary.1000",border:"1px",borderColor:"secondary.700",transition:".2s",boxSizing:"border-box",borderRadius:"4px",errorBorderColor:"danger.500",fontSize:"1.125em",_placeholder:{color:"text.300",fontWeight:"light"},_focus:{bgColor:"secondary.1000",borderColor:"primary.300"}},dark:{field:{backgroundColor:"secondary.900",_placeholder:{color:"text.400",fontSize:"1em"}}},disabled:{color:"text.100",height:"3em",backgroundColor:"secondary.800",border:"1px",borderColor:"secondary.800",boxShadow:"0px 4px 8px secondary.900",transition:".2s",boxSizing:"border-box",borderRadius:"4px",errorBorderColor:"danger.500",fontSize:"1.125em",_placeholder:{color:"text.400",fontWeight:"light",bgColor:"unset"},_focus:{bgColor:"secondary.1000",borderColor:"primary.300"}}}},Lo={baseStyle:{ml:2,color:"text.200",fontWeight:"normal"}},jo={variants:{dark:{backgroundColor:"secondary.900",_placeholder:{color:"text.400",fontSize:"1em"}}}},Bo={parts:["menu","item","list","groupTitle","divider"],baseStyle:{menu:{boxShadow:"lg",rounded:"lg",flexDirection:"column",py:"2",p:"4"},item:{fontWeight:"medium",lineHeight:"normal",bg:"secondary.800",color:"text.200",py:"3",_first:{bg:"secondary.800"},_checked:{fill:"text.300",bg:"secondary.800"},_hover:{bg:"secondary.1000"},_focus:{bg:"none"}},list:{bg:"secondary.800",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.2), 0 4px 6px -4px rgb(0 0 0 / 0.2)",border:"none"},groupTitle:{color:"text.100",fontSize:"md"},divider:{borderColor:"secondary.800"}},variants:{chat:{menu:{background:"transparent"},item:{background:"transparent",_first:{bg:"none"},_checked:{bg:"none"},_hover:{bg:"none"},_focus:{bg:"none"}},list:{background:"transparent"}}}},Fo=function(e){var t=e.scrollBehavior;return{borderRadius:"md",bg:Ht("white","gray.700")(e),color:"inherit",my:"3.75em",zIndex:"modal",maxH:"inside"===t?"calc(100% - 7.5em)":void 0,boxShadow:Ht("lg","dark-lg")(e)}},Vo={baseStyle:function(e){return{dialog:Fo(e)}},parts:["content","header","body","footer"],variants:{primary:{header:{bg:"secondary.1000",color:"text.100",textAlign:"center",borderRadius:"8px 8px 0 0",paddingTop:"8"},body:{bg:"secondary.1000",color:"text.100"},footer:{bg:"secondary.1000",color:"text.100",borderRadius:"0 0 8px 8px",paddingBottom:"6"}}}},Wo={parts:["content","header","body","footer"],variants:{primary:{header:{bg:"secondary.800",color:"text.200",textAlign:"left",borderRadius:"8px 8px 0 0",fontSize:"lg",fontWeight:600,borderColor:"secondary.800"},body:{bg:"secondary.800",color:"text.200",borderColor:"secondary.800"},footer:{bg:"secondary.800",color:"text.200",borderColor:"secondary.800"},content:{bg:"secondary.800",borderColor:"secondary.800"}}}},Uo={sizes:{sm:{control:{h:3,w:3},label:{fontSize:"sm"},icon:{fontSize:"0.45em"}},md:{control:{w:4,h:4},label:{fontSize:"md"},icon:{fontSize:"0.625em"}},lg:{control:{w:5,h:5},label:{fontSize:"lg"},icon:{fontSize:"0.625em"}}},variants:{poll:{control:{display:"flex",div:{svg:{width:"100%"}},_checked:{backgroundColor:"text.100",borderColor:"text.100",color:"secondary.700",_hover:{backgroundColor:"text.100",borderColor:"text.100"}}}},primary:{control:{borderColor:"secondary.700",_checked:{backgroundColor:"secondary.700",borderColor:"secondary.700",color:"text.100",_hover:{backgroundColor:"secondary.800",boxShadow:"0 0 0 1px var(--text-400)",borderColor:"secondary.800"}},_hover:{borderColor:"secondary.800"},_focus:{boxShadow:"0 0 0 1px var(--text-400)"},_disabled:{borderColor:"secondary.900",background:"none"}}}},defaultProps:{variant:"primary",display:"block"},baseStyle:{display:"block"}},qo={defaultProps:{spacing:"0.5em"}},Ho=Gt("spinner-size"),Go={baseStyle:{width:[Ho.reference],height:[Ho.reference]},sizes:{xs:(Co={},Co[Ho.variable]="0.75em",Co),sm:(xo={},xo[Ho.variable]="1em",xo),md:(To={},To[Ho.variable]="1.5em",To),lg:(Io={},Io[Ho.variable]="2em",Io),xl:(Po={},Po[Ho.variable]="3em",Po)},defaultProps:{size:"md"}},Jo="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var Yo,Ko=(function(e,t){var n="__lodash_hash_undefined__",i=9007199254740991,r="[object Arguments]",o="[object Function]",a="[object Object]",s=/^\[object .+?Constructor\]$/,c=/^(?:0|[1-9]\d*)$/,l={};l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l[r]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object Boolean]"]=l["[object DataView]"]=l["[object Date]"]=l["[object Error]"]=l[o]=l["[object Map]"]=l["[object Number]"]=l[a]=l["[object RegExp]"]=l["[object Set]"]=l["[object String]"]=l["[object WeakMap]"]=!1;var u="object"==typeof Jo&&Jo&&Jo.Object===Object&&Jo,d="object"==typeof self&&self&&self.Object===Object&&self,p=u||d||Function("return this")(),m=t&&!t.nodeType&&t,f=m&&e&&!e.nodeType&&e,h=f&&f.exports===m,g=h&&u.process,v=function(){try{var e=f&&f.require&&f.require("util").types;return e||g&&g.binding&&g.binding("util")}catch(e){}}(),y=v&&v.isTypedArray;function b(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var E,w,S,_=Array.prototype,k=Function.prototype,C=Object.prototype,x=p["__core-js_shared__"],T=k.toString,I=C.hasOwnProperty,P=(E=/[^.]+$/.exec(x&&x.keys&&x.keys.IE_PROTO||""))?"Symbol(src)_1."+E:"",A=C.toString,O=T.call(Object),D=RegExp("^"+T.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),N=h?p.Buffer:void 0,R=p.Symbol,M=p.Uint8Array,z=N?N.allocUnsafe:void 0,L=(w=Object.getPrototypeOf,S=Object,function(e){return w(S(e))}),j=Object.create,B=C.propertyIsEnumerable,F=_.splice,V=R?R.toStringTag:void 0,W=function(){try{var e=me(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),U=N?N.isBuffer:void 0,q=Math.max,H=Date.now,G=me(p,"Map"),J=me(Object,"create"),Y=function(){function e(){}return function(t){if(!Ce(t))return{};if(j)return j(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function K(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Z(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Q(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function X(e){var t=this.__data__=new Z(e);this.size=t.size}function $(e,t){var n=Ee(e),i=!n&&be(e),r=!n&&!i&&Se(e),o=!n&&!i&&!r&&Te(e),a=n||i||r||o,s=a?function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}(e.length,String):[],c=s.length;for(var l in e)!t&&!I.call(e,l)||a&&("length"==l||r&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||fe(l,c))||s.push(l);return s}function ee(e,t,n){(void 0!==n&&!ye(e[t],n)||void 0===n&&!(t in e))&&ie(e,t,n)}function te(e,t,n){var i=e[t];I.call(e,t)&&ye(i,n)&&(void 0!==n||t in e)||ie(e,t,n)}function ne(e,t){for(var n=e.length;n--;)if(ye(e[n][0],t))return n;return-1}function ie(e,t,n){"__proto__"==t&&W?W(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}K.prototype.clear=function(){this.__data__=J?J(null):{},this.size=0},K.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},K.prototype.get=function(e){var t=this.__data__;if(J){var i=t[e];return i===n?void 0:i}return I.call(t,e)?t[e]:void 0},K.prototype.has=function(e){var t=this.__data__;return J?void 0!==t[e]:I.call(t,e)},K.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=J&&void 0===t?n:t,this},Z.prototype.clear=function(){this.__data__=[],this.size=0},Z.prototype.delete=function(e){var t=this.__data__,n=ne(t,e);return!(n<0||(n==t.length-1?t.pop():F.call(t,n,1),--this.size,0))},Z.prototype.get=function(e){var t=this.__data__,n=ne(t,e);return n<0?void 0:t[n][1]},Z.prototype.has=function(e){return ne(this.__data__,e)>-1},Z.prototype.set=function(e,t){var n=this.__data__,i=ne(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this},Q.prototype.clear=function(){this.size=0,this.__data__={hash:new K,map:new(G||Z),string:new K}},Q.prototype.delete=function(e){var t=pe(this,e).delete(e);return this.size-=t?1:0,t},Q.prototype.get=function(e){return pe(this,e).get(e)},Q.prototype.has=function(e){return pe(this,e).has(e)},Q.prototype.set=function(e,t){var n=pe(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this},X.prototype.clear=function(){this.__data__=new Z,this.size=0},X.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},X.prototype.get=function(e){return this.__data__.get(e)},X.prototype.has=function(e){return this.__data__.has(e)},X.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Z){var i=n.__data__;if(!G||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Q(i)}return n.set(e,t),this.size=n.size,this};var re,oe=function(e,t,n){for(var i=-1,r=Object(e),o=n(e),a=o.length;a--;){var s=o[re?a:++i];if(!1===t(r[s],s,r))break}return e};function ae(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":V&&V in Object(e)?function(e){var t=I.call(e,V),n=e[V];try{e[V]=void 0;var i=!0}catch(e){}var r=A.call(e);return i&&(t?e[V]=n:delete e[V]),r}(e):function(e){return A.call(e)}(e)}function se(e){return xe(e)&&ae(e)==r}function ce(e){return!(!Ce(e)||function(e){return!!P&&P in e}(e))&&(_e(e)?D:s).test(function(e){if(null!=e){try{return T.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function le(e){if(!Ce(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=he(e),n=[];for(var i in e)("constructor"!=i||!t&&I.call(e,i))&&n.push(i);return n}function ue(e,t,n,i,r){e!==t&&oe(t,(function(o,s){if(r||(r=new X),Ce(o))!function(e,t,n,i,r,o,s){var c=ge(e,n),l=ge(t,n),u=s.get(l);if(u)ee(e,n,u);else{var d,p,m,f,h,g=o?o(c,l,n+"",e,t,s):void 0,v=void 0===g;if(v){var y=Ee(l),b=!y&&Se(l),E=!y&&!b&&Te(l);g=l,y||b||E?Ee(c)?g=c:xe(h=c)&&we(h)?g=function(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}(c):b?(v=!1,g=function(e,t){if(t)return e.slice();var n=e.length,i=z?z(n):new e.constructor(n);return e.copy(i),i}(l,!0)):E?(v=!1,m=(d=l).buffer,f=new m.constructor(m.byteLength),new M(f).set(new M(m)),p=f,g=new d.constructor(p,d.byteOffset,d.length)):g=[]:function(e){if(!xe(e)||ae(e)!=a)return!1;var t=L(e);if(null===t)return!0;var n=I.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&T.call(n)==O}(l)||be(l)?(g=c,be(c)?g=function(e){return function(e,t,n,i){var r=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],c=i?i(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),r?ie(n,s,c):te(n,s,c)}return n}(e,Ie(e))}(c):Ce(c)&&!_e(c)||(g=function(e){return"function"!=typeof e.constructor||he(e)?{}:Y(L(e))}(l))):v=!1}v&&(s.set(l,g),r(g,l,i,o,s),s.delete(l)),ee(e,n,g)}}(e,t,s,n,ue,i,r);else{var c=i?i(ge(e,s),o,s+"",e,t,r):void 0;void 0===c&&(c=o),ee(e,s,c)}}),Ie)}function de(e,t){return ve(function(e,t,n){return t=q(void 0===t?e.length-1:t,0),function(){for(var i=arguments,r=-1,o=q(i.length-t,0),a=Array(o);++r<o;)a[r]=i[t+r];r=-1;for(var s=Array(t+1);++r<t;)s[r]=i[r];return s[t]=n(a),b(e,this,s)}}(e,t,Oe),e+"")}function pe(e,t){var n,i,r=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function me(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return ce(n)?n:void 0}function fe(e,t){var n=typeof e;return!!(t=null==t?i:t)&&("number"==n||"symbol"!=n&&c.test(e))&&e>-1&&e%1==0&&e<t}function he(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||C)}function ge(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var ve=function(e){var t=0,n=0;return function(){var i=H(),r=16-(i-n);if(n=i,r>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(W?function(e,t){return W(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:Oe);function ye(e,t){return e===t||e!=e&&t!=t}var be=se(function(){return arguments}())?se:function(e){return xe(e)&&I.call(e,"callee")&&!B.call(e,"callee")},Ee=Array.isArray;function we(e){return null!=e&&ke(e.length)&&!_e(e)}var Se=U||function(){return!1};function _e(e){if(!Ce(e))return!1;var t=ae(e);return t==o||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function ke(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}function Ce(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function xe(e){return null!=e&&"object"==typeof e}var Te=y?function(e){return function(t){return e(t)}}(y):function(e){return xe(e)&&ke(e.length)&&!!l[ae(e)]};function Ie(e){return we(e)?$(e,!0):le(e)}var Pe,Ae=(Pe=function(e,t,n){ue(e,t,n)},de((function(e,t){var n=-1,i=t.length,r=i>1?t[i-1]:void 0,o=i>2?t[2]:void 0;for(r=Pe.length>3&&"function"==typeof r?(i--,r):void 0,o&&function(e,t,n){if(!Ce(n))return!1;var i=typeof t;return!!("number"==i?we(n)&&fe(t,n.length):"string"==i&&t in n)&&ye(n[t],e)}(t[0],t[1],o)&&(r=i<3?void 0:r,i=1),e=Object(e);++n<i;){var a=t[n];a&&Pe(e,a,n,r)}return e})));function Oe(e){return e}e.exports=Ae}(Yo={exports:{}},Yo.exports),Yo.exports);function Zo(e){var t=e.replace("#","");return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3>155}function Qo(e,t){var n=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16),r=parseInt(e.substring(5,7),16);return n=parseInt(""+n*(100+t)/100),i=(i=parseInt(""+i*(100+t)/100))<255?i:255,r=(r=parseInt(""+r*(100+t)/100))<255?r:255,"#"+(1===(n=n<255?n:255).toString(16).length?"0"+n.toString(16):n.toString(16))+(1===i.toString(16).length?"0"+i.toString(16):i.toString(16))+(1===r.toString(16).length?"0"+r.toString(16):r.toString(16))}var Xo,$o,ea,ta=function(e,t){return[Qo(e,20+t),e,Qo(e,-20-t),Qo(e,-30-t)]},na=function(e){var t=e;if((null==t?void 0:t.primary)&&"object"==typeof t.primary&&t.primary[300])return e;if((null==t?void 0:t.primary)&&"string"==typeof t.primary&&(t.primary=ta(t.primary,25)),(null==t?void 0:t.secondary)&&"string"==typeof e.secondary){var n=ta(t.secondary,10);t.secondary=Zo(t.secondary)?n:n.reverse()}if((null==t?void 0:t.text)&&"string"==typeof e.text){var i=ta(t.text,-10);t.text=Zo(t.text)?i.reverse():i}var r={primary:{},secondary:{},text:{}};return(null==t?void 0:t.primary)?r.primary={300:t.primary[0],500:t.primary[1],700:t.primary[2],900:t.primary[3]}:delete r.primary,(null==t?void 0:t.secondary)?r.secondary={1e3:t.secondary[0],900:t.secondary[1],800:t.secondary[2],700:t.secondary[3]}:delete r.secondary,(null==t?void 0:t.text)?r.text={400:t.text[0],300:t.text[1],200:t.text[2],100:t.text[3]}:delete r.text,(null==t?void 0:t.background)&&Object.assign(r,{background:t.background}),r},ia=function(e){var o,a=e.children,s=n(null),c=s[0],l=s[1],u=r(ua).sessionConfig,d=function(e){l(function(e){return T(yn(yn({},_o),{components:{Avatar:Ao,Box:Oo,Button:Do,FormLabel:Lo,Heading:No,Popover:Wo,Text:Ro,Input:zo,Menu:Bo,Modal:Vo,Tooltip:Mo,Textarea:jo,Checkbox:Uo,Stack:qo,Spinner:Go},colors:Ko(_o.colors,na((null==e?void 0:e.colors)||{})),logo:(null==e?void 0:e.logo)||"/dyte_logo.svg"}))}(e))};if(i((function(){((null==u?void 0:u.theme.colors)||(null==u?void 0:u.theme.header.elements.logo))&&d({logo:null==u?void 0:u.theme.header.elements.logo,colors:(null==u?void 0:u.theme.colors)||{}})}),[u]),i((function(){d({})}),[]),!c||!u)return t.createElement(Eo,null);var p="#dyte-base-elem";return(null===(o=document.getElementById("dyte-shadow"))||void 0===o?void 0:o.shadowRoot)&&(p=":host, :root"),t.createElement(x,{resetCSS:!0,theme:c,cssVarsRoot:p},a)};!function(e){e.skip="SKIP",e.onAccept="ON_ACCEPT",e.skipOnPrivilegedUserEntry="SKIP_ON_PRIVILEGED_USER_ENTRY",e.skipOnAccept="SKIP_ON_ACCEPT"}(Xo||(Xo={})),function(e){e.groupCall="GROUP_CALL",e.webinar="WEBINAR",e.audioRoom="AUDIO_ROOM"}($o||($o={})),function(e){e.SKIP="skip",e.SKIP_ON_PRIVILEGED_USER_ENTRY="skipOnPrivilegedUserEntry",e.ON_ACCEPT="skipOnAccept"}(ea||(ea={}));var ra,oa=function(e,t){var n,i=yn({},e),r=yn(yn({},i.control_bar),{is_enabled:void 0!==t.controlBar?t.controlBar:i.control_bar.is_enabled}),o=yn(yn({},i.header),{is_enabled:void 0!==t.header?t.header:i.header.is_enabled});if(null==t?void 0:t.controlBarElements){var a=yn({},r.elements);void 0!==(null==t?void 0:t.controlBarElements.chat)&&(a.chat=t.controlBarElements.chat),void 0!==(null==t?void 0:t.controlBarElements.fullscreen)&&(a.fullscreen=t.controlBarElements.fullscreen),void 0!==(null==t?void 0:t.controlBarElements.participants)&&(a.participants=t.controlBarElements.participants),void 0!==(null==t?void 0:t.controlBarElements.plugins)&&(a.plugins=t.controlBarElements.plugins),void 0!==(null==t?void 0:t.controlBarElements.polls)&&(a.polls=t.controlBarElements.polls),void 0!==(null==t?void 0:t.controlBarElements.screenShare)&&(a.screenshare=t.controlBarElements.screenShare),void 0!==(null==t?void 0:t.controlBarElements.share)&&(a.invite=t.controlBarElements.share),a.reactions=!1,a.layout=!1,r.elements=a}if(null==t?void 0:t.headerElements){a=yn({},o.elements);void 0!==(null==t?void 0:t.headerElements.clock)&&(a.timer=t.headerElements.clock),void 0!==(null==t?void 0:t.headerElements.participantCount)&&(a.participant_count=t.headerElements.participantCount),void 0!==(null==t?void 0:t.headerElements.title)&&(a.title=t.headerElements.title),a.change_layout=!1,o.elements=a}if(void 0!==(null==t?void 0:t.logo)&&""!==t.logo&&(o.elements.logo=t.logo),i.header=o,i.control_bar=r,null==t?void 0:t.colors){var s=yn({},i.colors);t.colors.primary&&(s.primary=t.colors.primary),(null==t?void 0:t.colors.secondary)&&(s.secondary=t.colors.secondary),(null==t?void 0:t.colors.textPrimary)&&(s.text=t.colors.textPrimary,s.textPrimary=t.colors.textPrimary),(null==t?void 0:t.colors.videoBackground)&&(s.background=t.colors.videoBackground,s.videoBackground=t.colors.videoBackground),i.colors=s}return(null==t?void 0:t.dimensions)&&(i.dimensions=t.dimensions),(null==t?void 0:t.waitingRoom)&&(i.waiting_room={is_enabled:!0,enable_preview:void 0===(null===(n=t.waitingRoom)||void 0===n?void 0:n.showSelf)||t.waitingRoom.showSelf,element:t.waitingRoom.roomElement}),void 0!==t.aloneHereElement&&(i.alone_here={is_enabled:t.aloneHereElement}),i.pip_mode=!0,i},aa={permissions:{view_type:$o.groupCall,accept_waiting_requests:!1,accept_present_requests:!1,request_produce:!1,can_allow_participant_audio:!1,can_allow_participant_screensharing:!1,can_allow_participant_video:!1,request_kick_participant:!1,kick_participant:!1,pin_participant:!1,can_edit_display_name:!1,can_record:!1,waiting_room_type:Xo.skipOnAccept,plugins:{can_close:!0,can_start:!0,can_edit_acl:!1,config:{}},polls:{can_create:!0,can_vote:!0,can_view:!0},produce:{video:{allow:!0,quality:"vga",frame_rate:24},audio:!0,screenshare:{allow:!0,quality:"hd",frame_rate:5}},chat:{public:{can_send:!0,text:!0,files:!0},private:{can_send:!1,can_receive:!1,text:!1,files:!1}},reactions:!1,hidden_participant:!1,is_recorder:!1,show_participant_list:!0,can_change_participant_role:!1,can_change_theme:!1,can_present:!1,max_screenshare_count:1},theme:{setup_screen:{is_enabled:!1},alone_here:{is_enabled:!1},waiting_room:{is_enabled:!1,enable_preview:!0},control_bar:{is_enabled:!0,elements:{plugins:!0,screenshare:!0,invite:!1,participants:!0,chat:!0,reactions:!1,polls:!0,fullscreen:!0,layout:!0}},header:{is_enabled:!0,elements:{timer:!0,title:!0,participant_count:!0,change_layout:!0}},pip_mode:!0,auto_tune:!0,grid:{multi:{maxVideoCount:6,videoFit:"cover"},single:{maxVideoCount:6,videoFit:"cover"},defaultView:"MULTI"},controls:{pip_toggle:!1}},version:"0.5.0"};$o.groupCall,Xo.skipOnAccept;var sa="hXgU8Wc8pwuGNq9ms5q9Hh";"undefined"!=typeof process&&(null===(ra=null===process||void 0===process?void 0:process.env)||void 0===ra?void 0:ra.FLAGSMITH_ENVIRONMENT_KEY)&&(sa=process.env.FLAGSMITH_ENVIRONMENT_KEY);var ca=new(function(){function e(e){void 0===e&&(e=sa),this.flags={},this.environmentKey=null,this.environmentKey=e,this.identify=this.identify.bind(this),this.getValue=this.getValue.bind(this),this.hasFeature=this.hasFeature.bind(this),this.getAllFlags=this.getAllFlags.bind(this)}return e.prototype.identify=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n=!1),En(this,void 0,void 0,(function(){var i,r,o,a;return wn(this,(function(s){switch(s.label){case 0:i=JSON.parse(JSON.stringify(t)),r=Object.entries(i).map((function(e){return{trait_key:e[0],trait_value:e[1]}})),s.label=1;case 1:return s.trys.push([1,3,,4]),o="_"+(Math.random()+1).toString(36).substring(2),[4,Jt.post("https://api.flagsmith.com/api/v1/identities/",{identifier:e+(n?o:""),traits:r},{headers:{"Content-Type":"application/json","X-Environment-Key":this.environmentKey}})];case 2:return a=s.sent(),this.flags=function(e){void 0===e&&(e=[]);var t={};return e.forEach((function(e){t[e.feature.name]={enabled:e.enabled,value:e.feature_state_value}})),t}(a.data.flags||[]),[3,4];case 3:return s.sent(),[3,4];case 4:return[2,this.flags]}}))}))},e.prototype.getValue=function(e){return this.flags&&this.flags[e]&&this.flags[e].value},e.prototype.hasFeature=function(e){return this.flags&&this.flags[e]&&this.flags[e].enabled},e.prototype.getAllFlags=function(){return this.flags},e}()),la=new(function(){function e(){this.level=0}return e.prototype.process=function(e){var t={};try{Object.getOwnPropertyNames(e||{}).forEach((function(n){try{t[n]=JSON.stringify(e[n])}catch(e){t[n]="Failed to stringify"}}))}catch(e){}return t},e.prototype.init=function(e){"trace"===e?this.level=3:"log"===e?this.level=2:"error"===e&&(this.level=1)},e.prototype.trace=function(e,t){this.level<3||Ue.track(e,this.process(t))},e.prototype.warn=function(e,t){this.level<2||Ue.track(e,this.process(t))},e.prototype.error=function(e,t){this.level<1||Ue.track(e,this.process(t))},e}()),ua=o(null),da=function(e){var o=u(),s=r(He),c=n(null),l=c[0],m=c[1],f=e.children,h=e.meeting,g=n(yn({},h.config)),v=g[0],y=g[1],b=a(v),E=d((function(e){return e.participant.peerId})),w=d((function(e){return e.room.roomViewType})),S=n([]),_=S[0],k=S[1],C=n(!1),x=C[0],T=C[1],I=d((function(e){return e.participant.id}));b.current=v;var P=function(e){var t,n,i,r,o,a,s,c=yn({},e);if("multi"===(null===(i=null===(n=null===(t=c.theme)||void 0===t?void 0:t.grid)||void 0===n?void 0:n.defaultView)||void 0===i?void 0:i.toLowerCase())?eo.dispatch(wi("multi")):"highlighted"===(null===(a=null===(o=null===(r=c.theme)||void 0===r?void 0:r.grid)||void 0===o?void 0:o.defaultView)||void 0===a?void 0:a.toLowerCase())&&eo.dispatch(wi("highlighted")),c.theme=oa(c.theme,h._uiConfig),h.config=c,"fillParent"===(null===(s=h.config.theme.dimensions)||void 0===s?void 0:s.mode)){var l=document.getElementsByClassName("dyte-client-root")[0];l&&(l.style="width: 100%; height: 100%;")}y(c)},A=function(e){return En(void 0,void 0,void 0,(function(){var t;return wn(this,(function(n){return t=e.hasOwnProperty("uiConfig")||e.hasOwnProperty("role")?function(e,t){var n,i,r,o,a,s,c,l,u,d,p,m,f,h,g,v,y,b,E,w,S,_,k=yn({},e);if(t.role){var C=yn({},k.permissions);void 0!==(null===(n=t.role.permissions)||void 0===n?void 0:n.acceptWaitingRequests)&&(C.accept_waiting_requests=t.role.permissions.acceptWaitingRequests),void 0!==(null===(i=t.role.permissions)||void 0===i?void 0:i.allowRecording)&&(C.can_record=t.role.permissions.allowRecording),void 0!==(null===(r=t.role.permissions)||void 0===r?void 0:r.editDisplayName)&&(C.can_edit_display_name=t.role.permissions.editDisplayName),void 0!==(null===(o=t.role.permissions)||void 0===o?void 0:o.disableParticipantAudio)&&(C.can_allow_participant_audio=t.role.permissions.disableParticipantAudio),void 0!==(null===(a=t.role.permissions)||void 0===a?void 0:a.disableParticipantScreensharing)&&(C.can_allow_participant_screensharing=t.role.permissions.disableParticipantScreensharing),void 0!==(null===(s=t.role.permissions)||void 0===s?void 0:s.disableParticipantVideo)&&(C.can_allow_participant_video=t.role.permissions.disableParticipantVideo),void 0!==(null===(c=t.role.permissions)||void 0===c?void 0:c.kickParticipants)&&(C.kick_participant=t.role.permissions.kickParticipants),void 0!==(null===(l=t.role.permissions)||void 0===l?void 0:l.pinParticipant)&&(C.pin_participant=t.role.permissions.pinParticipant),(null===(u=t.role)||void 0===u?void 0:u.plugins)&&(C.plugins={can_start:t.role.plugins.start,can_close:t.role.plugins.close,can_edit_acl:t.role.plugins.canEditAcl,config:{}},(null===(p=null===(d=t.role)||void 0===d?void 0:d.pluginConfig)||void 0===p?void 0:p.hostOnlyControl)&&t.role.pluginConfig.hostOnlyControl.forEach((function(e){C.plugins.config[e]={defaultAccess:"whitelist"}})),(null===(f=null===(m=t.role)||void 0===m?void 0:m.pluginConfig)||void 0===f?void 0:f.handlesViewOnly)&&t.role.pluginConfig.hostOnlyControl.forEach((function(e){void 0===C.plugins.config[e]&&(C.plugins.config[e]={defaultAccess:"blacklist"}),C.plugins.config[e].handlesViewOnly=!0}))),(null===(h=t.role)||void 0===h?void 0:h.produce)&&(C.produce={video:yn(yn({},C.produce.video),{allow:void 0===(null===(g=t.role.produce)||void 0===g?void 0:g.video)||t.role.produce.video}),audio:void 0===t.role.produce.audio||t.role.produce.audio,screenshare:yn(yn({},C.produce.screenshare),{allow:void 0===(null===(v=t.role.produce)||void 0===v?void 0:v.screenshare)||t.role.produce.screenshare})},C.polls=yn(yn({},C.polls),{can_create:void 0===t.role.produce.polls||t.role.produce.polls}),(null===(y=t.role.produce)||void 0===y?void 0:y.chat)&&(C.chat=yn(yn({},C.chat),{public:yn(yn({},t.role.produce.chat),{can_send:!0})}))),t.role.flags&&(C.hidden_participant=t.role.flags.hiddenParticipant,C.is_recorder=t.role.flags.recorder),C.show_participant_list=!0,C.can_change_participant_role=!1,C.view_type=t.roomViewType?$o[t.roomViewType]:$o.groupCall,C.reactions=!1,C.request_produce=!($o[t.roomViewType]!==$o.webinar||!(null===(E=null===(b=t.role)||void 0===b?void 0:b.webinar)||void 0===E?void 0:E.viewOnly)),C.request_kick_participant=!1,C.waiting_room_type=t.role.waitingRoom?Xo[t.role.waitingRoom]:Xo.skip,C.accept_present_requests=!($o[t.roomViewType]!==$o.webinar||(null===(S=null===(w=t.role)||void 0===w?void 0:w.webinar)||void 0===S?void 0:S.viewOnly)||!(null===(_=t.role.permissions)||void 0===_?void 0:_.acceptWaitingRequests)),k.permissions=C}return t.uiConfig&&(k.theme=oa(k.theme,t.uiConfig)),k}(h.config,e):e,p((function(){var e,n;if(o(Ki({canAllowParticipantAudio:t.permissions.can_allow_participant_audio,canAllowParticipantVideo:t.permissions.can_allow_participant_video})),o(Xn(!0)),o(Hn({id:E,view_type:null===(e=t.permissions)||void 0===e?void 0:e.view_type,preset_name:t.preset_name})),(null===(n=t.permissions)||void 0===n?void 0:n.view_type)&&o(ki(t.permissions.view_type)),t.permissions.view_type===Mi.webinar&&w!==Mi.webinar&&o(hr(!0)),v.permissions.view_type!==Mi.webinar&&t.permissions.view_type===Mi.webinar)o(hr(!0)),o(gr(t.permissions.can_present)),o(qn());else if(t.permissions.hidden_participant){var i={hidden:!1,joinStageSettings:Vi.ALLOWED};o(fr(i)),o(Un({hidden:!1}))}})),P(yn({},Ko(h.config,t))),[2]}))}))};i((function(){I&&function(){En(this,void 0,void 0,(function(){var e,t;return wn(this,(function(n){return T(!0),ca.hasFeature(Bi.LOGROCKET)&&(e=JSON.parse(ca.getValue(Bi.LOGROCKET).toString()),Ue.init("bhibaz/dyte",{release:"0.37.0",dom:e.dom}),la.init(e.level)),t=ca.getAllFlags(),la.trace("Flagsmith Flags List For Current Participant: ",t),Object.keys(t).forEach((function(e){la.trace("Flagsmith Flag "+e+" as "+t[e].enabled,t[e])})),[2]}))}))}()}),[I]),i((function(){var e,t;h&&(t=h.connectionConfig.authToken,En(void 0,void 0,void 0,(function(){var e;return wn(this,(function(n){switch(n.label){case 0:return[4,fetch(Nr.apiBase+"/auth/basicUserDetails?authToken="+t,{method:"GET",headers:{authorization:"Bearer "+t,"dyte-tracing-id":E}})];case 1:return[4,n.sent().json()];case 2:return(e=n.sent()).errors?o(Ji(yn({},e.errors[0]))):e.user&&(Ue.identify(e.user.id,{name:e.user.name,email:e.user.email}),e.user.email.endsWith("@anon.dyte.in")&&(e.user.name===e.user.email.split("@anon")[0]&&delete e.user.name,delete e.user.email),o(Gi(yn(yn({},e.user),{authToken:t}))),s.setHeader("Authorization","Bearer "+t),m(t)),[2]}}))})),h._setUIConfig=P,h._controlsHook=function(e){k((function(t){return t.concat(e)}))},"e305a6cd-1da1-407d-879b-449ba721702f"===(null===(e=h.connectionConfig)||void 0===e?void 0:e.clientId)&&document.getElementsByTagName("html")[0].classList.add("dyte-client-noScrollbar"))}),[h]),i((function(){s.setHeader("Authorization","Bearer "+h.connectionConfig.authToken),s.setHeader("dyte-tracing-id",E)}),[s]),i((function(){s.setHeader("Authorization","Bearer "+h.connectionConfig.authToken),s.setHeader("dyte-tracing-id",E),o(ii()),o(cr(!1)),o(On());var e,t=document.getElementsByClassName("dyte-client-root")[0],n=function(){var e;if(t&&"fillParent"===(null===(e=h.config.theme.dimensions)||void 0===e?void 0:e.mode)){var n=t.offsetWidth,i=t.offsetHeight;t.parentElement&&(0===i&&(i=t.parentElement.offsetHeight),0===n&&(n=t.parentElement.offsetWidth));var r=yn({},b.current);r.theme.dimensions.height=i,r.theme.dimensions.width=n,P(r)}};return window.ResizeObserver&&(e=new ResizeObserver(n)).observe(t),window.onresize=function(){var e;if("fillParent"===(null===(e=h.config.theme.dimensions)||void 0===e?void 0:e.mode)){var t=yn({},b.current);t.theme.dimensions.height=0,t.theme.dimensions.width=0,P(t),setTimeout(n,200)}},function(){return null==e?void 0:e.disconnect()}}),[]);var O={sessionConfig:v,meeting:h,updatePreset:function(e,t){return En(void 0,void 0,void 0,(function(){var n,i,r,o;return wn(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,fetch(Nr.apiBase+"/v1/userpreset",{method:"POST",headers:{"content-type":"application/json","dyte-tracing-id":E},body:JSON.stringify({authToken:t,roomName:e,version:"0.5.0",clientType:"CLIENT_APP"})})];case 1:return[4,a.sent().json()];case 2:return n=a.sent(),(null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.preset)?(i=n.data.preset,A(i)):(la.error("update_preset_failed",n),A(h.config)),[3,4];case 3:return r=a.sent(),la.error("update_preset_failed",r),A(h.config),[3,4];case 4:return[2]}}))}))},processPreset:A,participantControls:_};return(null==h?void 0:h.connectionConfig.authToken)||l?x?t.createElement(ua.Provider,{value:O},t.createElement(ia,null,t.createElement("div",{style:(null==v?void 0:v.theme.dimensions)?{}:{zIndex:1e3,position:"fixed",top:0,left:0}},f))):t.createElement("div",null,"Loading Config.."):null},pa={qqvga:{width:{ideal:160},height:{ideal:120}},qvga:{width:{ideal:320},height:{ideal:240}},vga:{width:{ideal:640},height:{ideal:480}},hd:{width:{ideal:1280},height:{ideal:720}},hd_cropped:{width:{ideal:900},height:{ideal:720}}},ma={optional:[{googDscp:!0}]},fa=[{rid:"r0",scalabilityMode:"L1T2"},{rid:"r1",scalabilityMode:"L1T2"}],ha=[{scalabilityMode:"L3T3_KEY"}],ga=[{dtx:!0,maxBitrate:15e5},{dtx:!0,maxBitrate:6e6}],va=null,ya=[{urls:"turn:turn.dyte.in:443?transport=tcp",username:"dyte",credential:"dytein",credentialType:"password"},{urls:"turn:turn.dyte.in:3478?transport=udp",username:"dyte",credential:"dytein",credentialType:"password"}],ba=function(e){return En(void 0,void 0,void 0,(function(){var t,n,i,r,o;return wn(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),t=eo.getState().participant.authToken,n=eo.getState().participant.peerId,[4,fetch(Nr.apiBase+"/iceservers/candidateRegional/"+e,{method:"GET",headers:{authorization:"Bearer "+t,"dyte-tracing-id":n}})];case 1:return[4,a.sent().json()];case 2:return i=a.sent(),[2,null===(o=i.iceServersList)||void 0===o?void 0:o.iceServersList];case 3:return r=a.sent(),la.error("get_regional_ice_server_err",r),[2,void 0];case 4:return[2]}}))}))},Ea=function(){return En(void 0,void 0,void 0,(function(){var e,t,n,i;return wn(this,(function(r){switch(r.label){case 0:if(null!==va)return[3,5];r.label=1;case 1:return r.trys.push([1,4,,5]),e=eo.getState().participant.authToken,t=eo.getState().participant.peerId,[4,fetch(Nr.apiBase+"/iceservers",{method:"GET",headers:{authorization:"Bearer "+e,"dyte-tracing-id":t}})];case 2:return[4,r.sent().json()];case 3:return(n=r.sent()).success?(va=n.iceServers,[3,5]):[2,ya];case 4:return i=r.sent(),la.error("get_ice_server_err",i),[2,ya];case 5:return[2,va]}}))}))},wa=new(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.initialized=!1,t.stalled=!1,t}return gn(t,e),t.prototype.initialize=function(e,t){var n;return En(this,void 0,void 0,(function(){var t,i=this;return wn(this,(function(r){switch(r.label){case 0:this.peerId=e;try{this.backend=new Zt(Nr.apiBase,yo().engineName,Qt.PRODUCTION),this.backend.eventHandler.on("initialized",(function(e){i.ipInformation=e,i.initialized=!0,i.emit("initialized",e)}))}catch(e){la.error("CallStatsIntegration: ",e)}return t=this,[4,Ea()];case 1:return t.iceServers=r.sent(),null===(n=this.backend)||void 0===n||n.registerIceServers(this.iceServers),this.startPreCallTest(),[2]}}))}))},t.prototype.authenticate=function(e){var t;null===(t=this.backend)||void 0===t||t.authenticate(e)},t.prototype.setRoomName=function(e){this.roomURL=e},t.prototype.configureSendTransport=function(e){var t;null===(t=this.backend)||void 0===t||t.registerProducingTransport(e)},t.prototype.configureRecvTransport=function(e){var t;null===(t=this.backend)||void 0===t||t.registerConsumingTransport(e)},t.prototype.candidateRegionalNetworkQualityTest=function(e){var t;return En(this,void 0,void 0,(function(){var n,i;return wn(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,ba(e)];case 1:return(n=r.sent())&&(null===(t=this.backend)||void 0===t||t.sendNetworkQualityTestBeginEvent(n)),[3,3];case 2:return i=r.sent(),la.warn("Error in callstats candidateRegionalNetworkQualityTest",i),[3,3];case 3:return[2]}}))}))},t.prototype.roomJoined=function(){var e,t;return En(this,void 0,void 0,(function(){var n,i,r,o,a,s,c,l,u,d;return wn(this,(function(p){return n=yo(),i=eo.getState().participant,r=i.id,o=i.peerId,a=i.displayName,s=eo.getState().room,c=s.roomUUID,l=s.roomViewType,u=s.roomName,d={userId:r,peerId:o,displayName:a,roomUUID:c,roomViewType:l,roomName:u,deviceInfo:n},null===(e=this.backend)||void 0===e||e.sendCallJoinBeginEvent(d),this.backend&&this.candidateRegionalNetworkQualityTest(u),null===(t=this.backend)||void 0===t||t.startPingStats(),[2]}))}))},t.prototype.audioOff=function(){var e;null===(e=this.backend)||void 0===e||e.sendAudioToggleEvent(!1)},t.prototype.audioOn=function(){var e;null===(e=this.backend)||void 0===e||e.sendAudioToggleEvent(!0)},t.prototype.videoOff=function(){var e;null===(e=this.backend)||void 0===e||e.sendVideoToggleEvent(!1)},t.prototype.videoOn=function(){var e;null===(e=this.backend)||void 0===e||e.sendVideoToggleEvent(!0)},t.prototype.callEnded=function(){var e;null===(e=this.backend)||void 0===e||e.sendDisconnectEvent()},t.prototype.screenShareStart=function(e){var t;null===(t=this.backend)||void 0===t||t.sendScreenShareToggleEvent(!0,e)},t.prototype.screenShareStop=function(e){var t;null===(t=this.backend)||void 0===t||t.sendScreenShareToggleEvent(!1,e)},t.prototype.screenShareRequested=function(){var e;null===(e=this.backend)||void 0===e||e.sendScreenShareRequestedEvent()},t.prototype.activeSpeaker=function(e){var t;e===this.peerId&&(null===(t=this.backend)||void 0===t||t.sendActiveSpeakerEvent(e))},t.prototype.devices=function(e,t){var n;null===(n=this.backend)||void 0===n||n.devices(e,t)},t.prototype.selectedDevice=function(e,t){var n;null===(n=this.backend)||void 0===n||n.selectedDevice(e,t)},t.prototype.mediaPermission=function(e,t){var n;null===(n=this.backend)||void 0===n||n.mediaPermission(e,t)},t.prototype.mediaPlaybackFailed=function(e){var t;null===(t=this.backend)||void 0===t||t.mediaPlaybackFailed(e)},t.prototype.mediaTrackMuted=function(e){var t;null===(t=this.backend)||void 0===t||t.mediaTrackMuted(e)},t.prototype.tabChanged=function(e){var t;void 0===e&&(e=!1),null===(t=this.backend)||void 0===t||t.tabChanged(e)},t.prototype.browserBackgrounded=function(){var e;null===(e=this.backend)||void 0===e||e.browserBackgrounded()},t.prototype.browserForegrounded=function(){var e;null===(e=this.backend)||void 0===e||e.browserForegrounded()},t.prototype.legacySwitch=function(e){var t;null===(t=this.backend)||void 0===t||t.legacySwitch(e)},t.prototype.startPreCallTest=function(){var e;return En(this,void 0,void 0,(function(){return wn(this,(function(t){return null===(e=this.backend)||void 0===e||e.sendPreCallTestBeginEvent(),[2]}))}))},t.prototype.onPreCallTestResults=function(e){var t;return null===(t=this.backend)||void 0===t||t.eventHandler.once("precall_end",e),e},t.prototype.onReceivingConsumerAudioStatus=function(e){var t;null===(t=this.backend)||void 0===t||t.eventHandler.on("consumer_audio_status",e)},t.prototype.onReceivingConsumerVideoStatus=function(e){var t;null===(t=this.backend)||void 0===t||t.eventHandler.on("consumer_video_status",e)},t.prototype.onSafeInitialization=function(e){if(this.initialized)e(this.ipInformation,!1);else if(!this.stalled){var t=function(t){e(t,!0)};return this.once("initialized",t),t}return function(){}},t.prototype.removeInitializationListener=function(e){this.removeListener("initialized",e)},t.prototype.stallCallStats=function(){this.stalled=!0,this.removeAllListeners("initialized")},t.prototype.addRecvStream=function(e,t){},t.prototype.addSendStream=function(e,t){},t}(Yt)),Sa=function(e,t){var n=pa[e.toLowerCase()];if(!n)throw new Error("Invalid quality");if(t){if(t<5||t>30)throw new Error("Invalid framerate");n.frameRate={ideal:t}}return n},_a=function(e,t,n){return En(void 0,void 0,void 0,(function(){var i,r,o,a,s,c,l,u;return wn(this,(function(d){switch(d.label){case 0:i=t||pa.vga,r=(null==n?void 0:n.indexOf("OBS Virtual"))>-1,o={video:yn({deviceId:{exact:e||""},frameRate:{ideal:24,max:30}},r?{}:i),audio:!1},d.label=1;case 1:return d.trys.push([1,3,,5]),[4,navigator.mediaDevices.getUserMedia(o)];case 2:return a=d.sent(),[3,5];case 3:return s=d.sent(),la.trace("get_video_track_first_attempt_err",s),o.video.deviceId.ideal=o.video.deviceId.exact,delete o.video.deviceId.exact,[4,navigator.mediaDevices.getUserMedia(o)];case 4:return a=d.sent(),[3,5];case 5:if(c=a.getVideoTracks()[0],r)try{l=c.getSettings().width,u=c.getSettings().height,c.applyConstraints({width:{ideal:i.width.ideal},height:{ideal:Math.floor(u*i.width.ideal/l)}})}catch(e){la.error("obs_constrain",e)}return[2,c]}}))}))},ka=function(e){return En(void 0,void 0,void 0,(function(){var t,n,i;return wn(this,(function(r){switch(r.label){case 0:return t={echoCancellation:{ideal:!0},autoGainControl:{ideal:!0},noiseSuppression:{ideal:!0}},"chrome"!==so().getBrowserName(!0)||uo()?[3,2]:(n=JSON.parse('{"video":false,"audio":{"optional":[{"sourceId":"'+e+'"},{"echoCancellation":true},{"googEchoCancellation":true},{"googAutoGainControl":true},{"googNoiseSuppression":true},{"googHighpassFilter":true},{"googNoiseSuppression2":true},{"googEchoCancellation2":true},{"googAutoGainControl2":true}]}}'),[4,navigator.mediaDevices.getUserMedia(n)]);case 1:return i=r.sent(),[3,7];case 2:n={audio:yn({deviceId:{exact:e||""}},t),video:!1},r.label=3;case 3:return r.trys.push([3,5,,7]),[4,navigator.mediaDevices.getUserMedia(n)];case 4:return i=r.sent(),[3,7];case 5:return r.sent(),n.audio.deviceId.ideal=n.audio.deviceId.exact,delete n.audio.deviceId.exact,[4,navigator.mediaDevices.getUserMedia(n)];case 6:return i=r.sent(),[3,7];case 7:return[2,i.getAudioTracks()[0]]}}))}))},Ca=function(){return En(void 0,void 0,void 0,(function(){var e;return wn(this,(function(t){switch(t.label){case 0:return[4,navigator.mediaDevices.getDisplayMedia({audio:!0,video:{width:{max:1920},height:{max:1080},frameRate:{max:5}}})];case 1:return[2,{video:(e=t.sent()).getVideoTracks()[0],audio:e.getAudioTracks()[0]}]}}))}))},xa={Chrome:"chrome",Chromium:"chrome",Opera:"opera",Firefox:"firefox","Internet Explorer":"iexplorer",Safari:"safari"};function Ta(){var e=navigator.userAgent;return e.match(/Electron/)?{name:"electron",version:e.match(/Electron\/([\d.]+)/)[1]}:null}function Ia(){var e=navigator.userAgent;if(e.match(/JitsiMeetNW/))return{name:"nwjs",version:e.match(/JitsiMeetNW\/([\d.]+)/)[1]}}function Pa(){var e,t=navigator.userAgent.match(/\b(react[ \t_-]*native)(?:\/(\S+))?/i);if(t||"ReactNative"===navigator.product)return t&&t.length>2&&(e=t[2]),e||(e="unknown"),{name:"react-native",version:e}}function Aa(e){for(var t,n=[Pa,Ta,Ia],i=0;i<n.length;i+=1)if(t=n[i]())return t;var r=e.getBrowserName();return r in xa?{name:xa[r],version:e.getBrowserVersion()}:(t=function(){var e=navigator.userAgent,t={name:"unknown",version:void 0};if(e.match(/Chrome/)&&!e.match(/Edge/))if(e.match(/Edg(A?)/)){var n=e.match(/Chrome\/([\d.]+)/)[1];Number.parseInt(n,10)>72&&(t.name="chrome",t.version=n)}else t.name="chrome",t.version=e.match(/Chrome\/([\d.]+)/)[1];return t}())||{name:"unknown",version:void 0}}var Oa=function(){function e(){}return e.prototype.init=function(e){var t,n;if(this._bowser=qt.getParser(navigator.userAgent),this._bowser&&void 0===e){var i=Aa(this._bowser);t=i.name,n=i.version}else void 0!==e&&e.name in xa?(t=xa[e.name],n=e.version):(t="unknown",n=void 0);this._name=t,this._version=n},e.prototype.getName=function(){return this._name},e.prototype.isChrome=function(){return"chrome"===this._name},e.prototype.isOpera=function(){return"opera"===this._name},e.prototype.isFirefox=function(){return"firefox"===this._name},e.prototype.isIExplorer=function(){return"iexplorer"===this._name},e.prototype.isSafari=function(){return"safari"===this._name},e.prototype.isNWJS=function(){return"nwjs"===this._name},e.prototype.isElectron=function(){return"electron"===this._name},e.prototype.isReactNative=function(){return"react-native"===this._name},e.prototype.getVersion=function(){return this._version},e.prototype._checkCondition=function(e){if(this._version)return this._bowser.satisfies(e)},e.prototype.isVersionGreaterThan=function(e){var t;return this._checkCondition(((t={})[this._name]=">"+e,t))},e.prototype.isVersionLessThan=function(e){var t;return this._checkCondition(((t={})[this._name]="<"+e,t))},e.prototype.isVersionEqualTo=function(e){var t;return this._checkCondition(((t={})[this._name]="~"+e,t))},e}(),Da=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return gn(t,e),t.prototype.setup=function(){this.init()},t.prototype.doesVideoMuteByStreamRemove=function(){return this.isChromiumBased()||this.isWebKitBased()},t.prototype.supportsP2P=function(){return!this.usesUnifiedPlan()},t.prototype.isChromiumBased=function(){return this.isChrome()||this.isElectron()||this.isNWJS()||this.isOpera()},t.prototype.isWebKitBased=function(){return this._bowser&&this._bowser.isEngine("webkit")&&void 0!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.getUserMedia&&void 0!==window.RTCRtpTransceiver&&Object.keys(RTCRtpTransceiver.prototype).indexOf("currentDirection")>-1},t.prototype.isSupported=function(){return this.isChromiumBased()&&this._getChromiumBasedVersion()>=72||this.isFirefox()||this.isReactNative()||this.isWebKitBased()},t.prototype.isUserInteractionRequiredForUnmute=function(){return this.isFirefox()&&this.isVersionLessThan("68")},t.prototype.supportsVideoMuteOnConnInterrupted=function(){return this.isChromiumBased()||this.isReactNative()||this.isWebKitBased()},t.prototype.supportsBandwidthStatistics=function(){return!this.isFirefox()&&!this.isWebKitBased()},t.prototype.supportsCodecPreferences=function(){return this.usesUnifiedPlan()&&void 0!==window.RTCRtpTransceiver&&Object.keys(window.RTCRtpTransceiver.prototype).indexOf("setCodecPreferences")>-1&&Object.keys(RTCRtpSender.prototype).indexOf("getCapabilities")>-1&&!this.isWebKitBased()},t.prototype.supportsDeviceChangeEvent=function(){return navigator.mediaDevices&&void 0!==navigator.mediaDevices.ondevicechange&&void 0!==navigator.mediaDevices.addEventListener},t.prototype.supportsLocalCandidateRttStatistics=function(){return this.isChromiumBased()||this.isReactNative()||this.isWebKitBased()},t.prototype.supportsPerformanceObserver=function(){return void 0!==window.PerformanceObserver&&PerformanceObserver.supportedEntryTypes.indexOf("longtask")>-1},t.prototype.supportsReceiverStats=function(){return void 0!==window.RTCRtpReceiver&&Object.keys(RTCRtpReceiver.prototype).indexOf("getSynchronizationSources")>-1},t.prototype.supportsRTTStatistics=function(){return!this.isFirefox()},t.prototype.usesPlanB=function(){return!this.usesUnifiedPlan()},t.prototype.usesSdpMungingForSimulcast=function(){return this.isChromiumBased()||this.isReactNative()||this.isWebKitBased()},t.prototype.usesUnifiedPlan=function(){return!(!this.isFirefox()&&!this.isWebKitBased())},t.prototype.usesNewGumFlow=function(){return!!(this.isChromiumBased()||this.isFirefox()||this.isWebKitBased())},t.prototype.usesAdapter=function(){return this.usesNewGumFlow()},t.prototype.usesRidsForSimulcast=function(){return!1},t.prototype.supportsGetDisplayMedia=function(){return void 0!==navigator.getDisplayMedia||void 0!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.getDisplayMedia},t.prototype.supportsInsertableStreams=function(){if(void 0===window.RTCRtpSender||!window.RTCRtpSender.prototype.createEncodedStreams&&!window.RTCRtpSender.prototype.createEncodedVideoStreams)return!1;var e=new ReadableStream;try{return window.postMessage(e,"*",[e]),!0}catch(e){return!1}},t.prototype.supportsAudioRed=function(){return Boolean(window.RTCRtpSender&&window.RTCRtpSender.getCapabilities&&window.RTCRtpSender.getCapabilities("audio").codecs.some((function(e){return"audio/red"===e.mimeType}))&&window.RTCRtpReceiver&&window.RTCRtpReceiver.getCapabilities&&window.RTCRtpReceiver.getCapabilities("audio").codecs.some((function(e){return"audio/red"===e.mimeType})))},t.prototype.supportsSdpSemantics=function(){return this.isChromiumBased()},t.prototype._getChromiumBasedVersion=function(){if(this.isChromiumBased()){var e=navigator.userAgent;if(e.match(/Chrome/))return Number.parseInt(e.match(/Chrome\/([\d.]+)/)[1],10)}return-1},t}(Oa),Na=[],Ra=!1,Ma=!1,za=!1,La=!1,ja=!1,Ba=new(function(){function e(){var e=this;this.browser=new Da,this.isDeviceListAvailable=function(){return Boolean(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)},this.setOnDeviceChange=function(t){e.browser.supportsDeviceChangeEvent()&&navigator.mediaDevices.addEventListener("devicechange",(function(){return e.enumerateDevices().then(t)}))},this.getAllAudioDevices=function(){return Na.filter((function(e){return"audioinput"===e.kind}))},this.getAllVideoDevices=function(){return Na.filter((function(e){return"videoinput"===e.kind}))},this.getAllSpeakerDevices=function(){return Na.filter((function(e){return"audiooutput"===e.kind}))}}return e.prototype.onMediaDevicesListChanged=function(e){var t=this;la.trace("media_devices",e),Na=e.slice(0),wa.onSafeInitialization((function(){wa.devices(zi.AUDIO,t.getAllAudioDevices()),wa.devices(zi.VIDEO,t.getAllVideoDevices()),wa.devices(zi.SPEAKER,t.getAllSpeakerDevices())}))},e.prototype.compareAvailableMediaDevices=function(e){if(e.length!==Na.length)return!0;function t(e){return JSON.stringify({kind:e.kind,deviceId:e.deviceId,groupId:e.groupId,label:e.label,facing:e.facing})}return e.map(t).sort().join("")!==Na.map(t).sort().join("")},e.prototype.updateKnownDevices=function(e){this.compareAvailableMediaDevices(e)&&this.onMediaDevicesListChanged(e)},e.prototype.init=function(e){return void 0===e&&(e={}),En(this,void 0,void 0,(function(){var t;return wn(this,(function(n){switch(n.label){case 0:return"boolean"==typeof e.disableAEC&&(Ma=e.disableAEC),"boolean"==typeof e.disableNS&&(za=e.disableNS),"boolean"==typeof e.disableAP&&(Ra=e.disableAP),"boolean"==typeof e.disableAGC&&(La=e.disableAGC),"boolean"==typeof e.disableHPF&&(ja=e.disableHPF),this.browser.setup(),this.pcConstraints=this.browser.isChromiumBased()||this.browser.isReactNative()?{optional:[{googScreencastMinBitrate:100},{googCpuOveruseDetection:!0}]}:{},this.isDeviceListAvailable()?[4,this.enumerateDevices()]:[3,2];case 1:t=n.sent(),Na=t.slice(0),n.label=2;case 2:return[2]}}))}))},e.prototype.enumerateDevices=function(){var e=this;return new Promise((function(t,n){navigator.mediaDevices.enumerateDevices().then((function(n){la.trace("device_enum_success",{totalDevices:null==n?void 0:n.length}),e.updateKnownDevices(n),t(n)})).catch((function(n){la.error("device_enum_failed",n),e.updateKnownDevices([]),t([])}))}))},e.prototype.getConstraints=function(e,t){void 0===e&&(e=[]),void 0===t&&(t={});var n={};if(e.indexOf("video")>=0)if(n.video||(n.video=yn({},t.initialWebcamConstraints)||pa.vga),t.cameraDeviceId)n.video.deviceId=t.cameraDeviceId;else{var i=t.facingMode||"user";n.video.facingMode=i}else n.video=!1;return e.indexOf("audio")>=0?(n.audio&&"boolean"!=typeof n.audio||(n.audio={}),this.browser.isFirefox()||this.browser.isWebKitBased()?n.audio={deviceId:t.micDeviceId,autoGainControl:!La&&!Ra,echoCancellation:!Ma&&!Ra,noiseSuppression:!za&&!Ra}:(n.audio.optional||(n.audio.optional=[]),n.audio.optional.push({sourceId:t.micDeviceId},{echoCancellation:!Ma&&!Ra},{googEchoCancellation:!Ma&&!Ra},{googAutoGainControl:!La&&!Ra},{googNoiseSuppression:!za&&!Ra},{googHighpassFilter:!ja&&!Ra},{googNoiseSuppression2:!za&&!Ra},{googEchoCancellation2:!Ma&&!Ra},{googAutoGainControl2:!La&&!Ra}))):n.audio=!1,n},e.prototype._getUserMedia=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n=0),new Promise((function(e,i){var r,o=!1;la.trace("getUserMedia",t),"number"==typeof n&&!Number.isNaN(n)&&n>0&&(r=setTimeout((function(){o=!0,r=void 0,i(new Error("timeout"))}),n)),navigator.mediaDevices.getUserMedia(t).then((function(t){o||(void 0!==r&&clearTimeout(r),e(t))})).catch((function(e){la.error("local_media_failed",{error:e.message,constraints:t}),o||(void 0!==r&&clearTimeout(r),i(e))}))}))},e.prototype._parsePermissionFromError=function(e){return["PermissionDeniedError","NotAllowedError","SecurityError"].includes(e.name)?e.message.indexOf("by system")>0?qa.SYS_DENIED:qa.DENIED:["DevicesNotFoundError","NotFoundError","AbortError","NotReadableError"].includes(e.name)?qa.NOTFOUND:qa.FAILED},e.prototype.obtainAudioAndVideoStream=function(e){return En(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,c,l,u,d=this;return wn(this,(function(p){switch(p.label){case 0:t=e.timeout,n=bn(e,["timeout"]),i=new Map,r=function(){var e=(n.devices||["audio","video"]).filter((function(e){return"audio"===e||"video"===e}));if(!e.length)return Promise.resolve();var i=d.getConstraints(e,n);return d._getUserMedia(e,i,t)},o=function(){return En(d,void 0,void 0,(function(){var e,i,r,o,a,s,c,l,u,d,p,m;return wn(this,(function(f){switch(f.label){case 0:if(e=n.devices||["audio","video"],i={audio:qa.INIT,video:qa.INIT},!(r=e.filter((function(e){return"audio"===e||"video"===e}))).length)return[2,Promise.resolve()];o=this.getConstraints(["audio"],n),a=this.getConstraints(["video"],n),s=new MediaStream,f.label=1;case 1:return f.trys.push([1,3,,4]),[4,this._getUserMedia(r,o,t)];case 2:return c=f.sent(),(l=c.getAudioTracks()[0])?(s.addTrack(l),i.audio=qa.ACCEPTED):i.audio=qa.NOTFOUND,[3,4];case 3:return u=f.sent(),i.audio=this._parsePermissionFromError(u),[3,4];case 4:return f.trys.push([4,6,,7]),[4,this._getUserMedia(r,a,t)];case 5:return d=f.sent(),(p=d.getVideoTracks()[0])?s.addTrack(p):i.video=qa.NOTFOUND,[3,7];case 6:return m=f.sent(),i.video=this._parsePermissionFromError(m),[3,7];case 7:return[2,[s,i]]}}))}))},a=function(e){if(e){var t=e.getAudioTracks();if(t.length){var r=new MediaStream(t);i.set("audio",{type:"audio",stream:r,track:r.getAudioTracks()[0],effects:n.effects})}var o=e.getVideoTracks();if(o.length){var a=new MediaStream(o);i.set("video",{stream:a,track:a.getVideoTracks()[0],type:"webcam",effects:n.effects})}}},c={audio:qa.ACCEPTED,video:qa.ACCEPTED},p.label=1;case 1:return p.trys.push([1,3,5,7]),[4,r()];case 2:return s=p.sent(),[3,7];case 3:return l=p.sent(),la.warn("capture_failed_retrying",l),[4,o()];case 4:return u=p.sent(),s=u[0],c=u[1],!po()||c.audio!==qa.DENIED&&c.video!==qa.DENIED||r(),[3,7];case 5:return[4,a(s)];case 6:return p.sent(),[7];case 7:return[2,[i,c]]}}))}))},e.prototype.stopMediaStream=function(e){e&&(e.getTracks().forEach((function(e){e.stop&&e.stop()})),e.stop&&e.stop(),e.release&&e.release())},e.prototype.arePermissionsGranted=function(){return Na.some((function(e){return Boolean(e.label)}))},e}()),Fa=function(e,t,n){var i="number"==typeof n?n:250,r=e.createMediaStreamSource(t),o=e.createAnalyser();o.fftSize=2048,r.connect(o);var a=new Uint8Array(o.fftSize),s=!1;return setTimeout((function(){s=!0}),i),function e(){return s?Promise.resolve(!0):(o.getByteTimeDomainData(a),a.some((function(e){return 128!==e&&0!==e}))?Promise.resolve(!1):function(e){return void 0===e&&(e=0),new Promise((function(t){return setTimeout(t,e)}))}().then(e))}().then((function(e){return r.disconnect(),e}),(function(e){throw r.disconnect(),e}))},Va="undefined"!=typeof AudioContext?AudioContext:null,Wa=new(function(){function e(t){var n=yn({AudioContext:Va},t);Object.defineProperties(this,{_AudioContext:{value:n.AudioContext},audioContext:{value:null,writable:!0},_holders:{value:new Set},AudioContextFactory:{enumerable:!0,value:e}})}return e.prototype.getOrCreate=function(e){if(!this._holders.has(e)&&(this._holders.add(e),this._AudioContext&&!this.audioContext))try{this.audioContext=new this._AudioContext}catch(e){}return this.audioContext},e.prototype.release=function(e){this._holders.has(e)&&(this._holders.delete(e),!this._holders.size&&this.audioContext&&(this.audioContext.close(),this.audioContext=null))},e}());function Ua(e){var t={},n=Wa.getOrCreate(t),i=3;return function t(){return i-=1,Fa(n,e.srcObject,250).then((function(e){return!!e&&(!(i>0)||t())})).catch((function(){return!0}))}().finally((function(){Wa.release(t)}))}var qa,Ha=function(e){return"https://cdn.dyte.in/assets/permissions/"+e},Ga=function(){var e,n,i=co(),o=r(ua).sessionConfig,a=Hi(),s=((null===(e=o.theme)||void 0===e?void 0:e.dimensions)||a).width,c={Safari:{video:"Desktop_Safari.mp4",text:['Choose Safari> "Settings for this website" in the menu bar','Select "Always allow", then click done',"Refresh or rejoin meeting"]},ios:{video:"",text:["Go to Settings > Search for "+i,"Enable microphone and camera","Refresh or rejoin meeting"]},android:{video:"",text:["Go to Settings > Search for "+i,"Open Permissions > Enable microphone and camera","Refresh or rejoin meeting"]},Safari_ios:{video:"iOS Safari.mp4",text:[]},Chrome_ios:{video:"Chrome_ios.mp4",text:[]},Firefox_android:{video:"Android_Firefox.mp4",text:[]},Chrome_android:{video:"Android_Chrome.mp4",text:[t.createElement(t.Fragment,null,"Tap on the"," "," "," ",t.createElement(I,{verticalAlign:"middle",display:"inline",h:"8",src:Ha("chrome-android-lock.png"),alt:"Lock icon in Chrome"})," ","in the address bar"),t.createElement(t.Fragment,null,"Select the"," ",t.createElement(I,{verticalAlign:"middle",display:"inline",h:"8",src:Ha("chrome-android-settings.png"),alt:"Settings icon in Chrome"})," ","permissions section"),'Toggle the camera and microphone switch to "allowed"',"Refresh or rejoin"]},Firefox:{video:"Desktop_Firefox.mp4",text:[t.createElement(t.Fragment,null,"Click the camera icon"," ",t.createElement(I,{src:Ha("firefox-icon.png"),verticalAlign:"middle",display:"inline",h:"8",alt:"Disabled media access icons in Firefox"})," ","in your browser's address bar"),'Click X for any "Blocked" or "Blocked Temporarily" devices under Permissions','Then click "Allow" when permission request popup shows up']},"Microsoft Edge":{video:"Desktop_Edge.mp4",text:[t.createElement(t.Fragment,null,"Click the camera icon"," ",t.createElement(I,{src:Ha("edge-icon.png"),alt:"Video icon on Edge",verticalAlign:"middle",display:"inline",h:"8"})," ","in your browser's address bar"),'Select "Always allow", then click done',"Refresh or rejoin meeting"]},Chrome:{video:"Desktop_Chrome.mp4",text:[t.createElement(t.Fragment,null,"Click the camera icon"," ",t.createElement(I,{src:Ha("chrome-icon.png"),alt:"Video icon on Edge",verticalAlign:"middle",display:"inline",h:"8"})," ","in your browser's address bar"),'Select "Always allow", then click done',"Refresh or rejoin meeting"]}},l=(n=c.Chrome,uo()?n=mo()&&c[i+"_ios"]?c[i+"_ios"]:fo()&&c[i+"_android"]?c[i+"_android"]:c[mo()?"ios":"android"]:c[i]&&(n=c[i]),n);return t.createElement(t.Fragment,null,""!==l.video&&t.createElement(P,{mt:"4",mb:"2",w:"80%",mx:"auto"},uo()?t.createElement("video",{src:Ha(l.video),autoPlay:!0,muted:!0,controls:!0,loop:!0,playsInline:!0}):t.createElement("video",{src:Ha(l.video),autoPlay:!0,muted:!0,loop:!0})),s>320&&t.createElement(A,{my:"4",mx:"auto",listStylePosition:"inside",spacing:"2"},l.text.map((function(e){return t.createElement(O,null,e)}))))},Ja=function(e){var o=e.videoPermission,s=e.audioPermission,c=a(document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")),l=r(Ka).permissionModal,u=l.isOpen,d=l.onClose,p=l.onOpen,m=n(qa.ACCEPTED),f=m[0],h=m[1],g=a(qa.ACCEPTED);i((function(){var e=function(e,t){return e===qa.INIT&&t===qa.INIT?qa.INIT:e===qa.DENIED||t===qa.DENIED?qa.DENIED:e===qa.SYS_DENIED||t===qa.SYS_DENIED?qa.SYS_DENIED:qa.ACCEPTED}(o,s);g.current=e,h(e),e!==qa.INIT&&p()}),[o,s]);var v=function(){return o!==qa.DENIED&&o!==qa.SYS_DENIED||s!==qa.DENIED&&s!==qa.SYS_DENIED?o===qa.DENIED||o===qa.SYS_DENIED?"Camera":"Mic":"Camera and Mic"};if(f===qa.ACCEPTED)return null;var y=Ha("mac-permissions.mp4"),b=t.createElement(A,{my:"3",mx:"",listStylePosition:"inside",spacing:"2"},t.createElement(O,{textAlign:"left"},"Go to System Preferences > Security & Privacy > Privacy > Camera"),t.createElement(O,{textAlign:"left"},"Tick the box next to"," ",t.createElement("b",null,co())),t.createElement(O,{textAlign:"left"},"Do steps 1 and 2 for microphone too"),t.createElement(O,{textAlign:"left"},"Restart the browser and rejoin the meeting"));if(uo()){var E=co()+"-"+(mo()?"ios":"android")+"-permissions.mp4";y=["Safari-ios-permissions.mp4","Chrome-ios-permissions.mp4"].indexOf(E)>=0?Ha(E):null,b=mo()?t.createElement(A,{my:"3",mx:"",listStylePosition:"inside",spacing:"2"},t.createElement(O,{textAlign:"left"},"Go to Settings > Search for"," ",t.createElement("b",null,co())),t.createElement(O,{textAlign:"left"},"Go to the "+co()+" app settings"),t.createElement(O,{textAlign:"left"},"Enable both microphone and camera"),t.createElement(O,{textAlign:"left"},"Restart the browser and rejoin the meeting")):t.createElement(A,{my:"3",mx:"",listStylePosition:"inside",spacing:"2"},t.createElement(O,{textAlign:"left"},"Go to Settings > Search for"," ",t.createElement("b",null,co())),t.createElement(O,{textAlign:"left"},"Tap on the browser to go to the settings"),t.createElement(O,{textAlign:"left"},"Open Permissions > Enable microphone and camera"),t.createElement(O,{textAlign:"left"},"Restart the browser and rejoin the meeting"))}return t.createElement(D,{isOpen:u,onClose:d,portalProps:{containerRef:c},variant:"primary",isCentered:!0},f===qa.DENIED&&t.createElement(t.Fragment,null,t.createElement(N,{bg:"secondary.900"}),t.createElement(R,{background:"secondary.1000",w:"90%",maxW:"640px",px:"4",py:"6",textAlign:"center",color:"text.100"},t.createElement(_,{fontSize:"2xl",fontWeight:"bold",color:"danger.500"},"Unblock "+v()+"?"),!(window.hasOwnProperty("Android ")||window.hasOwnProperty("Android")||window.hasOwnProperty("cordova"))&&t.createElement(Ga,null),t.createElement(k,{mt:"2",variant:"solidDark",onClick:d},"Continue without "+v()))),f===qa.SYS_DENIED&&t.createElement(t.Fragment,null,t.createElement(N,{bg:"secondary.800"}),t.createElement(R,{background:"secondary.1000",w:"90%",maxW:"640px",maxH:"90%",px:"4",py:"6",textAlign:"center",color:"text.100",overflow:"auto"},t.createElement(_,{fontSize:"2xl",fontWeight:"bold"},"Unblock "+v()+"?"),y&&(uo()?t.createElement("video",{src:y,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,controls:!0,style:{borderRadius:"6px",width:"90%",maxWidth:"400px",margin:"1.2em auto"}}):t.createElement("video",{src:y,autoPlay:!0,loop:!0,muted:!0,style:{borderRadius:"6px",width:"90%",maxWidth:"400px",margin:"1.2em auto"}})),b,t.createElement(k,{mt:"2",variant:"solidDark",onClick:d},"Continue without"," ",v()))))},Ya=function(e){var n=e.screensharePermission,o=a(document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")),s=r(Ka).screensharePermissionModal,c=s.isOpen,l=s.onClose,u=s.onOpen;if(i((function(){n!==qa.INIT&&u()}),[n]),n!==qa.DENIED&&n!==qa.SYS_DENIED)return null;var d=t.createElement("a",{style:{color:"white",textDecoration:"underline"},href:"x-apple.systempreferences:com.apple.preference.security?Privacy_ScreenCapture"},"click here");return t.createElement(D,{isOpen:c,onClose:l,portalProps:{containerRef:o},variant:"primary",isCentered:!0},t.createElement(N,{bg:"secondary.800"}),t.createElement(R,{background:"secondary.1000",w:"90%",maxW:"640px",maxH:"90%",px:"4",py:"6",textAlign:"center",color:"text.100",overflow:"auto"},t.createElement(_,{fontSize:"2xl",fontWeight:"bold"},"Unblock Screen share?"),t.createElement("video",{src:Ha("mac-screenshare-permissions.mp4"),autoPlay:!0,loop:!0,muted:!0,style:{borderRadius:"6px",width:"90%",maxWidth:"400px",margin:"1.2em auto"}}),t.createElement(A,{my:"3",mx:"auto",listStylePosition:"inside",spacing:"2"},t.createElement(O,{textAlign:"left"},"Go to System Preferences > Security & Privacy > Privacy > Screen Recording"," ","(",d,")"),t.createElement(O,{textAlign:"left"},"Tick the box next to"," ",t.createElement("b",null,co())),t.createElement(O,{textAlign:"left"},"Restart the browser and rejoin the meeting")),"If screen recording is already enabled, simply restart the browser and rejoin the meeting.",t.createElement("br",null),"If the issue persists, please switch to a different browser.",t.createElement(k,{mt:"2",variant:"solidDark",onClick:l},"Continue without Screen share")))};!function(e){e[e.INIT=0]="INIT",e[e.ACCEPTED=1]="ACCEPTED",e[e.DENIED=2]="DENIED",e[e.SYS_DENIED=3]="SYS_DENIED",e[e.FAILED=4]="FAILED",e[e.NOTFOUND=5]="NOTFOUND",e[e.NOT_APPLICABLE=6]="NOT_APPLICABLE"}(qa||(qa={}));var Ka=o(null);function Za(e){var o,s,c,l,m,f,h,g,v,y=this,b=n(),E=b[0],w=b[1],S=n([]),_=S[0],k=S[1],C=n(),x=C[0],T=C[1],I=n(),P=I[0],A=I[1],O=n([]),D=O[0],N=O[1],R=n(),z=R[0],L=R[1],j=n(),B=j[0],F=j[1],V=n([]),W=V[0],U=V[1],q=n(!1),H=q[0],G=q[1],J=a(null),Y=a(null),K=a(null),Z=r(ua),Q=Z.meeting,X=Z.sessionConfig,$=a(null),ee=a(null),te=a(null),ne=a(null),ie=Sa(null===(c=null===(s=null===(o=X.permissions)||void 0===o?void 0:o.produce)||void 0===s?void 0:s.video)||void 0===c?void 0:c.quality,null===(f=null===(m=null===(l=X.permissions)||void 0===l?void 0:l.produce)||void 0===m?void 0:m.video)||void 0===f?void 0:f.frame_rate),re=e.children,oe=d((function(e){return e.participant.audioMuted})),ae=d((function(e){return e.participant.videoOff})),se=d((function(e){return e.room.producersState})),ce=n(!1),le=ce[0],ue=ce[1],de=n(qa.INIT),pe=de[0],me=de[1],fe=n(qa.INIT),he=fe[0],ge=fe[1],ve=n(qa.INIT),ye=ve[0],be=ve[1],Ee=a(),we=d((function(e){return e.participant.presentingState})),Se=d((function(e){return e.room.roomViewType})),_e=d((function(e){return e.participant.requestToJoinType})),ke=d((function(e){return e.room.routerState})),Ce=a(null),xe=M(),Te=xe.isOpen,Ie=xe.onClose,Pe=xe.onOpen,Ae=M(),Oe=Ae.isOpen,De=Ae.onClose,Ne=Ae.onOpen;Se===Mi.webinar&&_e===qi.ask&&(ie=Sa("QQVGA",null===(v=null===(g=null===(h=X.permissions)||void 0===h?void 0:h.produce)||void 0===g?void 0:g.video)||void 0===v?void 0:v.frame_rate));var Re=a(),Me=a(),ze=a(null),Le=d((function(e){return e.participant.audioTrackSelection})),je=d((function(e){return e.participant.videoTrackSelection})),Be=d((function(e){return e.participant.speakerTrackSelection})),Fe=d((function(e){return e.participant.videoProduction})),Ve=d((function(e){return e.participant.audioProduction})),We=d((function(e){return e.participant.deviceChanges})),Ue=se===kn.NOT_APPLICABLE||Fe===kn.LOADED||Fe===kn.NOT_STARTED,qe=se===kn.NOT_APPLICABLE||Ve===kn.LOADED||Ve===kn.NOT_STARTED,He=ke===kn.LOADED&&Ve!==kn.LOADED&&(Se!==Mi.webinar||we===Wi.PRESENTING),Ge=ke===kn.LOADED&&(Se!==Mi.webinar||we===Wi.PRESENTING),Je=u();i((function(){J.current=x,Y.current=z,K.current=E,$.current=Ve,ee.current=Fe,te.current=oe,ne.current=ae,ze.current=Le}),[x,z,E,Ve,oe,ae,Le]),i((function(){E&&(E.enabled=!oe),oe&&wa.onSafeInitialization((function(){wa.mediaTrackMuted(zi.AUDIO)}))}),[oe,E]),i((function(){ae&&wa.onSafeInitialization((function(){wa.mediaTrackMuted(zi.VIDEO)}))}),[ae]),i((function(){he===qa.ACCEPTED&&la.trace("video_perm_accepted"),wa.onSafeInitialization((function(){wa.mediaPermission(zi.VIDEO,he)}))}),[he]),i((function(){pe===qa.ACCEPTED&&la.trace("audio_perm_accepted"),wa.onSafeInitialization((function(){wa.mediaPermission(zi.AUDIO,pe)}))}),[pe]);var Ye=function(e){return En(y,void 0,void 0,(function(){var t,n,i,r,o,a;return wn(this,(function(s){switch(s.label){case 0:t=new Audio,(n=new MediaStream).addTrack(null!=e?e:K.current),t.srcObject=n,i=!1,s.label=1;case 1:return s.trys.push([1,5,6,7]),(r=t.play())?[4,r]:[3,3];case 2:s.sent(),s.label=3;case 3:return[4,Ua(t)];case 4:return(i=s.sent())&&la.trace("Silence detected",{track:(null==e?void 0:e.id)||(null===(a=K.current)||void 0===a?void 0:a.id)||"null"}),[3,7];case 5:return o=s.sent(),la.warn("Failed to detect silence:",o),[3,7];case 6:return t.pause(),t.remove(),[7];case 7:return[2,i]}}))}))},Ke=function(e){return En(y,void 0,void 0,(function(){var t,n,i,r,o,a;return wn(this,(function(s){switch(s.label){case 0:t=null!==(o=null==e?void 0:e.deviceId)&&void 0!==o?o:null===(a=ze.current)||void 0===a?void 0:a.selectedDeviceId,la.trace("setting_audio_device",{deviceId:t}),p((function(){var e;Je(nr(!1)),(null===(e=ze.current)||void 0===e?void 0:e.selectedDeviceId)!==t&&Je(ar({selectedDeviceId:t}))})),E&&(it(E),E.stop()),s.label=1;case 1:return s.trys.push([1,4,,5]),[4,ka(t)];case 2:return n=s.sent(),w(n),rt(n),He&&Je(er(kn.CONNECTING)),pe!==qa.ACCEPTED&&me(qa.ACCEPTED),[4,Ye(n)];case 3:return i=s.sent(),la.trace("is_set_audio_device_silent",{isTrackSilent:i}),ca.hasFeature(Bi.NOTIFY_AUDIO_TRACK_SILENCE)&&ue(i),[3,5];case 4:return r=s.sent(),la.error("set_audio_device_err",r),w(null),pe===qa.ACCEPTED&&me(qa.FAILED),Je(er(kn.NOT_APPLICABLE)),Je(nr(!0)),[3,5];case 5:return[2]}}))}))},Ze=function(e){return En(y,void 0,void 0,(function(){var t,n=this;return wn(this,(function(i){return(t=(null==e?void 0:e.deviceId)||(null==je?void 0:je.selectedDeviceId))?(p((function(){Je(rr(!1)),(null==je?void 0:je.selectedDeviceId)!==t&&Je(or({selectedDeviceId:t}))})),[2,new Promise((function(i,r){setTimeout((function(){return En(n,void 0,void 0,(function(){var n,o;return wn(this,(function(a){switch(a.label){case 0:x&&(it(x),x.stop()),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,_a(t,ie,null==e?void 0:e.label)];case 2:return n=a.sent(),T(n),Ge&&Je($i(kn.CONNECTING)),he!==qa.ACCEPTED&&ge(qa.ACCEPTED),i(),[3,4];case 3:return o=a.sent(),la.error("set_video_device_err",o),T(null),he===qa.ACCEPTED&&ge(qa.FAILED),Je($i(kn.NOT_APPLICABLE)),Je(rr(!0)),r(),[3,4];case 4:return[2]}}))}))}))}))]):[2,new Promise((function(e){return e()}))]}))}))},Qe=function(e){return En(y,void 0,void 0,(function(){return wn(this,(function(e){switch(e.label){case 0:return Ue?ae?[4,Ze()]:[3,2]:[2];case 1:return e.sent(),[3,3];case 2:p((function(){Ge&&Je($i(kn.STOPPING)),Je(rr(!0)),setTimeout((function(){x&&(it(x),x.stop()),T(void 0)}))})),e.label=3;case 3:return[2]}}))}))};i((function(){Se!==Ce.current&&(null!==Ce.current&&(ae||Qe(),nr(!0)),Ce.current=Se)}),[Se]),i((function(){Se===Mi.webinar&&ke===kn.LOADED&&we===Wi.NOT_PRESENTING?p((function(){Je(rr(!0)),Je(nr(!0)),setTimeout((function(){x&&(it(x),x.stop()),E&&(it(E),E.stop()),w(void 0),T(void 0)}))})):we===Wi.INITIATED&&(Je(oi(!1)),Promise.all([Ze(),Ke()]).then((function(){Je(oi(!0))})))}),[ke,we]);var Xe=function(e){return En(y,void 0,void 0,(function(){var t,n,i,r,o,a;return wn(this,(function(s){switch(s.label){case 0:return t=Ba.browser.isWebKitBased(),"audio"===e?n=K.current:"video"===e&&(n=J.current),n?(i="ended"===n.readyState,r="audio"===e?$.current===kn.LOADED:ee.current===kn.LOADED,o=i&&r&&t,a=!1,"audio"!==e?[3,2]:[4,Ye()]):(la.trace("no_"+e+"_track_to_reacquire"),[2,!1]);case 1:a=s.sent(),s.label=2;case 2:return[2,"visible"===document.visibilityState&&(n.muted||o||a)]}}))}))},$e=function(e){return En(y,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return Me.current||te.current?[2]:(la.trace("maybe_restart_audio",{type:null==e?void 0:e.type}),[4,Promise.race([new Promise((function(e){return null==E?void 0:E.addEventListener("unmute",e)})),new Promise((function(e){return setTimeout(e,50)}))])]);case 1:return t.sent(),[4,Xe("audio")];case 2:return t.sent()?(la.trace("reacquiring_audio_track"),Me.current=!0,[4,Ke()]):[3,4];case 3:t.sent(),Me.current=!1,t.label=4;case 4:return[2]}}))}))},et=function(e){return En(y,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return Re.current||ne.current?[2]:(la.trace("maybe_restart_video",{type:null==e?void 0:e.type}),[4,Promise.race([new Promise((function(e){return null==x?void 0:x.addEventListener("unmute",e)})),new Promise((function(e){return setTimeout(e,50)}))])]);case 1:return t.sent(),[4,Xe("video")];case 2:return t.sent()?(la.trace("reacquiring_video_track"),Re.current=!0,it(x),[4,Ze()]):[3,4];case 3:t.sent(),rt(x),Re.current=!1,t.label=4;case 4:return[2]}}))}))},tt=function(e){la.warn("Track unmuted",e)},nt=function(){if("visible"===document.visibilityState){var e=new Event("visibility-change");!uo()&&ca.hasFeature(Bi.SKIP_REACQUIRE_AUDIO)?la.trace("skip_audio_reacquire"):$e(e),et(e)}wa.onSafeInitialization((function(){wa.tabChanged("visible"===document.visibilityState),"visible"!==document.visibilityState?wa.browserBackgrounded():wa.browserForegrounded()}))},it=function(e){if(e){la.trace("removing_media_events",{trackId:e.id});var t="audio"===e.kind?$e:et;return e.removeEventListener("ended",t),e.removeEventListener("mute",t),e.removeEventListener("unmute",tt),e}},rt=function(e){if(e){la.trace("adding_media_events",{trackId:e.id});var t="audio"===e.kind?$e:et;return e.addEventListener("ended",t),e.addEventListener("mute",t),e.addEventListener("unmute",tt),e}},ot=function(e){return En(y,void 0,void 0,(function(){return wn(this,(function(t){return Je(sr({selectedDeviceId:e.deviceId})),[2]}))}))};i((function(){We>0&&(Ee.current||(Ee.current=setTimeout((function(){En(y,void 0,void 0,(function(){var e,t,n,i,r,o,a,s,c,l,u,d;return wn(this,(function(m){switch(m.label){case 0:return e=Ba.getAllAudioDevices(),t=Ba.getAllVideoDevices(),n=Ba.getAllSpeakerDevices(),i=e.find((function(e){return!_.map((function(e){return e.deviceId})).includes(e.deviceId)})),k(e),r=t.find((function(e){return!D.map((function(e){return e.deviceId})).includes(e.deviceId)})),N(t),o=n.find((function(e){return!W.map((function(e){return e.deviceId})).includes(e.deviceId)})),U(n),a=!e.map((function(e){return e.deviceId})).includes(null==Le?void 0:Le.selectedDeviceId),s=!t.map((function(e){return e.deviceId})).includes(null==je?void 0:je.selectedDeviceId),c=!n.map((function(e){return e.deviceId})).includes(null==Be?void 0:Be.selectedDeviceId),oe?[3,5]:i&&(null===(u=null==E?void 0:E.getSettings())||void 0===u?void 0:u.groupId)!==i.groupId?[4,Ke(i)]:[3,2];case 1:return m.sent(),[3,5];case 2:return e.length<1?(p((function(){Je(er(kn.NOT_APPLICABLE)),Je(nr(!0)),setTimeout((function(){E&&(it(E),E.stop()),w(void 0)}))})),[3,5]):[3,3];case 3:return a?(l=e[0],[4,Ke(l)]):[3,5];case 4:m.sent(),m.label=5;case 5:return ae?[3,10]:r&&(null===(d=null==x?void 0:x.getSettings())||void 0===d?void 0:d.groupId)!==r.groupId?[4,Ze(r)]:[3,7];case 6:return m.sent(),[3,10];case 7:return t.length<1?(p((function(){Je($i(kn.NOT_APPLICABLE)),Je(rr(!0)),setTimeout((function(){x&&(it(x),x.stop()),T(void 0)}))})),[3,10]):[3,8];case 8:return s?(l=t[0],[4,Ze(l)]):[3,10];case 9:m.sent(),m.label=10;case 10:return o?ot(o):c&&n.length>0&&(l=n[0],ot(l)),[2]}}))})),Ee.current=void 0}),500)))}),[We]),i((function(){return document.addEventListener("visibilitychange",nt),function(){var e,t,n,i;J.current&&J.current.stop(),K.current&&K.current.stop(),(null===(e=Y.current)||void 0===e?void 0:e.video)&&(null===(t=Y.current)||void 0===t||t.video.stop()),(null===(n=Y.current)||void 0===n?void 0:n.audio)&&(null===(i=Y.current)||void 0===i||i.audio.stop()),document.removeEventListener("visibilitychange",nt)}}),[]);var at={mediaTracks:{webcamTrack:x,setWebcamTrack:T,processedWebcamTrack:P,setProcessedWebcamTrack:A,audioTrack:E,setAudioTrack:w,screenShareTracks:z,setScreenShareTracks:L,speakerTrack:B,setSpeakerTrack:F},inputDevices:{audioInputDevices:_,videoInputDevices:D,speakerOutputDevices:W,setAudioInputDevices:k,setVideoInputDevices:N,setSpeakerOutputDevices:U,setAudioDevice:Ke,setVideoDevice:Ze,setSpeakerDevice:ot,toggleAudioState:function(){return En(y,void 0,void 0,(function(){var e;return wn(this,(function(t){switch(t.label){case 0:return qe?(e=!E||"ended"===E.readyState,oe&&e?[4,Ke()]:[3,2]):[2];case 1:return t.sent(),[3,3];case 2:Je(nr(!oe)),t.label=3;case 3:return[2]}}))}))},toggleVideoState:Qe,onAudioInputChange:function(e){return En(y,void 0,void 0,(function(){var t;return wn(this,(function(n){switch(n.label){case 0:return t=_.find((function(t){return t.deviceId===e})),[4,Ke(t)];case 1:return n.sent(),wa.onSafeInitialization((function(){wa.selectedDevice(zi.AUDIO,t)})),[2]}}))}))},onVideoInputChange:function(e){return En(y,void 0,void 0,(function(){var t;return wn(this,(function(n){switch(n.label){case 0:return t=D.find((function(t){return t.deviceId===e})),[4,Ze(t)];case 1:return n.sent(),wa.onSafeInitialization((function(){wa.selectedDevice(zi.VIDEO,t)})),[2]}}))}))},onSpeakerOutputChange:function(e){return En(y,void 0,void 0,(function(){var t;return wn(this,(function(n){switch(n.label){case 0:return t=W.find((function(t){return t.deviceId===e})),[4,ot(t)];case 1:return n.sent(),wa.onSafeInitialization((function(){wa.selectedDevice(zi.SPEAKER,t)})),[2]}}))}))}},processingStatus:{webcamProccessing:H,setWebcamProcessing:G},setupStreams:function(){return En(y,void 0,void 0,(function(){return wn(this,(function(e){switch(e.label){case 0:return[4,Ba.init()];case 1:return e.sent(),[4,En(y,void 0,void 0,(function(){var e,t,n,i,r,o,a,s,c,l,u,d,m,f,h,g,v,y,b,E,S,_,C,x,I;return wn(this,(function(P){switch(P.label){case 0:return P.trys.push([0,7,8,9]),e=X.permissions.produce,t=e.audio,n=e.video.allow,i=null===(S=null===(E=Q.connectionConfig.devicePreferences)||void 0===E?void 0:E.camera)||void 0===S?void 0:S.facing,r=Ba.getAllVideoDevices(),o=function(e){return"default"===(null==e?void 0:e.deviceId)||e.label&&e.label.toLowerCase().includes("default")},a=r.find(o)||r[0],s=Ba.getAllAudioDevices(),c=s.find(o)||s[0],l={devices:[],micDeviceId:"",cameraDeviceId:"",initialWebcamConstraints:ie,timeout:null,facingMode:"user"},s.length>0&&t?(l.devices.push("audio"),l.micDeviceId=c.deviceId):0===s.length&&t?me(qa.NOTFOUND):me(qa.NOT_APPLICABLE),r.length>0&&n?(l.devices.push("video"),i?l.facingMode=i:l.cameraDeviceId=a.deviceId):0===r.length&&n?ge(qa.NOTFOUND):ge(qa.NOT_APPLICABLE),Ba.arePermissionsGranted()&&(l.timeout=15e3),[4,Ba.obtainAudioAndVideoStream(l)];case 1:return u=P.sent(),d=u[0],m=u[1],f=null===(_=d.get("audio"))||void 0===_?void 0:_.track,h=null===(C=d.get("video"))||void 0===C?void 0:C.track,f=rt(f),h=rt(h),Ba.isDeviceListAvailable()?[4,Ba.enumerateDevices()]:[3,3];case 2:P.sent(),r=Ba.getAllVideoDevices(),s=Ba.getAllAudioDevices(),r.some((function(e){return Boolean(e.label)}))&&N(r),s.some((function(e){return Boolean(e.label)}))&&k(s),P.label=3;case 3:return f?(w(f),me(qa.ACCEPTED),Je(ar({selectedDeviceId:(null===(x=f.getSettings())||void 0===x?void 0:x.deviceId)||""})),(g=Ba.getAllSpeakerDevices()).length>0&&(g.some((function(e){return Boolean(e.label)}))&&U(g),v=g.find(o)||g[0],Je(sr({selectedDeviceId:v.deviceId}))),[4,Ye(f)]):[3,5];case 4:return y=P.sent(),la.trace("is_set_audio_device_silent",{isTrackSilent:y}),ca.hasFeature(Bi.NOTIFY_AUDIO_TRACK_SILENCE)&&ue(y),[3,6];case 5:me(m.audio),Je(er(kn.NOT_APPLICABLE)),Je(nr(!0)),P.label=6;case 6:return h?(ae?h.stop():T(h),ge(qa.ACCEPTED),Je(or({selectedDeviceId:(null===(I=h.getSettings())||void 0===I?void 0:I.deviceId)||""}))):(ge(m.video),Je($i(kn.NOT_APPLICABLE)),Je(rr(!0))),[3,9];case 7:return b=P.sent(),la.warn("permission_error",b),me(qa.FAILED),ge(qa.FAILED),p((function(){Je(er(kn.NOT_APPLICABLE)),Je(nr(!0)),Je($i(kn.NOT_APPLICABLE)),Je(rr(!0))})),[3,9];case 8:return Je(oi(!0)),[7];case 9:return[2]}}))}))];case 2:return e.sent(),Ba.setOnDeviceChange((function(){return Je(mr())})),[2]}}))}))},isAudioTrackSilent:le,audioPermission:pe,videoPermission:he,screensharePermission:ye,setScreensharePermission:be,permissionModal:{isOpen:Te,onClose:Ie,onOpen:Pe},screensharePermissionModal:{isOpen:Oe,onOpen:Ne,onClose:De}};return t.createElement(Ka.Provider,{value:at},t.createElement(Ja,{videoPermission:he,audioPermission:pe}),t.createElement(Ya,{screensharePermission:ye}),re)}function Qa(e){var r=e.height,o=window.location.href.replace("/meeting/stage",""),a=d((function(e){return e.participant.displayName})),s=d((function(e){return e.room.password})),c=d((function(e){return e.room.roomName})),l=a+" has invited you to join them on a dyte call. Head over to "+o+" to join them. "+(s?"Meeting password: "+s:""),u=n(!1),p=u[0],m=u[1],f=z(o).onCopy,h=z(l).onCopy,g=function(){m(!0),f()};return i((function(){p&&setTimeout((function(){m(!1)}),5e3)}),[p,m]),t.createElement(L,{bg:"background",direction:"column",height:r,borderRadius:"6px",justify:"center",className:"dyte-client-noSelect"},t.createElement(j,{color:"text.400"},t.createElement(w,{spacing:6,width:"35%"},t.createElement(_,{fontSize:"lg",align:"center",fontWeight:"500",color:"text.400"},"You seem to be alone here,",t.createElement("br",null),"try inviting someone."),t.createElement(L,{justify:"space-between"},t.createElement(_,{color:"text.400"},"Meeting Code"),t.createElement(_,{color:"text.400",className:"dyte-client-selectable"},c)),s&&t.createElement(L,{justify:"space-between"},t.createElement(_,{color:"text.400"},"Password"),t.createElement(_,{color:"text.400",className:"dyte-client-selectable"},s)),t.createElement(L,{direction:"column"},t.createElement(B,null,t.createElement(F,{autoComplete:"off",placeholder:"meeting-url",name:"meetingURL",size:"md",border:"none",value:o.replace(/^https?:\/\//,""),variant:"disabled",bg:"secondary.900",readOnly:!0,onClick:g}),t.createElement(V,{as:W,"aria-label":"copy",icon:p?t.createElement(U,{as:Ke,fill:"text.200"}):t.createElement(U,{as:Ze,fill:"text.200"}),bg:"primary.500",color:"text.400",border:"none",onClick:g})),t.createElement(_,{fontSize:"sm",color:"text.400"},"Share this link to invite participants.")),t.createElement(L,{justify:"center"},t.createElement(k,{variant:"solidDark",bg:"secondary.900",color:"text.200",fontWeight:"500",onClick:h},"Copy Invite Message")))))}function Xa(e){var n=e.height,i=r(ua).sessionConfig;return t.createElement(L,{bg:"background",direction:"column",height:n,width:"100%",borderRadius:"6px",justify:"center",alignItems:"center",className:"dyte-client-noSelect"},t.createElement(w,{direction:(i.theme.waiting_room.enable_preview,"column"),align:"center",spacing:20},i.theme.waiting_room.element?"string"==typeof i.theme.waiting_room.element?t.createElement("div",{dangerouslySetInnerHTML:{__html:i.theme.waiting_room.element}}):i.theme.waiting_room.element:t.createElement(_,{fontSize:"lg",align:"center",fontWeight:"500",color:"text.400"},"You are in the waiting room, the host will let you in soon.")))}Qa.defaultProps={height:"100%"},Xa.defaultProps={height:"100%"};var $a=function(){return"ontouchstart"in window||navigator.maxTouchPoints>0},es=Math.abs,ts=Math.max,ns=Math.min,is=Math.sqrt,rs="undefined"==typeof window,os=!rs&&/(Mac)/i.test(navigator.platform),as=function(e){return"drag"===e},ss=function(e){return"zoom"===e},cs=function(e){return os&&e.ctrlKey},ls=function(e){e.stopPropagation(),e.preventDefault()},us=function(e,t){var n=e.x-t.x,i=e.y-t.y;return is(n*n+i*i)},ds=function(e,t){var n=us(e[0],e[1]);return us(t[0],t[1])/n},ps=function(e){return-Math.cos(e*Math.PI)/2+.5},ms=function(e){return{x:e.pageX,y:e.pageY}},fs=function(e){return Array.from(e).map(ms)},hs=function(e,t){return e+t},gs=function(e,t,n){return n<e?e:n>t?t:n},vs=function(e){return!(e.ctrlKey||e.metaKey)},ys=function(){},bs={x:0,y:0},Es=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n._prevDragMovePoint=null,n._containerObserver=null,n._fingers=0,n._firstMove=!0,n._initialOffset=yn({},bs),n._interaction=null,n._isDoubleTap=!1,n._isOffsetsSet=!1,n._lastDragPosition=null,n._lastScale=1,n._lastTouchStart=0,n._lastZoomCenter=null,n._listenMouseMove=!1,n._nthZoom=0,n._offset=yn({},bs),n._startTouches=null,n._updatePlaned=!1,n._wheelTimeOut=null,n._zoomFactor=1,n._initialZoomFactor=1,n._ignoreNextClick=!1,n._containerRef=e.createRef(),n._handleClick=function(e){n._ignoreNextClick&&(n._ignoreNextClick=!1,e.stopPropagation())},n._onResize=function(){n._updateInitialZoomFactor(),n._setupOffsets(),n._update()},n._handlerOnTouchEnd=n._handlerIfEnable((function(e){n._fingers=e.touches.length,n._updateInteraction(e)})),n._handlerOnTouchStart=n._handlerIfEnable((function(e){n._firstMove=!0,n._fingers=e.touches.length,n._detectDoubleTap(e)})),n._handlerOnTouchMove=n._handlerIfEnable((function(e){n._isDoubleTap||(n._collectInertia(e),n._firstMove?(n._updateInteraction(e),n._interaction&&ls(e),n._startTouches=fs(e.touches)):(ss(n._interaction)?n._startTouches&&2===n._startTouches.length&&2===e.touches.length&&n._handleZoom(e,ds(n._startTouches,fs(e.touches))):as(n._interaction)&&n._handleDrag(e),n._interaction&&(ls(e),n._update())),n._firstMove=!1)})),n._handlerWheel=function(e){if(!n.props.shouldInterceptWheel(e)){ls(e);var t=e.pageX,i=e.pageY,r=e.deltaY,o=e.deltaMode,a=1;(cs(e)||1===o)&&(a=15);var s={touches:[{pageX:t,pageY:i}]},c=n._getOffsetByFirstTouch(s),l=r*a;n._stopAnimation(),n._scaleTo(n._zoomFactor-l/n.props.wheelScaleFactor,c),n._update(),clearTimeout(n._wheelTimeOut),n._wheelTimeOut=setTimeout((function(){return n._sanitize()}),100)}},n._handlers=n.props.isTouch()?[["touchstart",n._handlerOnTouchStart],["touchend",n._handlerOnTouchEnd],["touchmove",n._handlerOnTouchMove]]:[["mousemove",n.simulate(n._handlerOnTouchMove),n.props._document],["mouseup",n.simulate(n._handlerOnTouchEnd),n.props._document],["mousedown",n.simulate(n._handlerOnTouchStart)],["click",n._handleClick],["wheel",n._handlerWheel]],n}return gn(n,t),n.prototype._handleDragStart=function(e){this._ignoreNextClick=!0,this.props.onDragStart(),this._stopAnimation(),this._resetInertia(),this._lastDragPosition=null,this._hasInteraction=!0,this._handleDrag(e)},n.prototype._handleDrag=function(e){var t=this._getOffsetByFirstTouch(e);this._drag(t,this._lastDragPosition),this._offset=this._sanitizeOffset(this._offset),this._lastDragPosition=t},n.prototype._resetInertia=function(){this._velocity=null,this._prevDragMovePoint=null},n.prototype._realizeInertia=function(){var e=this,t=this.props,n=t.inertiaFriction;if(t.inertia&&this._velocity){var i=this._velocity,r=i.x,o=i.y;if(r||o){this._stopAnimation(),this._resetInertia();this._animate((function(){if(o*=n,!(r*=n)&&!o)return e._stopAnimation();var t,i,a=yn({},e._offset);if(e._addOffset({x:r,y:o}),e._offset=e._sanitizeOffset(e._offset),t=a,i=e._offset,t.x===i.x&&t.y===i.y)return e._stopAnimation();e._update({isAnimation:!0})}),{duration:9999})}}},n.prototype._collectInertia=function(e){var t=e.touches;if(this.props.inertia){var n,i,r=fs(t)[0],o=this._prevDragMovePoint;o&&(this._velocity=(n=r,{x:(i=o).x-n.x,y:i.y-n.y})),this._prevDragMovePoint=r}},n.prototype._handleDragEnd=function(){this.props.onDragEnd(),this._end(),this._realizeInertia()},n.prototype._handleZoomStart=function(){this.props.onZoomStart(),this._stopAnimation(),this._lastScale=1,this._nthZoom=0,this._lastZoomCenter=null,this._hasInteraction=!0},n.prototype._handleZoom=function(e,t){var n,i={x:(n=this._getOffsetTouches(e)).map((function(e){return e.x})).reduce(hs,0)/n.length,y:n.map((function(e){return e.y})).reduce(hs,0)/n.length},r=t/this._lastScale;this._lastScale=t,this._nthZoom+=1,this._nthZoom>3&&(this._scale(r,i),this._drag(i,this._lastZoomCenter)),this._lastZoomCenter=i},n.prototype._handleZoomEnd=function(){this.props.onZoomEnd(),this._end()},n.prototype._handleDoubleTap=function(e){this._hasInteraction||(this.props.onDoubleTap(),this._ignoreNextClick=!0,this._isDoubleTap=!0)},n.prototype._computeInitialOffset=function(){var e=this._getContainerRect(),t=this._getChildSize(),n=t.width,i=t.height,r=-es(n*this._getInitialZoomFactor()-e.width)/2,o=-es(i*this._getInitialZoomFactor()-e.height)/2;this._initialOffset={x:r,y:o}},n.prototype._resetOffset=function(){this._offset=yn({},this._initialOffset)},n.prototype._setupOffsets=function(){this.props.setOffsetsOnce&&this._isOffsetsSet||(this._isOffsetsSet=!0,this._computeInitialOffset(),this._resetOffset())},n.prototype._sanitizeOffset=function(e){var t=this._getContainerRect(),n=this._getChildSize(),i=n.width,r=n.height,o=i*this._getInitialZoomFactor()*this._zoomFactor,a=r*this._getInitialZoomFactor()*this._zoomFactor,s=o-t.width+this.props.horizontalPadding,c=a-t.height+this.props.verticalPadding,l=ts(s,0),u=ts(c,0),d=ns(s,0)-this.props.horizontalPadding,p=ns(c,0)-this.props.verticalPadding;return{x:gs(d,l,e.x),y:gs(p,u,e.y)}},n.prototype.alignCenter=function(e){var t=this,n=yn({duration:250,animated:!0},e),i=n.x,r=n.y,o=n.scale,a=n.animated,s=n.duration,c=this._zoomFactor,l=yn({},this._offset),u=this._getContainerRect(),d={x:u.width/2,y:u.height/2};if(this._zoomFactor=1,this._offset={x:-(d.x-i),y:-(d.y-r)},this._scaleTo(o,d),this._stopAnimation(),!a)return this._update();var p=this._zoomFactor-c,m=this._offset.x-l.x,f=this._offset.y-l.y;this._zoomFactor=c,this._offset=yn({},l);this._animate((function(e){var n=l.x+m*e,i=l.y+f*e;t._zoomFactor=c+p*e,t._offset=t._sanitizeOffset({x:n,y:i}),t._update()}),{callback:function(){return t._sanitize()},duration:s})},n.prototype.scaleTo=function(e){var t=this,n=yn({duration:250,animated:!0},e),i=n.x,r=n.y,o=n.scale,a=n.animated,s=n.duration,c=this._zoomFactor,l=yn({},this._offset);if(this._zoomFactor=1,this._offset={x:0,y:0},this._scaleTo(o,{x:i,y:r}),this._stopAnimation(),!a)return this._update();var u=this._zoomFactor-c,d=this._offset.x-l.x,p=this._offset.y-l.y;this._zoomFactor=c,this._offset=yn({},l);this._animate((function(e){var n=l.x+d*e,i=l.y+p*e;t._zoomFactor=c+u*e,t._offset={x:n,y:i},t._update()}),{callback:function(){return t._sanitize()},duration:s})},n.prototype._scaleTo=function(e,t){this._scale(e/this._zoomFactor,t)},n.prototype._scale=function(e,t){var n=this._scaleZoomFactor(e);this._addOffset({x:(n-1)*(t.x+this._offset.x),y:(n-1)*(t.y+this._offset.y)}),this.props.onZoomUpdate()},n.prototype._scaleZoomFactor=function(e){var t=this._zoomFactor;return this._zoomFactor*=e,this._zoomFactor=gs(this.props.minZoom,this.props.maxZoom,this._zoomFactor),this._zoomFactor/t},n.prototype._canDrag=function(){return this.props.draggableUnZoomed||!((e=this._zoomFactor)>(t=1)-.01&&e<t+.01);var e,t},n.prototype._drag=function(e,t){if(t){var n=-(e.y-t.y),i=-(e.x-t.x);this.props.lockDragAxis?es(i)>es(n)?this._addOffset({x:i,y:0}):this._addOffset({y:n,x:0}):this._addOffset({x:i,y:n}),this.props.onDragUpdate()}},n.prototype._addOffset=function(e){var t=this._offset,n=t.x,i=t.y;this._offset={x:n+e.x,y:i+e.y}},n.prototype._sanitize=function(){this._zoomFactor<this.props.zoomOutFactor?this._zoomOutAnimation():this._isInsaneOffset()&&this._sanitizeOffsetAnimation()},n.prototype._isInsaneOffset=function(){var e=this._offset,t=this._sanitizeOffset(e);return t.x!==e.x||t.y!==e.y},n.prototype._sanitizeOffsetAnimation=function(){var e=this,t=this._sanitizeOffset(this._offset),n=yn({},this._offset);this._animate((function(i){var r=n.x+i*(t.x-n.x),o=n.y+i*(t.y-n.y);e._offset={x:r,y:o},e._update()}))},n.prototype._zoomOutAnimation=function(){var e=this;if(1!==this._zoomFactor){var t=this._zoomFactor,n=this._getCurrentZoomCenter();this._animate((function(i){var r=t+i*(1-t);e._scaleTo(r,n)}))}},n.prototype._getInitialZoomFactor=function(){return this._initialZoomFactor},n.prototype._getCurrentZoomCenter=function(){var e=this._offset,t=e.x,n=e.y,i=t-this._initialOffset.x,r=n-this._initialOffset.y;return{x:-1*t-i/(1/this._zoomFactor-1),y:-1*n-r/(1/this._zoomFactor-1)}},n.prototype._getOffsetByFirstTouch=function(e){return this._getOffsetTouches(e)[0]},n.prototype._getOffsetTouches=function(e){var t=this.props._document,n=t.documentElement,i=t.body,r=this._getContainerRect(),o=r.top,a=r.left,s=n.scrollTop||i.scrollTop,c=n.scrollLeft||i.scrollLeft,l=o+s,u=a+c;return fs(e.touches).map((function(e){var t=e.x,n=e.y;return{x:t-u,y:n-l}}))},n.prototype._animate=function(e,t){var n=this,i=(new Date).getTime(),r=yn({timeFn:ps,callback:function(){},duration:this.props.animationDuration},t),o=r.timeFn,a=r.callback,s=r.duration,c=function(){if(n._inAnimation){var t=(new Date).getTime()-i,r=t/s;t>=s?(e(1),n._stopAnimation(),a(),n._update()):(r=o(r),e(r),n._update({isAnimation:!0}),requestAnimationFrame(c))}};this._inAnimation=!0,requestAnimationFrame(c)},n.prototype._stopAnimation=function(){this._inAnimation=!1},n.prototype._end=function(){this._hasInteraction=!1,this._sanitize(),this._update()},n.prototype._getContainerRect=function(){return this._containerRef.current.getBoundingClientRect()},n.prototype._getChildSize=function(){var e=this._containerRef.current;return function(e){if(e){var t=e.offsetWidth,n=e.offsetHeight;if(t&&n)return{width:t,height:n};var i=getComputedStyle(e),r=parseFloat(i.width),o=parseFloat(i.height);if(o&&r)return{width:r,height:o}}return{width:0,height:0}}(e&&e.firstElementChild)},n.prototype._updateInitialZoomFactor=function(){var e=this._getContainerRect(),t=this._getChildSize(),n=e.width/t.width,i=e.height/t.height;this._initialZoomFactor=ns(n,i)},n.prototype._bindEvents=function(){var e=this,t=this._containerRef.current;window.ResizeObserver?this._containerObserver=new ResizeObserver((function(t){window.requestAnimationFrame((function(){Array.isArray(t)&&t.length&&e._onResize()}))})):window.addEventListener("resize",this._onResize),this._handlers.forEach((function(e){var n=e[0],i=e[1];(e[2]||t).addEventListener(n,i,!0)}))},n.prototype._unSubscribe=function(){var e=this._containerRef.current;this._containerObserver&&(this._containerObserver.disconnect(),this._containerObserver=null),window.removeEventListener("resize",this._onResize),this._handlers.forEach((function(t){var n=t[0],i=t[1];(t[2]||e).removeEventListener(n,i,!0)}))},n.prototype._update=function(e){var t=this;if(!this._updatePlaned){var n=function(){var e=t._getInitialZoomFactor()*t._zoomFactor,n=-t._offset.x/e,i=-t._offset.y/e;t.props.onUpdate({scale:e,x:n,y:i})};if(e&&e.isAnimation)return n();this._updatePlaned=!0,requestAnimationFrame((function(){t._updatePlaned=!1,n()}))}},n.prototype._handlerIfEnable=function(e){var t=this;return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];t.props.enabled&&e.apply(void 0,n)}},n.prototype._setInteraction=function(e,t){var n=this._interaction;n!==e&&(n&&!e&&(ss(n)?this._handleZoomEnd():as(n)&&this._handleDragEnd()),ss(e)?this._handleZoomStart():as(e)&&this._handleDragStart(t)),this._interaction=e},n.prototype._updateInteraction=function(e){var t=this._fingers;return 2===t?this._setInteraction("zoom",e):1===t&&this._canDrag()?this._setInteraction("drag",e):void this._setInteraction(null,e)},n.prototype._detectDoubleTap=function(e){var t=(new Date).getTime();this._fingers>2&&(this._lastTouchStart=0),2===this._fingers&&(ls(e),this._handleDoubleTap(e)),t-this._lastTouchStart<700?(ls(e),this._handleDoubleTap(e),ss(this._interaction)?this._handleZoomEnd():as(this._interaction)&&this._handleDragEnd()):this._isDoubleTap=!1,1===this._fingers&&(this._lastTouchStart=t)},n.prototype.simulate=function(e){var t=this;return function(n){var i=n.pageX,r=n.pageY,o=n.type,a="mouseup"===o;"mousedown"===o&&(n.preventDefault(),t._listenMouseMove=!0),t._listenMouseMove&&(n.touches=a?[]:[{pageX:i,pageY:r}],e(n)),a&&(t._listenMouseMove=!1)}},n.prototype.componentDidMount=function(){this._bindEvents(),this._update()},n.prototype.componentWillUnmount=function(){this._stopAnimation(),this._unSubscribe()},n.prototype.render=function(){var t=this.props,n=t.children,i=t.containerProps,r=e.Children.only(n),o=i||{};return e.createElement("div",{className:"dyte-fullWidth"},e.createElement("div",yn({},o,{ref:this._containerRef,className:"dyte-kvfysmfp"}),e.cloneElement(r,{className:"dyte-ufhsfnkm"})))},n.defaultProps={animationDuration:250,draggableUnZoomed:!0,enabled:!0,inertia:!0,inertiaFriction:.96,horizontalPadding:0,isTouch:$a,lockDragAxis:!1,maxZoom:5,minZoom:.5,onDoubleTap:ys,onDragEnd:ys,onDragStart:ys,onDragUpdate:ys,onZoomEnd:ys,onZoomStart:ys,onZoomUpdate:ys,setOffsetsOnce:!1,shouldInterceptWheel:vs,tapZoomFactor:1,verticalPadding:0,wheelScaleFactor:1500,zoomOutFactor:1.3,_document:rs?null:null===window||void 0===window?void 0:window.document},n}(e.Component),ws=function(t){var n=t.children,i=bn(t,["children"]);return ca.hasFeature(Bi.QUICK_ZOOM)?e.createElement(Es,yn({},i),n):e.createElement("div",{className:"dyte-fullWidth"},e.createElement("div",{className:"dyte-kvfysmfp"},n))};ws.defaultProps={onDoubleTap:function(){}};var Ss=function(e){function n(n){var i=e.call(this,n)||this;return i.holder=Math.random(),i.canvas=t.createRef(),i.state={volume:0},i}return gn(n,e),n.prototype.componentDidMount=function(){var e=this.props.track,t=new MediaStream;t.addTrack(e),this.runHark(t),this.draw()},n.prototype.componentDidUpdate=function(e){var t=this.props.track;if(t!==e.track){this.visualizerHark&&this.visualizerHark.stop();var n=new MediaStream;n.addTrack(t),this.runHark(n),this.draw()}},n.prototype.componentWillUnmount=function(){this.visualizerHark&&this.visualizerHark.stop(),Wa.release(this.holder)},n.prototype.runHark=function(e){var t=this;if(!e.getAudioTracks()[0])throw new Error("_runHark() | given stream has no audio track");this.visualizerHark=$t(e,{play:!1,interval:100,audioContext:Wa.getOrCreate(this.holder)}),this.visualizerHark.on("volume_change",(function(e){var n=t.state.volume,i=Math.round(10*Math.pow(10,e/115));i<3&&(i=0);var r=Math.round((2*n+i)/3);n!==r&&(t.setState({volume:r}),t.draw())}))},n.prototype.draw=function(){var e=this.state.volume,t=Math.round(2.5),n=Sn([],Array(5),!0).map((function(n,i){var r=i;return r>t-1&&(r=5-r-1),Math.round((r+1)/(t+1)*e)})),i=this.canvas.current;if(i){var r=i.height,o=i.width,a=i.getContext("2d"),s=2,c=1*o/n.length,l=c-4;a.clearRect(0,0,o,r),a.fillStyle="rgb(0,0,0,0.0)",a.fillRect(0,0,o,r);var u=this.context;a.fillStyle=u.colors.primary[500],a.strokeStyle=u.colors.primary[500],a.lineCap="round",a.lineWidth=3,a.beginPath(),n.forEach((function(e){var t=Math.min(-Math.abs(1.2*e/10*r)+r/2,r/2-2.5),n=Math.max(2*(r/2-t),5);a.moveTo(s+l/2,t),a.lineTo(s+l/2,t+n),s+=c})),a.stroke()}},n.prototype.render=function(){return t.createElement("canvas",{width:"24",height:"24",ref:this.canvas})},n}(s);function _s(e){var n=e.name,i=e.charSize;return t.createElement(P,{whiteSpace:"nowrap",display:"inline"},function(e,t){return e.length>t?e.substring(0,t)+"...":e}(n,i))}function ks(e){var n=e.audioMuted,i=e.audioTrack,r=e.name,o=e.size,a=e.screenshare,s={sm:{px:"2",py:"1",iconSize:"4"},md:{px:"3",py:"2",iconSize:"6"}}[o];return t.createElement(L,{borderRadius:"lg",overflowX:"hidden",m:"sm"===o&&3,position:"relative",transformOrigin:"0 50%"},t.createElement(P,{px:s.px,position:"absolute",py:s.py,width:"100%",height:"100%",bg:"sm"===o||a?"secondary.800":"secondary.900",opacity:"sm"===o||a?"0.5":"1"}),t.createElement(L,{color:"text.300",position:"relative",fontSize:o,justify:"start",px:s.px,py:s.py},!(a&&n)&&t.createElement(j,null,!n&&i?t.createElement(Ss,{track:i}):t.createElement(U,{as:Qe,fill:"danger.500",w:"1.25em",h:"1.25em"})),""!==r.trim()&&t.createElement(j,{ml:s.px},t.createElement(_s,{name:r,charSize:13}))))}function Cs(e){var n=e.isOpen,i=e.onClose,r=e.children,o=e.small,a=e.modalSize,s=e.hasBorder,c=void 0===s||s,l=document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem");return t.createElement(D,{isOpen:n,onClose:i,variant:"primary",isCentered:!0,size:a,portalProps:{containerRef:{current:l}}},t.createElement(N,{bg:"rgba(0,0,0,0.6)"}),t.createElement(R,{borderRadius:"8px",className:"dyte-client-noSelect",color:"text.100",borderWidth:c&&2,borderColor:c&&"primary.300",p:"1px",bg:"secondary.900",width:o?"200px":"100%"},t.createElement(q,null),r))}Ss.contextType=en,_s.defaultProps={charSize:15},ks.defaultProps={size:"md",screenshare:!1},Cs.defaultProps={small:!1,modalSize:"md",hasBorder:!0};var xs=t.createContext({isOpen:!1,closeMenu:function(){},openMenu:function(){},menuRef:void 0,position:{x:0,y:0},setPosition:function(){}}),Ts=function(e){var i=e.children,r=e.close,o=M(),s=o.isOpen,c=o.onClose,l=o.onOpen,u=n({x:0,y:0}),d=u[0],p=u[1],m=a(null);return t.createElement(xs.Provider,{value:{isOpen:s,closeMenu:function(){r&&r(),c()},openMenu:l,menuRef:m,position:d,setPosition:p}},i)};Ts.defaultProps={close:null};var Is=function(e){var n=e.children,i=e.onClick,o=e.icon,a=e.label,s=e.dataCy,c=e.disabled,l=e.badge,u=r(xs).closeMenu;return t.createElement(k,{onClick:function(e){e.preventDefault(),i(e),u()},variant:"secondaryDefault",_hover:{backgroundColor:"primary.500"},borderRadius:0,w:"100%",justifyContent:"left",size:"sm",overflow:"hidden",textOverflow:"ellipsis",disabled:c,"data-cy":s,py:"6"},n||t.createElement(C,null,t.createElement(P,null,o),t.createElement(_,{fontSize:"lg"},a),""!==l&&t.createElement(j,{bgColor:"primary.500",textColor:"text.100",width:5,height:5,fontSize:"sm"},t.createElement("span",null,l))))};Is.defaultProps={disabled:!1,dataCy:"",icon:null,children:null,label:null,badge:""};var Ps,As=function(e){var o=e.children,a=r(xs),s=a.closeMenu,c=a.isOpen,l=a.menuRef,u=a.position,d=u.x,p=u.y,m=n({}),f=m[0],h=m[1];return i((function(){var e,t,n,i,r,o,a=null===(e=null==l?void 0:l.current)||void 0===e?void 0:e.clientHeight,s=null===(t=null==l?void 0:l.current)||void 0===t?void 0:t.clientWidth,c=window.innerWidth,u=window.innerHeight;a&&s&&(d+s>c?i=c-d:n=d,p+a>u?o=u-p:r=p-20,h({top:r?r+"px":null,bottom:o?o+"px":null,left:n?n+"px":null,right:i?i+"px":null}))}),[l,d,p]),H({ref:l,handler:function(){c&&s()}}),t.createElement(P,{ref:l,position:"fixed",bg:"secondary.800",py:1,minW:40,maxW:96,style:{visibility:c?"visible":"collapse",top:f.top,left:f.left,right:f.right,bottom:f.bottom},borderRadius:5,display:"flex",flexDirection:"column",zIndex:1001,border:"2px solid",borderColor:"secondary.700",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.4), 0 4px 6px -4px rgb(0 0 0 / 0.4)"},o)},Os=function(e){var n=e.children,i=e.onInit,o=r(xs),a=o.openMenu,s=o.setPosition;return i(a),t.createElement(P,{onContextMenu:function(e){e.preventDefault(),s({x:e.clientX,y:e.clientY}),a()}},n)},Ds=function(e){var n=e.children,i=r(xs),o=i.closeMenu,a=i.isOpen;return t.createElement(Cs,{isOpen:a,onClose:function(){return o()},small:!0},n,t.createElement(Is,{onClick:function(){return o()}},t.createElement(_,{color:"danger.500"},"Close")))},Ns=function(){function e(e,t,n,i,r,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1),this.socketObj=n,this.peerid=e,wa.authenticate({peerId:e}),this.dispatch=i,this.device=new tn,this.consumers=new Map,this.legacyMode=!0,this.handleSockets=this.handleSockets.bind(this),this.hidden=o,this.roomName=t,this.webcamMutex=1,this.simulcast=a}return e.prototype.setICEServers=function(e){this.ICE_SERVERS=e},e.prototype.handleSockets=function(e,t){if(e)switch(e.type){case"websocket/new-consumer":this.createConsumer(e.payload,t);break;case"websocket/consumer-closed":this.closeConsumer(e.payload);break;case"websocket/consumer-paused":this.pauseConsumer(e.payload);break;case"websocket/consumer-resumed":this.resumeConsumer(e.payload);break;case"websocket/recording-started":this.setRecordingStatus(!0);break;case"websocket/recording-stopped":this.setRecordingStatus(!1);break;case"websocket/disable-video":this.disableWebcam()}},e.prototype.loadRouter=function(){var e;return En(this,void 0,void 0,(function(){var t,n;return wn(this,(function(i){switch(i.label){case 0:return(this.recvTransport||this.sendTransport)&&this.stopAllTransports(),this.dispatch($n(kn.CONNECTING)),[4,null===(e=this.socketObj)||void 0===e?void 0:e.sendMessage({type:"getRouterRtpCapabilities"})];case 1:return t=i.sent(),this.device.loaded&&(this.device=new tn),(n=null==t?void 0:t.payload)&&(n.headerExtensions=n.headerExtensions.filter((function(e){return"urn:3gpp:video-orientation"!==e.uri}))),this.socketObj.emitter.on("socket",this.handleSockets),[2,this.device.load({routerRtpCapabilities:n})]}}))}))},e.prototype.getRoomState=function(){var e;return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return this.dispatch(ei(kn.CONNECTING)),[4,null===(e=this.socketObj)||void 0===e?void 0:e.sendMessage({type:"getRoomState"})];case 1:return t.sent(),this.dispatch(ei(kn.LOADED)),[2]}}))}))},e.prototype.changeRoomDisplayTitle=function(e){var t;return En(this,void 0,void 0,(function(){return wn(this,(function(n){switch(n.label){case 0:return this.dispatch(ei(kn.CONNECTING)),[4,null===(t=this.socketObj)||void 0===t?void 0:t.sendMessage({type:"changeDisplayTitle",payload:{displayTitle:e}})];case 1:return n.sent(),this.dispatch(ei(kn.LOADED)),[2]}}))}))},e.prototype.joinRoom=function(e,t,n){return En(this,void 0,void 0,(function(){var i;return wn(this,(function(r){switch(r.label){case 0:return[4,this.socketObj.sendMessage({type:"joinRoom",payload:{device:yo(),displayName:e.trim(),rtpCapabilities:this.device.rtpCapabilities,isLegacy:this.legacyMode,audioMuted:t}})];case 1:return i=r.sent(),this.legacyMode=i.payload.legacyMode||this.legacyMode,n&&""!==n?[4,this.changeRoomDisplayTitle(n)]:[3,3];case 2:r.sent(),r.label=3;case 3:return this.dispatch(Tn(i.payload)),wa.roomJoined(),wa.legacySwitch(!!this.legacyMode),[2,i]}}))}))},e.prototype.createRecvTransport=function(){return En(this,void 0,void 0,(function(){var e,t,n=this;return wn(this,(function(i){switch(i.label){case 0:return la.trace("createRecvTransport"),void 0===this.socketObj?[2]:(e={forceTcp:!1,producing:!1,consuming:!0},[4,this.socketObj.sendMessage({type:"createWebRtcTransport",payload:e})]);case 1:return t=i.sent().payload,this.recvTransport=this.device.createRecvTransport(yn(yn({},t),{iceServers:this.ICE_SERVERS,proprietaryConstraints:ma})),wa.configureRecvTransport(this.recvTransport),Object.assign(window,{recvTransport:this.recvTransport}),this.recvTransport.on("connect",(function(e,t,i){var r,o,a=e.dtlsParameters;return null===(r=n.socketObj)||void 0===r?void 0:r.sendMessage({type:"connectWebRtcTransport",payload:{transportId:null===(o=n.recvTransport)||void 0===o?void 0:o.id,dtlsParameters:a}},(function(e){e.payload.error?i():t()}))})),this.recvTransport.observer.on("close",(function(){n.recvTransport=void 0,la.warn("recvTransport_closed"),Object.assign(window,{recvTransport:null})})),[2]}}))}))},e.prototype.createSendTransport=function(){return En(this,void 0,void 0,(function(){var e,t,n=this;return wn(this,(function(i){switch(i.label){case 0:return la.trace("createSendTransport"),e={forceTcp:!1,producing:!0,consuming:!1},[4,this.socketObj.sendMessage({type:"createWebRtcTransport",payload:e})];case 1:return t=i.sent().payload,this.sendTransport=this.device.createSendTransport(yn(yn({},t),{iceServers:this.ICE_SERVERS,proprietaryConstraints:ma})),wa.configureSendTransport(this.sendTransport),void 0!==this.sendTransport&&(this.sendTransport.on("connect",(function(e,t,i){var r,o,a=e.dtlsParameters;return null===(r=n.socketObj)||void 0===r?void 0:r.sendMessage({type:"connectWebRtcTransport",payload:{transportId:null===(o=n.sendTransport)||void 0===o?void 0:o.id,dtlsParameters:a}},(function(e){e.payload.error?i():t()}))})),this.sendTransport.on("produce",(function(e,t,i){var r,o,a=e.kind,s=e.rtpParameters,c=e.appData;return null===(r=n.socketObj)||void 0===r?void 0:r.sendMessage({type:"produce",payload:{transportId:null===(o=n.sendTransport)||void 0===o?void 0:o.id,kind:a,rtpParameters:s,appData:c}},(function(e){e.payload.error?i(e.payload.error):t({id:e.payload.id})}))})),this.sendTransport.observer.on("close",(function(){la.warn("sendTransport_closed"),n.sendTransport=void 0,Object.assign(window,{sendTransport:null})}))),[2]}}))}))},e.prototype.createConsumer=function(e,t){return En(this,void 0,void 0,(function(){var n,i,r,o,a,s,c,l,u,d,p;return wn(this,(function(m){switch(m.label){case 0:return void 0===this.recvTransport||this.recvTransport.closed?[2]:(n=e.peerId,i=e.producerId,r=e.id,o=e.kind,a=e.rtpParameters,s=e.type,c=e.appData,l=e.producerPaused,u=e.remotelyPaused,d=e.priority,[4,this.recvTransport.consume({id:r,producerId:i,kind:o,rtpParameters:a,appData:yn(yn({},c),{peerId:n})})]);case 1:return p=m.sent(),this.consumers.set(p.id,p),this.dispatch(Ur({id:r,peerId:n,type:s,kind:o,remotelyPaused:u,producerPaused:l,priority:d,appData:p.appData})),t&&t("Done"),[2]}}))}))},e.prototype.closeConsumer=function(e){return En(this,void 0,void 0,(function(){var t,n;return wn(this,(function(i){return la.trace("closeConsumer",{request:e}),t=e.id,(n=this.consumers.get(t))?(n.close(),this.consumers.delete(t),[2]):[2]}))}))},e.prototype.pauseConsumer=function(e){return En(this,void 0,void 0,(function(){var t,n;return wn(this,(function(i){return la.trace("pauseConsumer",{request:e}),t=e.id,(n=this.consumers.get(t))?(n.pause(),[2]):[2]}))}))},e.prototype.resumeConsumer=function(e){return En(this,void 0,void 0,(function(){var t,n;return wn(this,(function(i){return la.trace("resumeConsumer",{request:e}),t=e.id,(n=this.consumers.get(t))?(n.resume(),[2]):[2]}))}))},e.prototype.shareWebcam=function(e){return En(this,void 0,void 0,(function(){var t,n,i,r,o,a=this;return wn(this,(function(s){switch(s.label){case 0:return la.trace("shareWebcam"),0===this.webcamMutex?[2]:(this.webcamMutex=0,void 0===e||"ended"===e.readyState?(this.dispatch(rr(!0)),[2]):(this.dispatch($i(kn.FETCHED)),this.webCamProducer?[4,this.removeProducer("webCamProducer",!1)]:[3,2]));case 1:s.sent(),s.label=2;case 2:return t=fa,n=this.device.rtpCapabilities.codecs.find((function(e){return"video/vp9"===e.mimeType.toLowerCase()}))||void 0,i=this.device.rtpCapabilities.codecs.find((function(e){return"video/vp8"===e.mimeType.toLowerCase()}))||void 0,n&&!this.legacyMode&&(t=ha),this.dispatch(rr(!1)),r={track:e,encodings:t,codecOptions:{videoGoogleStartBitrate:1e3},codec:function(){return a.legacyMode?i:n}(),appData:{screenShare:!1},stopTracks:!1},o=function(){a.disableWebcam()},[4,this.createProducer("webCamProducer",r,o)];case 3:return s.sent(),this.dispatch($i(kn.LOADED)),this.dispatch(rr(!1)),wa.videoOn(),this.webcamMutex=1,[2]}}))}))},e.prototype.shareScreen=function(e){var t,n;return En(this,void 0,void 0,(function(){var i,r,o,a,s,c,l,u=this;return wn(this,(function(d){switch(d.label){case 0:return la.trace("shareScreen"),i=e.video,r=e.audio,void 0===i||"ended"===i.readyState?(this.dispatch(ir(!1)),[2]):(this.dispatch(ir(!0)),this.dispatch(tr(kn.FETCHED)),o=[],this.simulcast&&(o=ga),a=yn(yn({track:i},o?{encodings:o}:{}),{codecOptions:{videoGoogleStartBitrate:1e3},appData:{screenShare:!0},stopTracks:!1}),s=function(){u.disableScreenShare()},[4,this.createProducer("screenShareVideoProducer",a,s)]);case 1:return d.sent(),r?(c={track:r,codecOptions:{opusDtx:!1,opusStereo:!1,opusFec:!0},appData:{screenShare:!0},stopTracks:!1},l=function(){},[4,this.createProducer("screenShareAudioProducer",c,l)]):[3,3];case 2:d.sent(),d.label=3;case 3:return this.dispatch(tr(kn.LOADED)),wa.screenShareStart(null===(n=null===(t=this.screenShareVideoProducer)||void 0===t?void 0:t.rtpParameters.encodings[0])||void 0===n?void 0:n.ssrc),[2]}}))}))},e.prototype.shareMic=function(e,t){return En(this,void 0,void 0,(function(){var n,i,r=this;return wn(this,(function(o){switch(o.label){case 0:return la.trace("shareMic"),void 0===e||"ended"===e.readyState?(this.dispatch(nr(!0)),[2]):this.micProducer?[4,this.removeProducer("micProducer",!1)]:[3,2];case 1:o.sent(),o.label=2;case 2:return this.dispatch(nr(t||!1)),this.dispatch(er(kn.FETCHED)),n={track:e,codecOptions:{opusDtx:!1,opusStereo:!1,opusFec:!0,opusMaxAverageBitrate:16e3},stopTracks:!1},i=function(){r.disableMic({silent:!0})},[4,this.createProducer("micProducer",n,i)];case 3:return o.sent(),this.dispatch(er(kn.LOADED)),wa.audioOn(),[2]}}))}))},e.prototype.pauseMic=function(){la.trace("pauseMic"),this.dispatch(nr(!0)),this.micProducer.pause()},e.prototype.pauseWebcam=function(){la.trace("pauseWebcam"),this.dispatch(rr(!0)),this.webCamProducer.pause()},e.prototype.resumeMic=function(){la.trace("resumeMic"),this.dispatch(nr(!1)),this.micProducer.resume()},e.prototype.resumeWebcam=function(){la.trace("resumeWebcam"),this.dispatch(rr(!1)),this.webCamProducer.resume()},e.prototype.disableWebcam=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return la.trace("disableWebcam",{data:e}),e&&(null==e?void 0:e.silent)||this.dispatch(rr(!0)),[4,this.removeProducer("webCamProducer",null==e?void 0:e.stopTrack)];case 1:return t.sent(),this.dispatch($i(kn.NOT_STARTED)),wa.videoOff(),[2]}}))}))},e.prototype.disableMic=function(e){la.trace("disableMic",e),e&&(null==e?void 0:e.silent)||this.dispatch(nr(!0)),this.removeProducer("micProducer",null==e?void 0:e.stopTrack),this.dispatch(er(kn.NOT_STARTED)),wa.audioOff()},e.prototype.disableScreenShare=function(e){var t,n;void 0===e&&(e={stopTrack:!0}),la.trace("disableScreenShare",e),this.dispatch(tr(kn.NOT_STARTED)),this.dispatch(ir(!1)),this.removeProducer("screenShareVideoProducer",null==e?void 0:e.stopTrack),this.removeProducer("screenShareAudioProducer",null==e?void 0:e.stopTrack),wa.screenShareStop(null===(n=null===(t=this.screenShareVideoProducer)||void 0===t?void 0:t.rtpParameters.encodings[0])||void 0===n?void 0:n.ssrc)},e.prototype.stopAllProducers=function(e){void 0===e&&(e=!1),la.trace("stopAllProducers",{stopTrack:e}),this.webCamProducer&&this.disableWebcam({stopTrack:e}),this.screenShareVideoProducer&&this.disableScreenShare({stopTrack:e}),this.micProducer&&this.disableMic({stopTrack:e})},e.prototype.stopAllTransports=function(){var e,t;return En(this,void 0,void 0,(function(){return wn(this,(function(n){la.trace("stopAllProducers");try{null===(e=this.sendTransport)||void 0===e||e.close(),null===(t=this.recvTransport)||void 0===t||t.close()}catch(e){la.error("stop_transport_failed",e)}return this.dispatch($n(kn.NOT_STARTED)),[2]}))}))},e.prototype.resetVideoProducers=function(e,t){return En(this,void 0,void 0,(function(){return wn(this,(function(n){switch(n.label){case 0:return la.trace("resetVideoProducers"),e?[4,this.removeProducer("webCamProducer",!1)]:[3,2];case 1:n.sent(),this.shareWebcam(e),n.label=2;case 2:return t?[4,this.removeProducer("screenShareVideoProducer",!1)]:[3,4];case 3:n.sent(),this.shareScreen({video:t}),n.label=4;case 4:return[2]}}))}))},e.prototype.createProducer=function(e,t,n){return En(this,void 0,void 0,(function(){var n,i,r=this;return wn(this,(function(o){switch(o.label){case 0:if(la.trace("createProducer",{producer:e,hidden:this.hidden}),this.hidden)throw new Error("Cant produce in hidden mode");return void 0===this.sendTransport||this.sendTransport.closed?[2]:(n=this,i=e,[4,this.sendTransport.produce(t)]);case 1:return n[i]=o.sent(),this[e].on("transportclose",(function(){la.warn("transport_closed"),r[e]=void 0})),this[e].on("trackended",(function(){la.warn("trackended")})),[2]}}))}))},e.prototype.replaceTrackOnProducer=function(e,t){return En(this,void 0,void 0,(function(){var n,i;return wn(this,(function(r){switch(r.label){case 0:la.trace("replacing track id: "+t.id+" with new on on "+e),n=this[e],r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.replaceTrack({track:t})];case 2:return r.sent(),[3,4];case 3:return i=r.sent(),la.error("Error on replacing track of producer",{error:i,producer:e}),[3,4];case 4:return[2]}}))}))},e.prototype.removeProducer=function(e,t){return void 0===t&&(t=!0),En(this,void 0,void 0,(function(){return wn(this,(function(n){switch(n.label){case 0:return la.trace("removeProduce",{producer:e,stopTrack:t}),!this[e]||this[e].closed?[2]:(t&&this[e].track.stop(),this[e].close(),[4,this.socketObj.sendMessage({type:"closeProducer",payload:{producerId:this[e].id}})]);case 1:return n.sent(),this[e]=null,[2]}}))}))},e.prototype.sendMessage=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.socketObj.sendMessage({type:"chatMessage",payload:e})];case 1:return t.sent(),[2]}}))}))},e.prototype.getMesssages=function(){return En(this,void 0,void 0,(function(){return wn(this,(function(e){switch(e.label){case 0:return[4,this.socketObj.sendMessage({type:"getChatMessages"})];case 1:return e.sent(),[2]}}))}))},e.prototype.getPolls=function(){return En(this,void 0,void 0,(function(){return wn(this,(function(e){switch(e.label){case 0:return[4,this.socketObj.sendMessage({type:"getPolls"})];case 1:return e.sent(),[2]}}))}))},e.prototype.newPoll=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.socketObj.sendMessage({type:"newPoll",payload:e})];case 1:return t.sent(),[2]}}))}))},e.prototype.votePoll=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.socketObj.sendMessage({type:"votePoll",payload:e})];case 1:return t.sent(),[2]}}))}))},e.prototype.acceptWaitingRequest=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.socketObj.sendMessage({type:"acceptWaitingRequest",payload:{id:e}})];case 1:return t.sent(),[2]}}))}))},e.prototype.rejectWaitingRequest=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.socketObj.sendMessage({type:"rejectWaitingRequest",payload:{id:e}})];case 1:return t.sent(),[2]}}))}))},e.prototype.muteAll=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.socketObj.sendMessage({type:"muteAllNew",payload:{allowUnMute:e}})];case 1:return t.sent(),[2]}}))}))},e.prototype.muteAllVideo=function(){return En(this,void 0,void 0,(function(){return wn(this,(function(e){switch(e.label){case 0:return[4,this.socketObj.sendMessage({type:"muteAllVideo"})];case 1:return e.sent(),[2]}}))}))},e.prototype.pin=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.socketObj.sendMessage({type:"pinPeer",payload:{id:e}})];case 1:return t.sent(),[2]}}))}))},e.prototype.disableAudio=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.socketObj.sendMessage({type:"disableAudioPeerNew",payload:{id:e}})];case 1:return t.sent(),[2]}}))}))},e.prototype.disableVideo=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.socketObj.sendMessage({type:"disableVideoPeer",payload:{id:e}})];case 1:return t.sent(),[2]}}))}))},e.prototype.kickAll=function(){return En(this,void 0,void 0,(function(){return wn(this,(function(e){switch(e.label){case 0:return[4,this.socketObj.sendMessage({type:"kickAll"})];case 1:return e.sent(),[2]}}))}))},e.prototype.kick=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.socketObj.sendMessage({type:"kick",payload:{id:e}})];case 1:return t.sent(),[2]}}))}))},e.prototype.getPage=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.socketObj.sendMessage({type:"getPage",payload:{pageNum:e}})];case 1:return t.sent(),[2]}}))}))},e.prototype.setRecordingStatus=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){return window.triggerDyteRecording=e,la.warn("triggerDyteRecording",{status:e}),[2]}))}))},e.prototype.muteSelf=function(){return En(this,void 0,void 0,(function(){return wn(this,(function(e){switch(e.label){case 0:return wa.audioOff(),[4,this.socketObj.sendMessage({type:"muteSelf"})];case 1:return e.sent(),[2]}}))}))},e.prototype.unmuteSelf=function(){return En(this,void 0,void 0,(function(){return wn(this,(function(e){switch(e.label){case 0:return wa.audioOn(),[4,this.socketObj.sendMessage({type:"unmuteSelf"})];case 1:return e.sent(),[2]}}))}))},e.prototype.requestToJoinStage=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.socketObj.sendMessage({type:"requestToJoinStage",payload:e})];case 1:return t.sent(),[2]}}))}))},e.prototype.acceptAllRequestToJoinStage=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.socketObj.sendMessage({type:"acceptAllRequestToJoinStage",payload:e})];case 1:return t.sent(),[2]}}))}))},e.prototype.removePeerFromStage=function(e,t){return En(this,void 0,void 0,(function(){return wn(this,(function(n){switch(n.label){case 0:return[4,this.socketObj.sendMessage({type:"removePeerFromStage",payload:{id:e,type:t}})];case 1:return n.sent(),[2]}}))}))},e.prototype.startPresenting=function(){return En(this,void 0,void 0,(function(){return wn(this,(function(e){switch(e.label){case 0:return[4,this.socketObj.sendMessage({type:"startPresenting"})];case 1:return e.sent(),[2]}}))}))},e.prototype.stopPresenting=function(){return En(this,void 0,void 0,(function(){return wn(this,(function(e){switch(e.label){case 0:return[4,this.socketObj.sendMessage({type:"stopPresenting"})];case 1:return e.sent(),[2]}}))}))},e.prototype.rejectRequestToJoinStage=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.socketObj.sendMessage({type:"rejectRequestToJoinStage",payload:{id:e}})];case 1:return t.sent(),[2]}}))}))},e.prototype.grantPluginAccess=function(e,t){return En(this,void 0,void 0,(function(){return wn(this,(function(n){switch(n.label){case 0:return[4,this.socketObj.sendMessage({type:"grantPluginAccess",payload:{userId:t,pluginId:e}})];case 1:return n.sent(),[2]}}))}))},e.prototype.removePluginAccess=function(e,t){return En(this,void 0,void 0,(function(){return wn(this,(function(n){switch(n.label){case 0:return[4,this.socketObj.sendMessage({type:"removePluginAccess",payload:{userId:t,pluginId:e}})];case 1:return n.sent(),[2]}}))}))},e.prototype.updateRole=function(e,t){return En(this,void 0,void 0,(function(){return wn(this,(function(n){switch(n.label){case 0:return[4,this.socketObj.sendMessage({type:"updatePeerRole",payload:{id:e,roleName:t}})];case 1:return n.sent(),[2]}}))}))},e.prototype.updatePreset=function(e,t){return En(this,void 0,void 0,(function(){return wn(this,(function(n){switch(n.label){case 0:return[4,this.socketObj.sendMessage({type:"updatePeerPreset",payload:{id:e,presetName:t}})];case 1:return n.sent(),[2]}}))}))},e}(),Rs=o(null),Ms=function(e){var r=e.children,o=e.url,s=e.roomURL,c=e.peerId,l=u(),p=a(!1),m=n(),f=m[0],h=m[1],g=d((function(e){return e.participant.authToken}));return i((function(){if(!o||!s||!c)return function(){};var e=new Kt,t=o+"?roomURL="+s+"&peerId="+c+"&authToken="+g+"&version=0.5.0";ca.hasFeature(Bi.CFWS)&&(t="https://ws-proxy-ts.pgo.workers.dev?proxyURL="+encodeURIComponent(t),la.warn("cfWorkerProxyTest"));var n=nn(t,{transports:["websocket"],autoConnect:!0});n.on("close",(function(e){p.current="connection_timeout"===e})),n.on("disconnect",(function(e){la.trace("reason for disconnection: "+e),l(Qn(Cn.DISCONNECTED)),p.current&&n.connect()})),n.io.on("reconnect_failed",(function(){la.error("websocket_connect_error",{url:o,roomURL:s,authToken:g}),window.location.reload()})),n.io.on("ping",(function(){ca.hasFeature(Bi.SOCKET_PINGSTATS)&&la.trace("ping recieved")})),n.io.engine.on("pong",(function(){ca.hasFeature(Bi.SOCKET_PINGSTATS)&&la.trace("pong sent")})),n.on("connect_error",(function(e){!ca.hasFeature(Bi.CFWS)&&ca.hasFeature(Bi.SOCKET_POLLING)&&(n.io.opts.transports=["polling","websocket"]),la.error("websocket_connect_error",{message:e.message,url:o,roomURL:s,authToken:g}),"roomNotFound"===e.message&&window.location.reload()})),n.on("connect",(function(){la.trace("websocket_connected"),l(Qn(Cn.CONNECTED))})),n.io.on("reconnect",(function(){la.trace("websocket_reconnected")})),n.on("event://server-simple-message",(function(t,n){var i=JSON.parse(t);e.emit("socket",i,n),l(i)}));return h({socket:n,sendMessage:function(e,t){return new Promise((function(i){n.emit("event://send-message",JSON.stringify(e),(function(e){var n=JSON.parse(e);"websocket/resolve"!==n.type&&l(n),i(n),t&&t(n)}))}))},emitter:e,roomURL:s}),function(){n.disconnect(),h(null)}}),[o,s,c,g,l]),t.createElement(Rs.Provider,{value:f},r)},zs=function(){function e(){this.buttons=[]}return e.prototype.addButton=function(e){var n=e;return"string"==typeof e.icon&&(n.icon=t.createElement("div",{dangerouslySetInnerHTML:{__html:e.icon}})),this.buttons.push(n),this._setButtons&&this._setButtons(Sn([],this.buttons,!0)),this.buttons.length-1},e.prototype.removeButton=function(e){this.buttons[e]={},this._setButtons(Sn([],this.buttons,!0))},e}();!function(e){e.MULTI="MULTI",e.HIGHLIGHTED="HIGHLIGHTED",e.SINGLE="SINGLE"}(Ps||(Ps={}));var Ls,js=function(){function e(){this.layouts=Ps}return e.prototype.update=function(e){e.layout&&(e.layout===Ps.MULTI&&eo.dispatch(wi("multi")),e.layout===Ps.HIGHLIGHTED&&eo.dispatch(wi("highlighted"))),e.participantVideo&&(this.participantVideoConfiguration=e.participantVideo)},e.prototype.setOverlay=function(e,t){},e}(),Bs=function(){function e(){this.metadata={view_type:"",preset_name:""}}return e.prototype._update=function(e,t){this.id=e.id,this.name=e.displayName,this.picture=e.picture,this.isMe=e.isMe,this.isPinned=e.isPinned,this.videoTrack=e.videoTrack,this.audioTrack=e.audioTrack,this.videoEnabled=e.videoVisible,this.audioEnabled=!e.audioMuted,this.clientSpecificId=e.clientSpecificId,this._participantHook=t,this.metadata=e.metadata},e.prototype.pin=function(){this._participantHook&&this._participantHook.pin(this.id)},e.prototype.unpin=function(){this._participantHook&&this._participantHook.unpin(this.id)},e.prototype.updateRole=function(e){this._participantHook&&this._participantHook.updateRole(this.id,e)},e.prototype.updatePreset=function(e){this._participantHook&&this._participantHook.updatePreset(this.id,e)},e}(),Fs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return gn(t,e),t.prototype.sendMessage=function(e){this._sendMessage&&this._sendMessage(e)},t.prototype.addControl=function(e){this._participantHook&&this._participantHook.addControls(yn(yn({},e),{id:this.id}))},t.prototype.removeControl=function(e){this._participantHook&&this._participantHook.removeControls(yn(yn({},e),{id:this.id}))},t.prototype.disableAudio=function(){this._participantHook&&this.audioEnabled&&this._participantHook.disablePeerAudio(this.id)},t.prototype.disableVideo=function(){this._participantHook&&this.videoEnabled&&this._participantHook.disablePeerVideo(this.id)},t.prototype.setOverlay=function(e){},t.prototype.zoom=function(e){e.scale,e.x,e.y},t.prototype.setLabel=function(e){this._participantHook&&this._participantHook.setLabel(this.id,e)},t}(Bs),Vs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return gn(t,e),t.prototype._update=function(t,n){e.prototype._update.call(this,t,n),this.isScreensharing=t.isScreensharing,this.isPresenting=!t.webinarHiddenParticipant},t.prototype.enableAudio=function(){this._participantHook&&!this.audioEnabled&&this._participantHook.toggleSelfAudio(this.id)},t.prototype.enableVideo=function(){this._participantHook&&!this.videoEnabled&&this._participantHook.toggleSelfVideo(this.id)},t.prototype.disableAudio=function(){this._participantHook&&this.audioEnabled&&this._participantHook.toggleSelfAudio(this.id)},t.prototype.disableVideo=function(){this._participantHook&&this.videoEnabled&&this._participantHook.toggleSelfVideo(this.id)},t.prototype.enableScreenshare=function(){this._participantHook&&!this.isScreensharing&&this._participantHook.toggleSelfScreenSharing()},t.prototype.disableScreenshare=function(){this._participantHook&&this.isScreensharing&&this._participantHook.toggleSelfScreenSharing()},t.prototype.setOverlay=function(e){this._videoHook.setPeerOverlayElement(e)},t.prototype.zoom=function(e){var t=e.scale,n=e.x,i=e.y;this._videoHook.setPeerZoom({scale:t,x:n,y:i})},t.prototype.startPresenting=function(){this._participantHook&&!this.isPresenting&&this._participantHook.toggleSelfPresenting()},t.prototype.stopPresenting=function(){this._participantHook&&this.isPresenting&&this._participantHook.toggleSelfPresenting()},t}(Bs),Ws=o(null),Us=function(e){var o,a=e.children,s=r(ua),c=s.meeting,l=s.sessionConfig,p=n([]),m=p[0],f=p[1],h=d((function(e){return e.peers.joinedPeers})),g=d((function(e){return e.room.roomViewType})),v=d((function(e){return e.participant})),y=d((function(e){return e.consumers.activeConsumers})),b=y.filter((function(e){return"video"===e.kind&&e.appData.screenShare})),E=y.filter((function(e){return"audio"===e.kind&&e.appData.screenShare})),w=d((function(e){return e.room.pinnedPeerId})),S=n(null),_=S[0],k=S[1],C=n({}),x=C[0],T=C[1],I=n([]),P=I[0],A=I[1],O=u(),D=b.length<(l.permissions.max_screenshare_count||1),N=r(Ks).mediaRoom,R=r(Ka),M=R.mediaTracks,z=M.screenShareTracks,L=M.setScreenShareTracks,j=M.webcamTrack,B=M.audioTrack,F=M.processedWebcamTrack,V=R.inputDevices,W=V.toggleAudioState,U=V.toggleVideoState,q={pin:function(e){return N.pin(e)},unpin:function(e){return N.pin(null)},toggleSelfAudio:function(){return W()},addControls:function(e){var t;x[e.id]?((t=x)[e.id]=Sn(Sn([],t[e.id].filter((function(t){return t.label!==e.label})),!0),[e],!1),T(t)):((t=x)[e.id]=[e],T(t))},removeControls:function(e){var t=x;if(t[e.id]){t[e.id]=t[e.id].filter((function(t){return t.label!==e.label})),t[e.id].length<=0&&delete t[e.id];var n=yn({},t);T(n)}},toggleSelfVideo:function(){return U()},toggleSelfPresenting:function(){v.webinarHiddenParticipant?O(kr()):N.stopPresenting()},toggleSelfScreenSharing:function(){return En(void 0,void 0,void 0,(function(){var e,t;return wn(this,(function(n){switch(n.label){case 0:if(v.sharingScreen||!D)return[3,5];void 0!==(null==z?void 0:z.video)&&(null==z||z.video.stop()),void 0!==(null==z?void 0:z.audio)&&(null==z||z.audio.stop()),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Ca()];case 2:return e=n.sent(),L({video:e.video,audio:e.audio}),[3,4];case 3:return t=n.sent(),la.error("screenshare_toggle_failed",t),[3,4];case 4:return[3,6];case 5:N.disableScreenShare(),L(void 0),n.label=6;case 6:return[2]}}))}))},disablePeerAudio:function(e){return N.disableAudio(e)},disablePeerVideo:function(e){return N.disableVideo(e)},updateRole:function(e,t){return N.updateRole(e,t)},updatePreset:function(e,t){return N.updatePreset(e,t)},setLabel:function(e,t){O(Gn({id:e,label:t}))}},H=!0;i((function(){k({id:null==N?void 0:N.peerid,audioMuted:v.audioMuted,displayName:v.displayName,userId:v.id,picture:v.displayImageURL,isMe:!0,videoVisible:!v.videoOff,videoTrack:F||j,audioTrack:B,isPinned:w&&w===(null==N?void 0:N.peerid),clientSpecificId:v.clientSpecificId,videoConsumerId:v.videoOff?void 0:"dummy",audioConsumerId:v.audioMuted?void 0:"dummy",isScreensharing:v.sharingScreen,hiddenParticipant:v.hidden,metadata:v.metadata,requestToJoinType:v.requestToJoinType,webinarHiddenParticipant:v.webinarHiddenParticipant})}),[null==N?void 0:N.peerid,v.sharingScreen,v.videoOff,v.audioMuted,v.displayName,j,F,null===(o=null==N?void 0:N.micProducer)||void 0===o?void 0:o.track,w,v.hidden,v.requestToJoinType,B,v.videoProduction,v.metadata]),i((function(){_&&c&&c._addUpdateParticipant(yn(yn({},_),{isPinned:_.id===w,isScreensharing:v.sharingScreen}),q)}),[_,c,L]),i((function(){var e=[];v.screenSharingProduction===kn.LOADED&&e.push({videoTrack:null==z?void 0:z.video,id:null==_?void 0:_.id,displayName:"Screen - "+(null==_?void 0:_.displayName),videoVisible:!0,audioTrack:null,audioMuted:!0,screenshare:!0}),b.forEach((function(t){var n,i,r,o=null===(n=N.consumers.get(t.id))||void 0===n?void 0:n.track,a=E.find((function(e){return e.appData.peerId===t.appData.peerId}));a&&(r=null===(i=N.consumers.get(a.id))||void 0===i?void 0:i.track);var s=h.find((function(e){return e.id===t.appData.peerId}));e.push({videoTrack:o,id:null==s?void 0:s.id,displayName:"Screen - "+(null==s?void 0:s.displayName),videoVisible:!0,audioTrack:r,audioMuted:null===r,screenshare:!0})})),A(e)}),[b.length,E.length,v.screenSharingProduction]),i((function(){c&&(m.map((function(e){return h.find((function(t){return t.id===e.id}))||e.id===_.id||c._removeParticipant(e),null})),f(h))}),[h]);var G=function(e){var t=yn(yn({},e),{isPinned:w===e.id,isScreensharing:!1}),n=y.find((function(t){return t.peerId===e.id&&"video"===t.kind&&!t.appData.screenShare})),i=y.find((function(t){return t.peerId===e.id&&"audio"===t.kind&&!t.appData.screenShare}));return n&&(t.videoConsumerId=n.id,t.videoTrack=N.consumers.get(n.id).track),i&&(t.audioConsumerId=i.id,t.audioTrack=N.consumers.get(i.id).track),b.find((function(t){var n;return(null===(n=t.appData)||void 0===n?void 0:n.peerId)===e.id}))&&(t.isScreensharing=!0),t.videoVisible=!(void 0===n||n.remotelyPaused),t.audioMuted=void 0===i||e.audioMuted,t.audioMuted||(H=!1),c&&t.id!==_.id&&c._addUpdateParticipant(yn(yn({},t),{isPinned:t.id===w}),q),t},J=g===Mi.webinar?h.filter((function(e){return!(null==e?void 0:e.webinarHiddenParticipant)&&(null==e?void 0:e.requestToJoinType)!==qi.ask})).map(G).filter((function(e){return null!==e})):h.filter((function(e){return!(null==e?void 0:e.hiddenParticipant)})).map(G).filter((function(e){return null!==e})),Y=h.map(G).filter((function(e){return null!==e}));return t.createElement(Ws.Provider,{value:{processedPeers:J,selfPeer:_,allMuted:H,screenshareVideoConsumers:b,screenshareAudioConsumers:E,screenSharePeers:P,joinedProcessedPeers:Y,individualControls:x}},a)},qs=function(){function e(){this.modules=[]}return e.prototype.getAll=function(){return this.modules},e.prototype.add=function(e){this.modules.push(e)},e.prototype.initAndAdd=function(e,t){if(!bo()&&!uo()){var n=e({themeContext:en,peerContext:Ws,userTrackContext:Ka,mediaRoomContext:Ks});n.hidden=t,this.modules.push(n)}},e}(),Hs={en:{translation:{check_audio_video:"Check your audio and video",check_audio:"Check your audio",leave_stage_header:"Do you want to leave the stage?",no_active_plugin:"No active plugin, activate one below 👇🏽",confirm_leave:"Are you sure you want to leave the call?"}},es:{translation:{check_audio_video:"Compruebe su audio y vídeo",leave_stage_header:"Do you want to leave the stage?",no_active_plugin:"Ningún plugin activo, active uno a continuación 👇🏽","Mute All":"Silenciar todos","Mic Off":"Apagar micro","Video Off":"Apagar vídeo",Leave:"Abandonar",Polls:"Encuestas",Participants:"Participantes",Pin:"Fijar","Mute Audio":"Silenciar audio","Disable Video":"Desactivar vídeo",Plugins:"Plugins","Active Plugin":"Activar plugin",File:"Archivo",Poll:"Encuesta",Image:"Imágen","End Meeting for All":"Terminar reunión para todos","Create Poll":"Crear encuesta","Create New Poll":"Crear encuesta",Speaker:"Altavoce","Output Speaker Device":"Altavoce","Input Microphone Device":"Micrófono",Microphone:"Micrófono",Camera:"Cámara","Camera Device":"Cámara",Join:"Unirse","Full Screen":"Pantalla completa","Share Screen":"Compartir pantalla",Layout:"Composición","Cancel Poll Creation":"Cancelar creación de encuesta","View only":"Solo ver","Full control":"Control completo","Poll Question":"Pregunta de la encuesta","What is your poll for ?":"¿Para qué es su encuesta?","Enter an option":"Introducir una opción","Add an option":"Añadir una opción",Anonymous:"Anónimo","Hide results before voting":"Ocultar resultados antes de votar","Type a message...":"Escriba un mensaje",confirm_leave:"¿Está seguro que quiere abandonar la llamada?",Connecting:"Conectando",Reconnecting:"Reconectando","Waiting for permissions":"Esperando permisos"}},pt:{translations:{check_audio_video:"Compre seu áudio e vídeo",leave_stage_header:"Você quer sair do palco?",no_active_plugin:"Ningún plugin ativo, ativo uma continuação 👇🏽","Mute All":"Silenciar todos","Mic Off":"Apagar micro","Video Off":"Apagar vídeo",Leave:"Abandonar",Polls:"Encuestas",Participants:"Participantes",Pin:"Fijar","Mute Audio":"Silenciar áudio","Disanle video":"Desativar vídeo",Plugins:"Plugins","Active Plugin":"Ativar plugin",File:"Arquivo",Poll:"Enquete",Image:"Imagem","End Meeting for All":"Terminar reunión para todos","Create Poll":"Criar encuesta","Create New Poll":"Criar encuesta",Speaker:"Altavoce","Output Speaker Device":"Altavoce","Input Microphone Device":"Micrófono",Microphone:"Microfone",Camera:"Câmara","Camera Device":"Câmara",Join:"Unirse","Full Screen":"Pantala Completa","Share Screen":"Compartilhar pantalla",Layout:"Esquema","Cancel Poll Creation":"Cancelar criação de consulta","View Only":"Versão individual","Full Control":"Controle completo","Poll Question":"Pregunta de la encuesta","What is your poll for ?":"Para que serve sua enquete?","Enter an option":"Introdução de uma opção","Add an option":"Adicionar uma opção",Anonymous:"Anônimo","Hide results before voting":"Ocultar resultados antes de votar","Type a message...":"Digite uma mensagem",confirm_leave:"¿Está seguro que quer abandonar a lhamada?",Connecting:"Conectando",Reconnecting:"Reconectando","Waiting for permissions":"Esperando permissões"}}},Gs=function(e){var n=e.useShadowDom,i=e.children;return n&&(document.head.createShadowRoot||document.head.attachShadow)?t.createElement(an.div,{id:"dyte-shadow"},t.createElement("style",null,Dr),t.createElement("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css?family=Inter:400,500,600|Lato:300,400,600"}),t.createElement("style",null,"* {\n\t\t\tfont-family: 'Inter';\n\t\t}"),i):t.createElement(t.Fragment,null,t.createElement("style",null,Dr),i)};!function(e){e.participantJoin="participantJoin",e.participantLeave="participantLeave",e.disconnect="disconnect",e.connect="connect",e.meetingEnded="meetingEnded",e.roomMessage="roomMessage",e.chatMessage="chatMessage",e.message="message",e.meetingJoined="meetingJoined",e.activeSpeaker="activeSpeaker",e.recordingStarted="recordingStarted",e.recordingStopped="recordingStopped",e.participantVideoZoomed="participantVideoZoomed",e.localMediaConnected="localMediaConnected",e.screenSharingUpdated="screenSharingUpdated",e.audioUpdated="audioUpdated",e.videoUpdated="videoUpdated"}(Ls||(Ls={}));var Js=yn({},aa),Ys=function(e){function n(t,n){var i=e.call(this)||this;i.config=Js,i.participants=[],i.showSetupScreen=!1,i.leaveRoom=function(){},i.kickAll=function(){},i.openChatView=function(){},i.closeChatView=function(){},i.kick=function(e){},i.enablePiP=function(){},i.disablePiP=function(){},i._uiConfig={},i.connectionConfig=t;var r,o=JSON.parse(JSON.stringify(n||{}));return i._uiConfig=o,i.config.theme=oa(i.config.theme,o),i.controlBar=new zs,i.grid=new js,i.Events=Ls,i.modules=new qs,i.plugins=[],i.isPiPEnabled=!1,r=t.lang||document.documentElement.lang||"en",sn.use(cn).init({resources:Hs,lng:r,interpolation:{escapeValue:!1}}),la.trace("roomName",i.connectionConfig.roomName),(null==t?void 0:t.apiBase)&&Rr(t.apiBase),i}return gn(n,e),n.prototype.updateUIConfig=function(e){this._uiConfig=Ko(this._uiConfig,e),this.config.theme=oa(this.config.theme,e),this._setUIConfig&&this._setUIConfig(this.config)},n.prototype.addParticipantControl=function(e){this._controlsHook(e)},n.prototype.sendRoomMessage=function(e){},n.prototype.sendMessage=function(e,t){},n.prototype.createPopup=function(e){},n.prototype.closePopup=function(){this.createPopup(null)},n.prototype.onError=function(e){this._onError=e},n.prototype.onSocketMessage=function(e){var t,n;switch(e.type){case"websocket/room-message":this.emit(Ls.roomMessage,null===(t=e.payload)||void 0===t?void 0:t.message);break;case"websocket/message":this.emit(Ls.message,null===(n=e.payload)||void 0===n?void 0:n.message);break;case"websocket/new-chat-message":this.emit(Ls.chatMessage,e.payload)}},n.prototype._addUpdateParticipant=function(e,t){if(e.id){var n=this.participants.findIndex((function(t){return t.id===e.id}));if(-1===n){if(e.isMe)(i=new Vs)._update(e,t),this.participants.push(i),this.self=i;else(i=new Fs)._update(e,t),this.participants.push(i),this.emit(Ls.participantJoin,i)}else{var i=this.participants[n];e.isMe&&(i.isScreensharing!==e.isScreensharing&&this.emit(this.Events.screenSharingUpdated,e.isScreensharing),i.audioEnabled!==!e.audioMuted&&this.emit(this.Events.audioUpdated,!e.audioMuted),i.videoEnabled!==e.videoVisible&&this.emit(this.Events.videoUpdated,e.videoVisible)),i._update(e,t)}}},n.prototype._removeParticipant=function(e){var t=this.participants.find((function(t){return t.id===e.id}));this.participants=this.participants.filter((function(t){return t.id!==e.id})),this.emit(Ls.participantLeave,t)},n.prototype._render=function(e){rn.render(t.createElement(t.StrictMode,null,t.createElement("div",{className:"dyte-client dyte-client-root"},t.createElement("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css?family=Inter:400,500,600|Lato:300,400,600"}),t.createElement(Gs,{useShadowDom:this.connectionConfig.useShadowDOM},t.createElement("div",{id:"dyte-base-elem"},t.createElement(m,{store:eo},t.createElement(He.Provider,{value:to(this.connectionConfig.apiBase)},t.createElement(da,{meeting:this},t.createElement(Za,null,t.createElement(ql,{roomName:this.connectionConfig.roomName,autoTune:void 0===this.connectionConfig.autoTune||this.connectionConfig.autoTune}))))))))),document.getElementById(e))},n.prototype.init=function(e){var t=this;"loading"!==document.readyState?this._render(e):window.addEventListener("load",(function(){t._render(e)})),this.on(Ls.meetingEnded,(function(){rn.unmountComponentAtNode(document.getElementById(e)),document.querySelectorAll(".chakra-portal").forEach((function(e){return e.remove()}))}))},n}(Kt),Ks=o(null),Zs=function(e){var o=e.children,s=e.peerId,c=e.roomName,l=e.autoTune,m=r(Rs),f=r(ua),h=f.meeting,g=f.sessionConfig.permissions,v=r(Ka),y=v.mediaTracks,b=y.webcamTrack,E=y.processedWebcamTrack,w=y.audioTrack,S=v.processingStatus.webcamProccessing,_=u(),k=n(null),C=k[0],x=k[1],T=a(null),I=d((function(e){return e.room.socketState})),P=d((function(e){return e.room.producersState})),A=d((function(e){return e.participant.videoProduction})),O=d((function(e){return e.participant.audioProduction})),D=d((function(e){return e.participant.audioMuted}));i((function(){C&&(T.current=C)}),[C]),i((function(){D?null==C||C.muteSelf():null==C||C.unmuteSelf()}),[D]),i((function(){if(P===kn.LOADED)if(b||A!==kn.STOPPING)if(S){if(!E)return;A===kn.LOADED?null==C||C.webCamProducer.replaceTrack({track:E}):A===kn.CONNECTING&&(null==C||C.shareWebcam(E))}else!S&&A===kn.LOADED&&b&&(null==C?void 0:C.webCamProducer.track.id)!==b.id?null==C||C.webCamProducer.replaceTrack({track:b}):b&&A===kn.CONNECTING&&(null==C||C.shareWebcam(b));else null==C||C.disableWebcam()}),[b,A,S,E]),i((function(){P===kn.LOADED&&(w&&O===kn.CONNECTING?null==C||C.shareMic(w):w&&O===kn.LOADED?null==C||C.replaceTrackOnProducer("micProducer",w):O!==kn.CONNECTING&&O!==kn.STOPPING||null==C||C.disableMic())}),[w,O]),i((function(){var e;if(I===Cn.CONNECTED){h&&h.emit(h.Events.connect);var t=new Ns(s,c,m,_,l,!1,!!ca.hasFeature(Bi.SIMULCAST));x(t),t.setRecordingStatus(!0),e=t,En(void 0,void 0,void 0,(function(){var t;return wn(this,(function(n){switch(n.label){case 0:return[4,Ea()];case 1:return t=n.sent(),e.setICEServers(t),[4,e.getRoomState()];case 2:return n.sent(),[4,e.loadRouter()];case 3:return n.sent(),[4,Promise.all([e.createRecvTransport(),e.createSendTransport()])];case 4:return n.sent(),h&&(h.sendRoomMessage=function(e){m.sendMessage({type:Ls.roomMessage,payload:{message:e}})},h.sendMessage=function(e,t){m.sendMessage({type:Ls.message,payload:{peerId:e,message:t}})},h.kickAll=function(){g.kick_participant&&e.kickAll()},h.kick=function(t){g.kick_participant&&e.kick(t)},h.enablePiP=function(){vo()&&_(Kn(!0))},h.disablePiP=function(){vo()&&_(Kn(!1))},null==m||m.emitter.on("socket",(function(e){h.onSocketMessage(e)}))),_($n(kn.LOADED)),_(ni(kn.NOT_STARTED)),[2]}}))}))}else I===Cn.DISCONNECTED&&(null==C||C.stopAllTransports(),null==m||m.emitter.removeAllListeners(),p((function(){_(On()),_(cr(!0)),_(Yr()),_($r())})),x(null),$n(kn.NOT_APPLICABLE))}),[I,s]),i((function(){return function(){var e,t;null===(e=T.current)||void 0===e||e.stopAllProducers(),null===(t=T.current)||void 0===t||t.stopAllTransports()}}),[]);var N={mediaRoom:C};return t.createElement(Ks.Provider,{value:N},o)},Qs=function(e){return e.videoScore<4?t.createElement(U,{zIndex:5,as:ro,color:"danger.500"}):t.createElement(U,{zIndex:5,as:ro,fill:"warning.500"})};function Xs(e){var n=e.name,i=e.size,r=e.imgSrc,o=e.dimensions,a=e.fontSize;return t.createElement(G,{className:"dyte-client-noSelect",size:i,bg:"primary.500",color:"text.200",h:o,w:o,name:(n||"").trim(),src:r,fontSize:a})}Xs.defaultProps={imgSrc:"",size:"sm",dimensions:null,fontSize:"inherit"};var $s=o(null),ec=function(e){var n=u(),o=a(null),s=a(null),c=t.useRef(),l=d((function(e){return e.room.pipMode})),p=r(ua).meeting,m=e.children,f=a([]),h=function(){var e=f.current.length,t=function(e,t,n){switch(n){case 0:case 1:case 2:return[Math.floor(e/2),t];case 3:case 4:return[Math.floor(e/2),Math.floor(t/2)];case 5:case 6:default:return[Math.floor(e/3),Math.floor(t/2)]}}(1280,720,e),n=t[0],i=t[1],r=o.current.getContext("2d");!function(e){var t=e.gridW,n=e.gridH,i=e.videoRefs,r=e.gridSize,o=e.ctx;o.fillStyle="#000000",o.fillRect(0,0,1280,720);for(var a,s,c,l,u,d,p,m,f,h,g,v,y,b,E=0,w=0;E<715;){for(var S=0;S<1275&&w<r;){var _=i.current[w].video;o.drawImage.apply(o,Sn([_],(a=S,s=E,c=t,l=n,u=void 0,d=void 0,p=void 0,m=void 0,f=void 0,h=void 0,g=void 0,v=void 0,y=void 0,b=void 0,f=_.videoWidth,y=(h=_.videoHeight)*(g=Math.min(c/f,l/h)),b=1,(v=f*g)<c&&(b=c/v),Math.abs(b-1)<1e-14&&y<l&&(b=l/y),(u=.5*(f-(p=f/((v*=b)/c))))<0&&(u=0),(d=.5*(h-(m=h/((y*=b)/l))))<0&&(d=0),p>f&&(p=f),m>h&&(m=h),[u,d,p,m,a,s,c,l]),!1)),w+=1,S+=t}E+=n}}({gridW:n,gridH:i,videoRefs:f,gridSize:e,ctx:r})};return i((function(){if(l){var e=document.createElement("canvas");e.height=720,e.width=1280,o.current=e;var t=document.createElement("video");t.height=720,t.width=1280,t.autoplay=!0,s.current=t,t.srcObject=e.captureStream(24),t.onloadedmetadata=function(e){try{t.requestPictureInPicture(),p.isPiPEnabled=!0,t.onleavepictureinpicture=function(){n(Kn(!1)),c.current=void 0}}catch(e){la.error("pip_failed",e)}};var i=function(){h(),c.current&&(c.current=requestAnimationFrame(i))};c.current=requestAnimationFrame(i)}else try{document.pictureInPictureElement&&(document.exitPictureInPicture(),p.isPiPEnabled=!1,c.current=void 0)}catch(e){}}),[l]),t.createElement($s.Provider,{value:{registerVideoRef:function(e,t){f.current=f.current.filter((function(t){return t.peerId!==e})).concat([{peerId:e,video:t}])},deregisterVideoRef:function(e){f.current=f.current.filter((function(t){return t.peerId!==e}))}}},m)};function tc(e){var o=e.peer,s=e.hideBadge,l=e.isMobile,p=e.totalPeers,m=e.size,f=e.pipMode,h=e.isInactiveScreenShare,g=n(!1),v=g[0],y=g[1],b=d((function(e){return e.participant.displayName})),E=d((function(e){return e.room.roomViewType})),_=r(Ks),k=null==_?void 0:_.mediaRoom,C=J().colors,x=d((function(e){return e.consumers.consumerScores[null==o?void 0:o.videoConsumerId]})),T=(null==x?void 0:x.score)||10,I=r(ua),A=I.meeting,O=I.sessionConfig,D=I.participantControls,N=a(),R=r($s),M=a(null),z=a(null),j=n(null),B=j[0],F=j[1],V=u(),W=function(e){return e?Ds:As}(l),U=d((function(e){return e.participant.displayImageURL})),q=d((function(e){return e.peers.videoTransforms[null==o?void 0:o.id]}))||"",H=o.isMe?U:o.picture,G=function(){try{var e=o.videoTrack&&"function"==typeof o.videoTrack.getCapabilities?o.videoTrack.getCapabilities():null;return(null==e?void 0:e.facingMode)||[]}catch(e){return la.trace("get_video_track_capbility_failure",e),[]}};i((function(){var e=o.videoTrack;o.videoVisible&&function(e){N.current=e;var t=z.current;if(e){var n=new MediaStream;if(n.addTrack(e),t){t.srcObject=n,t.oncanplay=function(){return y(!0)};var i=t.play();o.screenshare||null==R||R.registerVideoRef(o.id,z.current),null==i||i.catch((function(e){wa.mediaPlaybackFailed("VIDEO"),la.error("videoElem_play_failed",e)}))}}else t&&(t.srcObject=null,o.screenshare||null==R||R.deregisterVideoRef(o.id))}(e)}),[o.videoTrack,o.videoVisible]);var Z=function(e){z.current=e},Q=function(e){var t=e.x,n=e.y,i=e.scale,r=z.current;if(r){var a=function(e){var t=e.x,n=e.y,i=e.scale;return"scale3d("+i+","+i+", 1) translate3d("+t+"px, "+n+"px, 0)"}({x:t,y:n,scale:i});r.style.setProperty("transform",a),V(Ln({peerId:o.id,transform:a}))}};i((function(){if(A){var e=A.participants.find((function(e){return e.id===o.id}));e&&(e.setOverlay=F,e.zoom=Q)}}),[A]);var X=c((function(e){var t=e.x,n=e.y,i=e.scale;if(l&&(Q({x:t,y:n,scale:i}),A)){var r=A.participants.find((function(e){return e.id===o.id}));A.emit(A.Events.participantVideoZoomed,{participant:r,zoom:{x:t,y:n,scale:i}})}}),[]),$=function(n,i,r,a,s){var c=e.width,u=e.maxVideoHeight,d=e.contain,p=e.isSideView,h=function(e,t){return{newHeight:"number"==typeof e?e+"px":e,newWidth:"number"==typeof t?t+"px":t}}(i,c);return n?t.createElement(L,{width:"100%",padding:l?"3px":p?"0px":"5px",justifyContent:"center",className:o.isMe&&!G().includes("environment")?"dyte-client-invertOnly":""},T<10&&t.createElement(P,{position:"absolute",top:"1em",right:"1em",zIndex:5},t.createElement(Qs,{videoScore:T})),(0===T||!a)&&t.createElement(S,{zIndex:10,color:"text.100",position:"absolute",top:0,bottom:0,marginTop:"auto",marginBottom:"auto"}),t.createElement(ws,{onUpdate:X,onDoubleTap:function(){l&&M.current&&M.current()}},t.createElement("video",{ref:Z,style:{visibility:n?"visible":"hidden",height:h.newHeight,width:h.newWidth,maxHeight:u||"100vh",objectFit:d?"contain":"cover",backgroundColor:"secondary.800",borderRadius:"6px",filter:"blur("+(0===T?"4px":"0px")+")",opacity:0===T?.25:1,transform:q,boxShadow:f?"0px 2px 9px -1px rgba(0,0,0,0.5)":"none"},className:Xt({hidden:!n}),autoPlay:!0,playsInline:!0,muted:!0,controls:!1}))):t.createElement(L,{width:"100%",padding:l?"3px":p?"0px":"5px",justifyContent:"center"},t.createElement(ws,{onUpdate:function(){},onDoubleTap:function(){l&&M.current&&M.current()}},t.createElement(L,{className:"dyte-client-peerVideo",backgroundColor:"background",height:h.newHeight,width:h.newWidth,justify:"center",align:"center",borderRadius:"6px",boxShadow:f?"0px 2px 9px -1px rgba(0,0,0,0.5)":"none"},t.createElement(Xs,{size:"sm"===m||f?"lg":"xl",name:s.trim(),imgSrc:r,fontSize:"1em"}))))},ee=o.audioMuted,te=o.videoVisible,ne=o.isPinned,ie=o.isScreensharing,re=function(e){if(!l)return e;var t=e;return p>2&&(t=(t=e.split(" ")[0]).slice(0,10)),p>6&&(t=t.slice(0,8)),t}(o.isMe?b:o.displayName),oe=e.height,ae=e.width,se=e.children,ce=oe||("number"==typeof ae?Math.floor(.5625*ae):"calc("+ae+" * 0.5625"),le=null==O?void 0:O.permissions,ue=(null==le?void 0:le.pin_participant)||(null==le?void 0:le.can_allow_participant_audio)||(null==le?void 0:le.can_allow_participant_video)||(null==le?void 0:le.kick_participant);return t.createElement(P,{"data-component":"PeerView",position:"relative",width:ae,maxHeight:"fit-content",className:"dyte-peerview"},B?t.createElement("div",{style:{position:"absolute",top:0,left:0,zIndex:10,width:"100%",height:"100%"}},B):null,h?t.createElement("div",{style:{position:"absolute",top:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",width:"100%",opacity:.8,background:"#000",zIndex:1,height:"100%",cursor:"pointer"},onClick:function(){return V(Ai(o.id))}},t.createElement(Xe,{color:C.text[300],size:32})):null,p>0&&ue?t.createElement(Ts,null,t.createElement(Os,{onInit:function(e){M.current=e}},$(te,ce,H,v,re)),t.createElement(W,null,le.pin_participant&&E!==$o.webinar&&(ne?t.createElement(Is,{onClick:function(){return k.pin(null)}},"Unpin"):t.createElement(Is,{onClick:function(){return k.pin(o.id)}},"Pin")),le.can_allow_participant_audio&&t.createElement(Is,{disabled:ee,onClick:function(){return k.disableAudio(o.id)}},"Mute Audio"),le.can_allow_participant_video&&t.createElement(Is,{disabled:!te,onClick:function(){return k.disableVideo(o.id)}},"Disable Video"),!o.isMe&&le.kick_participant&&t.createElement(Is,{onClick:function(){return k.kick(o.id)}},"Kick"),(null==D?void 0:D.length)>0&&t.createElement(Y,null),null==D?void 0:D.map((function(e){return t.createElement(Is,{onClick:function(){return e.onClick(o.id)}},e.label)})))):$(te,ce,H,v,re),t.createElement(L,{width:"100%",position:"absolute",top:"0em",padding:l||"sm"===m?"3px":"1em"},ie&&!s&&t.createElement(L,{width:l||"sm"===m?"100%":"auto",justifyContent:"flex-start",direction:"column",p:"1",zIndex:2},t.createElement($e,{size:32,color:C.text[300],style:{borderRadius:"50%",padding:"8px",backgroundColor:C.secondary[800]}})),ne&&!ie&&t.createElement(L,{width:l||"sm"===m?"100%":"auto",justifyContent:"flex-start",direction:"column",p:"1"},t.createElement(et,{size:32,color:C.text[300],style:{borderRadius:"50%",padding:"8px",transform:"rotate(45deg)",backgroundColor:C.secondary[800]}})),t.createElement(K,null),t.createElement(w,{isInline:!0,justify:"flex-end"})),t.createElement(L,{width:"100%",position:"absolute",bottom:"0em",zIndex:2,padding:l||"sm"===m||f?"0px":"0.6em 1.2em",alignItems:"flex-end"},s||f||t.createElement(L,{maxWidth:"100%",overflow:"hidden",width:"auto",justifyContent:"flex-start",direction:"column"},t.createElement(ks,{audioMuted:ee,audioTrack:o.audioTrack,name:re,size:l||"sm"===m?"sm":"md",screenshare:o.screenshare})),f&&t.createElement(L,{maxWidth:"100%",overflow:"hidden",width:"auto",justifyContent:"flex-start",direction:"column"},t.createElement(ks,{audioMuted:ee,audioTrack:o.audioTrack,name:re,size:l||"sm"===m||f?"sm":"md",screenshare:o.screenshare})),t.createElement(K,null),t.createElement(w,{isInline:!0,justify:"flex-end",spacing:"0.5em"},se)))}tc.defaultProps={isMobile:!1,hideBadge:!1,height:0,width:"100%",maxVideoHeight:"",children:t.createElement(t.Fragment,null),contain:!1,totalPeers:0,size:"md",isMe:!1,pipMode:!1};var nc={12:"1fr 1fr 1fr",9:"1fr 1fr 1fr",8:"1fr 1fr 1fr",7:"1fr 1fr 1fr",6:"1fr 1fr",5:"1fr 1fr",4:"1fr 1fr",3:"1fr 1fr",2:"1fr",1:"1fr"},ic={12:"1fr 1fr 1fr 1fr",9:"1fr 1fr 1fr",8:"1.4fr 0.7fr 0.7fr 1.4fr",7:"1.4fr 0.7fr 0.7fr 1.4fr",6:"1fr 1fr 1fr",5:"1.4fr 0.7fr 0.7fr 1.4fr",4:"1fr 1fr",3:"1fr 1fr",2:"1fr 1fr",1:"1fr"},rc={12:["1/2","1/2","1/2","1/2","2/3","2/3","2/3","2/3","3/4","3/4","3/4","3/4"],9:["1/2","1/2","1/2","2/3","2/3","2/3","3/4","3/4","3/4"],8:["1/2","1/2","2/3","2/3","2/3","3/4","3/4","3/4"],7:["1/2","1/2","2/3","2/3","3/4","3/4","3/4"],6:["1/2","1/2","1/2","2/3","2/3","2/3"],5:["1/2","1/2","2/3","2/3","2/3"],4:["1/2","1/2","2/3","2/3"],3:["1/3","1/2","2/3"],2:["1/2","1/2"],1:["1"]},oc={12:["1/2","2/3","3/4","4/5","1/2","2/3","3/4","4/5","1/2","2/3","3/4","4/5"],9:["1/2","2/3","3/4","1/2","2/3","3/4","1/2","2/3","3/4"],8:["1/3","3/5","1/2","2/4","4/5","1/2","2/4","4/5"],7:["1/3","3/5","1/3","3/5","1/2","2/4","4/5"],6:["1/2","2/3","3/4","1/2","2/3","3/4"],5:["1/3","3/5","1/2","2/4","4/5"],4:["1/2","2/3","1/2","2/3"],3:["1/2","2/3","2/3"],2:["1/2","2/3"],1:["1"]},ac={12:Array(12).fill(3),9:Array(9).fill(3),8:Array(9).fill(3),7:Array(9).fill(3),6:Array(6).fill(2),5:Array(5).fill(2),4:Array(4).fill(2),3:[1,2,2],2:[1,1],1:[1]},sc={12:Array(12).fill(4),9:Array(9).fill(3),8:Array(9).fill(3),7:Array(9).fill(3),6:Array(6).fill(3),5:Sn(Sn([],Array(2).fill(2),!0),Array(3).fill(3),!0),4:Array(4).fill(2),3:Array(3).fill(2),2:Array(2).fill(2),1:[1]},cc=function(e){var n,i,o,a=r(ua).sessionConfig,s=Hi(),c=d((function(e){return e.room.roomViewType})),l=d((function(e){return e.room.currentPage})),u=(null===(n=a.theme)||void 0===n?void 0:n.dimensions)||s,p=u.width,m=u.height,f=p>m,h=p<1024,g=uo()&&f,v=h&&f,y=e.peers,b=e.gridSize,E=e.waitingRoom,w=e.widthOffset,S=e.controlBarHeight;e.showAlone;var _=0;a.theme.header.is_enabled&&(_-=40),!a.theme.control_bar.is_enabled||E&&!a.theme.waiting_room.enable_preview||(_-=S),g?p+=_:(m+=_,p-=w);var k,C=1===b&&c!==Mi.webinar&&!h&&(null===(o=null===(i=a.theme)||void 0===i?void 0:i.alone_here)||void 0===o?void 0:o.is_enabled)&&!E,x=E&&(!h||!a.theme.waiting_room.enable_preview),T=(C&&0===l||x)&&1;7===(k=1===b&&0===l&&C?2:1===b?1:b)||8===k?k=9:k>9&&(k=12);var I=function(e,t){return Math.floor(m/e)-2*t*(e+1)/e},A=function(e){return h&&!v?{cols:nc[e],rows:ic[e]}:{cols:ic[e],rows:nc[e]}},O=function(e,t){return h&&!v?{col:rc[e][t],row:oc[e][t]}:{col:oc[e][t],row:rc[e][t]}},D=function(e,t){return I(h&&!v?sc[e][t]:ac[e][t],3)},N=O(k,0),R="rotate("+(g?90:0)+"deg)",M=Math.floor(m/2)+"px "+Math.floor(m/2)+"px";return t.createElement(Z,{height:m-(g?2:0),width:p,backgroundColor:"secondary.1000",px:h?"3px":"5px",gridTemplateColumns:A(k).cols,gridTemplateRows:A(k).rows,transform:R,transformOrigin:M},C&&0===l&&t.createElement(P,{gridColumn:N.col,gridRow:N.row,p:"5px"},t.createElement(Qa,{height:D(k,0)})),E&&t.createElement(P,{gridColumn:N.col,gridRow:N.row,p:"5px"},t.createElement(Xa,{height:D(k,0)})),!E||a.theme.waiting_room.enable_preview&&!h?y.map((function(e,n){var i,r=O(k,n+T);return t.createElement(P,{key:e.id+"_video",gridColumn:r.col,gridRow:r.row},t.createElement(tc,{height:D(k,n+T),peer:e,totalPeers:y.length,isMobile:h,contain:"contain"===(null===(i=a.theme.grid)||void 0===i?void 0:i.multi.videoFit)}))})):null)};cc.defaultProps={waitingRoom:!1,widthOffset:0,controlBarHeight:72,showAlone:!0};var lc=function(){function e(e,t,n,i,r,o){this.socketObj=e,this.dispatch=n,this.roomName=t,this.plugins={},this.iframes={},this.peerId=i,this.handleSockets=this.handleSockets.bind(this),this.authToken=r,this.meeting=o}return e.prototype.handleSockets=function(e){if(e)switch(e.type){case"websocket/enable-plugin":this.enablePlugin(e.payload);break;case"websocket/disable-plugin":this.disablePlugin(e.payload);break;case"websocket/plugin-event":case"websocket/plugin-data":this.sendIframeEvent(e);break;case"websocket/peer-joined":case"websocket/peer-closed":case"websocket/new-chat-message":this.broadcastIframeEvent(e)}},e.prototype.broadcastIframeEvent=function(e){Object.values(this.iframes).forEach((function(t){Object.values(t).forEach((function(t){t.iframe&&t.iframe.contentWindow.postMessage(e,t.iframe.src)}))}))},e.prototype.sendIframeEvent=function(e){var t=this.iframes[e.payload.pluginId||e.payload.id];t&&Object.values(t).forEach((function(t){t.iframe&&t.iframe.contentWindow.postMessage(e,"*")}))},e.prototype.listenSocketEvents=function(){return En(this,void 0,void 0,(function(){return wn(this,(function(e){return this.socketObj.emitter.on("socket",this.handleSockets),[2,this.getRoomPlugins()]}))}))},e.prototype.getRoomPlugins=function(){return En(this,void 0,void 0,(function(){var e,t,n=this;return wn(this,(function(i){switch(i.label){case 0:return[4,this.socketObj.sendMessage({type:"getRoomState"})];case 1:return e=i.sent(),t=e.payload.roomState.plugins,[4,Promise.all(t.map((function(e){return n.enablePlugin(e)})))];case 2:return i.sent(),[2]}}))}))},e.prototype.enablePlugin=function(e){return En(this,void 0,void 0,(function(){var t,n,i,r=this;return wn(this,(function(o){switch(o.label){case 0:return this.plugins[e.id]?[2]:[4,fetch(Nr.apiBase+"/v2/plugins/view/"+e.id,{method:"GET",headers:{authorization:"Bearer "+this.authToken,"dyte-tracing-id":this.peerId}})];case 1:return[4,o.sent().json()];case 2:return t=o.sent(),[4,fetch(Nr.apiBase+"/v2/plugins/authorize/"+e.id,{method:"POST",headers:{authorization:"Bearer "+this.authToken,"Content-Type":"application/json","dyte-tracing-id":this.peerId},body:JSON.stringify({roomName:this.roomName,peerId:this.peerId})})];case 3:return[4,o.sent().json()];case 4:return n=o.sent().data.token,i=yn(yn({},t.data.plugin),{authToken:n,enabledBy:e.enabledBy,ACLAccessGrantedUsers:e.ACLAccessGrantedUsers||[],ACLAccessRemovedUsers:e.ACLAccessRemovedUsers||[]}),this.plugins[e.id]=i,this.iframes[e.id]={},fetch(i.baseURL+"/dyte-config.json").then((function(e){return e.json()})).then((function(e){r.dispatch(zr({plugin:i,meeting:r.meeting,config:e,pluginService:r}))})).catch((function(e){r.dispatch(zr({plugin:i,meeting:r.meeting,config:null,pluginService:r}))})),[2]}}))}))},e.prototype.disablePlugin=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){return this.plugins[e.id]&&(delete this.plugins[e.id],this.dispatch(Lr(e)),this.meeting.plugins.find((function(t){return t.id===e.id})).emit("closed")),[2]}))}))},e.prototype.getEnabledByPeerId=function(e){var t,n;if(!e)return n;var i=this.plugins[e].enabledBy,r=eo.getState().peers.joinedPeers,o=eo.getState().participant;return o.id===i&&(n=o.peerId),n||(n=null===(t=r.find((function(e){return e.userId===i})))||void 0===t?void 0:t.id),n},e.prototype.handleIframeMessage=function(e){var t,n;return En(this,void 0,void 0,(function(){var i,r,o,a,s=this;return wn(this,(function(c){switch(e.type){case"pluginEvent":case"storePluginData":case"getPluginData":case"enablePluginForAll":case"enablePluginForUser":case"disablePluginForUser":case"chatMessage":this.socketObj.sendMessage(e,(function(e){s.sendIframeEvent(e)}));break;case"getJoinedPeers":this.sendIframeEvent({type:"websocket/get-joined-peers",payload:yn(yn({},e.payload),{peers:eo.getState().peers.joinedPeers})});break;case"getPeerInfo":i={type:e.type,payload:yn(yn({},e.payload),{peerId:null!==(n=null===(t=e.payload)||void 0===t?void 0:t.peerId)&&void 0!==n?n:this.peerId})},this.socketObj.sendMessage(i,(function(e){s.sendIframeEvent(e)}));break;case"getRoomState":r=this.getEnabledByPeerId(e.payload.pluginId),this.socketObj.sendMessage(e,(function(t){s.sendIframeEvent({type:"websocket/get-room-state",payload:yn(yn({},e.payload),{roomName:s.roomName,pluginInitiatorPeerId:r,peers:t.payload.roomState.peers,displayTitle:t.payload.roomState.displayTitle,roomUUID:t.payload.roomState.roomUUID,currentPeer:s.peerId})})}));break;case"getPluginInitiatorId":o=this.getEnabledByPeerId(e.payload.pluginId),this.sendIframeEvent({type:"websocket/get-plugin-initiator-peer-id",payload:yn(yn({},e.payload),{pluginInitiatorPeerId:o})});break;case"getPluginInitiatorUserId":a=this.plugins[e.payload.pluginId].enabledBy,this.sendIframeEvent({type:"websocket/get-plugin-initiator-user-id",payload:yn(yn({},e.payload),{pluginInitiatorUserId:a})});break;case"pluginEventToParent":this.meeting.plugins.find((function(t){return t.id===e.payload.id})).emit(e.payload.eventName,e.payload.data);break;case"toggleViewMode":this.meeting.plugins.find((function(t){return t.id===e.payload.id})).emit("toggleViewMode",e.payload.data)}return[2]}))}))},e.prototype.addIframeView=function(e,t){return En(this,void 0,void 0,(function(){var n,i=this;return wn(this,(function(r){return this.iframes[e.plugin][e.view]&&this.removeIframeView(e),n=function(e){t&&e.source===t.contentWindow&&i.handleIframeMessage(e.data)},window.addEventListener("message",n),this.iframes[e.plugin][e.view]={listener:n,iframe:t},[2]}))}))},e.prototype.removeIframeView=function(e){return En(this,void 0,void 0,(function(){var t;return wn(this,(function(n){return(t=this.iframes[e.plugin][e.view])&&(window.removeEventListener("message",t.listener),delete this.iframes[e.plugin][e.view]),[2]}))}))},e.prototype.addRoomPlugin=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return this.plugins[e.id]?[2]:[4,this.socketObj.sendMessage({type:"addPlugin",payload:e})];case 1:return t.sent(),this.meeting.plugins.find((function(t){return t.id===e.id})).emit("opened"),[2]}}))}))},e.prototype.removeRoomPlugin=function(e){return En(this,void 0,void 0,(function(){return wn(this,(function(t){return[2,this.socketObj.sendMessage({type:"removePlugin",payload:e})]}))}))},e}(),uc=function(e){function t(t,n){var i=e.call(this)||this;return i.isActivated=!!n.plugins[t.id],i.data=[],i.manager=n,i.plugin=t,i}return gn(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.plugin.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.plugin.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ACLType",{get:function(){return this.plugin.ACLType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"staggered",{get:function(){return this.plugin.staggered},enumerable:!1,configurable:!0}),t.prototype.activate=function(){this.manager.addRoomPlugin(this.plugin)},t.prototype.deactivate=function(){this.manager.removeRoomPlugin(this.plugin)},t.prototype.sendData=function(e){this.manager.sendIframeEvent({type:"websocket/plugin-internal-data",payload:{pluginId:this.id,data:e}})},t}(Yt),dc=o(null),pc=function(e){var o=e.children,a=e.roomName,s=e.peerId,l=r(Rs),p=d((function(e){return e.participant.authToken})),m=u(),f=n(null),h=f[0],g=f[1],v=n([]),y=v[0],b=v[1],E=r(ua),w=E.sessionConfig,S=E.meeting,_=d((function(e){return e.room.socketState})),k=function(e,t){0===S.plugins.length&&e.forEach((function(e){var n=e;n.ACLType=function(e){var t;return(null===(t=w.permissions.plugins.config[e])||void 0===t?void 0:t.defaultAccess)||"blacklist"}(n.id);var i=new uc(n,t);S.plugins.push(i)})),b(e),m(Fr({initialized:!0}))},C={pluginManager:h,plugins:y},x=c((function(e){return En(void 0,void 0,void 0,(function(){var t,n,i,r;return wn(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,fetch(Nr.apiBase+"/v2/plugins/user",{headers:{Authorization:"Bearer "+p,"dyte-tracing-id":s}})];case 1:return[4,o.sent().json()];case 2:return(t=(t=o.sent().data.plugins).filter((function(e){return!e.name.includes("v2")}))).push(Mr),n=t,(null==(i=w.theme.plugins)?void 0:i.length)>0?k(n.filter((function(e){return i.includes(e.id)})),e):k(n,e),[3,4];case 3:return r=o.sent(),la.error("plugin_request_failed",r),k([],e),[3,4];case 4:return[2]}}))}))}),[_]);return i((function(){En(void 0,void 0,void 0,(function(){var e;return wn(this,(function(t){switch(t.label){case 0:return _!==Cn.CONNECTED?[3,2]:(e=new lc(l,a,m,s,p,S),g(e),[4,e.listenSocketEvents()]);case 1:t.sent(),x(e),t.label=2;case 2:return[2]}}))}))}),[_]),t.createElement(dc.Provider,{value:C},o)};function mc(e){var i;u();var o=d((function(e){return e.peers.joinedPeers}));d((function(e){return e.participant.id}));var a=e.plugin,s=e.onClose,c=n(""),l=c[0],p=c[1],m=r(ua).sessionConfig,f=r(Ks).mediaRoom,h=ln().t,g="whitelist"===((null===(i=m.permissions.plugins.config[a.id])||void 0===i?void 0:i.defaultAccess)||"blacklist"),v=function(e){return e!==(null==a?void 0:a.enabledBy)&&(g?!a.ACLAccessGrantedUsers.includes(e):a.ACLAccessRemovedUsers.includes(e))},y=function(e){return e===(null==a?void 0:a.enabledBy)||(g?a.ACLAccessGrantedUsers.includes(e):!a.ACLAccessRemovedUsers.includes(e))};return t.createElement(Cs,{isOpen:!0,onClose:s},t.createElement(Q,null,t.createElement(w,{spacing:6,height:"80"},t.createElement(j,{mt:"4"},t.createElement(_,{fontSize:"lg",fontWeight:"bold"},"Control"," ",a.name," ","Access")),t.createElement(B,{marginY:4},t.createElement(X,null,t.createElement(U,{boxSize:6,as:tt,fill:"text.400","aria-label":"Search"})),t.createElement(F,{color:"text.100",backgroundColor:"secondary.800",border:"none",borderRadius:"0.25em",focusBorderColor:"none",errorBorderColor:"none",size:"md",fontSize:"1em",placeholder:"Search",value:l,onChange:function(e){return p(e.target.value)}})),t.createElement(P,{display:"flex",flexDirection:"column",overflowY:"scroll",className:"dyte-modal-content-container"},o.filter((function(e){return""===l||e.displayName.toLowerCase().includes(l.toLowerCase())})).map((function(e){return t.createElement(L,{direction:"row",alignItems:"center",pb:2},t.createElement(Xs,{size:"sm",name:e.displayName}),t.createElement(L,{marginLeft:3,flexGrow:1,alignItems:"center",paddingY:2,borderBottom:"1px solid",borderColor:"secondary.800"},t.createElement(_,{color:"text.200",fontSize:"lg"},e.displayName.substring(0,10),".."),t.createElement(L,{marginLeft:"auto"},t.createElement(C,null,t.createElement(k,{padding:"6px",bg:v(e.userId)?"primary.300":"secondary.800",onClick:function(){return t=e.userId,void(y(t)&&f.removePluginAccess(a.id,t));var t}},t.createElement(nt,{size:"14px"})," ",t.createElement(_,{fontSize:"12px",ml:"4px"},h("View Only"))),t.createElement(k,{padding:"6px",bg:y(e.userId)?"primary.300":"secondary.800",onClick:function(){return t=e.userId,void(v(t)&&f.grantPluginAccess(a.id,t));var t}},t.createElement(it,{size:"14px"})," ",t.createElement(_,{fontSize:"12px",ml:"4px"},h("Full Control")))))))}))))))}var fc=function(){return t.createElement(L,{alignItems:"center",justifyContent:"center",height:"100%",width:"100%"},t.createElement($,{in:!0},t.createElement(S,null)))},hc=function(e){var o,s=e.frame,c=e.height,l=e.width,u=r(dc),p=a(null),m=d((function(e){return e.participant.id})),f=d((function(e){return e.plugin.plugins})).find((function(e){return e.id===s.plugin})),h=r(ua).sessionConfig,g=n(!1),v=g[0],y=g[1],b=n(!0),E=b[0],w=b[1],S=h.permissions.plugins||{can_close:!1,can_start:!0,can_edit_acl:!1},_=m===(null==f?void 0:f.enabledBy)||(null==S?void 0:S.can_close),x=m===(null==f?void 0:f.enabledBy)||(null==S?void 0:S.can_edit_acl),T="whitelist"===((null===(o=h.permissions.plugins.config[f.id])||void 0===o?void 0:o.defaultAccess)||"blacklist"),I=function(){var e;return m===(null==f?void 0:f.enabledBy)||(T?null===(e=null==f?void 0:f.ACLAccessGrantedUsers)||void 0===e?void 0:e.includes(m):!f.ACLAccessRemovedUsers.includes(m))},A=function(){var e,t=null===(e=h.permissions.plugins.config[f.id])||void 0===e?void 0:e.handlesViewOnly,n=!I()&&!t;return t&&u.pluginManager.sendIframeEvent({type:"websocket/plugin-data",payload:{pluginId:f.id,type:"setViewOnly",value:!I()}}),n};i((function(){var e;A(),null===(e=p.current)||void 0===e||e.focus()}),[null==f?void 0:f.ACLAccessGrantedUsers,p]),i((function(){var e=u.pluginManager.meeting.plugins.find((function(e){return e.id===f.id}));w(A()),null==e||e.on("toggleViewMode",(function(e){w(e)}))}),[]);var O=n(!0),D=O[0],N=O[1];return t.createElement(P,{height:c,width:l,alignItems:"center"},t.createElement(L,{height:"100%",width:"100%",direction:"column"},t.createElement(C,{height:"35px",width:"100%",bgColor:"secondary.900",justify:"space-between",paddingX:"10px",borderTopLeftRadius:"6px",borderTopRightRadius:"6px"},!I()&&t.createElement(C,{"aria-label":"view-only",marginRight:"8px",size:"8px",mt:"2px",fontSize:"14px",padding:"2px",paddingLeft:"6px",paddingRight:"6px",bg:"secondary.600",borderRadius:"4px",border:"1px solid var(--chakra-colors-primary-300)"},t.createElement(P,{fontSize:"12px",color:"primary.300",fontWeight:"bold"},"View Only"),t.createElement(rt,{size:"14px",color:"var(--chakra-colors-primary-300)"})),x&&t.createElement(k,{onClick:function(){return y(!0)},"aria-label":"edit-access",marginRight:"8px",size:"8px",mt:"2px",fontSize:"14px",padding:"2px",paddingLeft:"6px",paddingRight:"6px",bg:"secondary.1000"},t.createElement(P,{marginRight:"4px"},"CONTROL"),t.createElement(ot,{size:"14px"})),_&&t.createElement(W,{onClick:function(){u.pluginManager.removeRoomPlugin({id:s.plugin})},"aria-label":"close",isRound:!0,mt:"2px",padding:"3px",size:"14px",icon:t.createElement(at,{size:"14px"})})),t.createElement(L,{grow:1,height:"100%",bgColor:"white",borderBottomRadius:"8px",overflow:"hidden"},D&&t.createElement(fc,null),v&&t.createElement(mc,{plugin:f,onClose:function(){return y(!1)}}),t.createElement(P,{display:D?"none":"block",width:l,height:"100%",position:"relative",borderBottomRadius:"6px"},A()&&E&&t.createElement(P,{tabIndex:0,ref:p,style:{zIndex:10,position:"absolute"},height:"100%",width:"100%"}),t.createElement("iframe",{className:"dyte-iframe",height:"100%",width:"100%",style:{maxWidth:"100%",borderBottomRightRadius:"6px",overflowY:"scroll",borderBottomLeftRadius:"6px"},title:s.view,src:s.url,onLoad:function(){return N(!1)},ref:function(e){u.pluginManager.addIframeView(s,e)},allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})))))},gc=function(e){var i=e.activeVideoHeightDesktop;e.remainingWidthDesktop;var o=e.activePeer,a=n(!0),s=a[0],c=a[1],l=r(Ka).mediaTracks.setScreenShareTracks,u=r(Ks).mediaRoom;return t.createElement(P,{position:"relative",p:"2em",height:i,maxWidth:"100%",flexGrow:1,justifyContent:"center",alignItems:"center",backgroundColor:"secondary.900",display:"flex",className:"dyte-client-screen-preview",borderRadius:6},t.createElement(L,{w:"90%",justify:"center"},s&&t.createElement(P,{height:!s&&0,w:s?"50%":0,opacity:!s&&0,overflow:"hidden"},t.createElement(P,{maxW:"350px",overflow:"hidden"},t.createElement(ee,{color:"text.200"},"Your screen is now being shared"),t.createElement(_,{mt:10,color:"text.300",fontWeight:"normal"},"The screen preview has been minimized for you. You can expand to preview it."))),t.createElement(te,{spacing:6},t.createElement(tc,{contain:!0,height:s?162:i-100,width:s?288:"auto",peer:o,hideBadge:!0}),t.createElement(C,{spacing:6},t.createElement(k,{px:6,variant:"secondaryDefault",leftIcon:t.createElement(U,{as:s?st:ct,fill:"text.100",boxSize:"5"}),iconSpacing:"0.5em",onClick:function(){return c(!s)}},s?"Expand Preview":"Minimize Preview"),t.createElement(k,{px:6,variant:"danger",leftIcon:t.createElement(U,{as:lt,fill:"text.100",boxSize:"5"}),iconSpacing:"0.5em",onClick:function(){return En(void 0,void 0,void 0,(function(){return wn(this,(function(e){return u.disableScreenShare(),l(void 0),[2]}))}))}},"Stop Sharing")))))},vc=function(e){var r=a(null),o=n(!1),s=o[0],c=o[1],l=e.children,u=e.height,p=e.width,m=e.onFullScreen,f=e.onFullScreenEnd,h=e.isMobile,g=d((function(e){return e.participant.sharingScreen}));e.maxVideoHeight;var v=bn(e,["maxVideoHeight"]),y=function(e){document.webkitCurrentFullScreenElement||(f&&f(),c(!1))},b=function(e){document.fullscreenElement||(f&&f(),c(!1))};i((function(){return bo()?(window.addEventListener("webkitfullscreenchange",y),function(){return window.removeEventListener("webkitfullscreenchange",y)}):(window.addEventListener("fullscreenchange",b),function(){return window.removeEventListener("fullscreenchange",b)})}),[s]);var E=s?"100vh":u-12;h&&(E=s?"100vh":Math.min(.5625*p,u));var w=s?"100vw":p;return t.createElement(P,{position:"relative",maxWidth:"100%",ref:r,background:"secondary.900",borderRadius:6,height:"fit-content"},!g&&t.createElement(ne,{label:"Fullscreen","aria-label":"FullScreen",portalProps:{containerRef:{current:document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")}}},t.createElement(U,{zIndex:2,position:"absolute",top:"0",right:"0",cursor:"pointer",onClick:function(){if(s)f&&f(),document.exitFullscreen?document.exitFullscreen():document.mozExitFullScreen?document.mozExitFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),c(!1);else{if(m&&m(),!r.current)return;r.current.requestFullscreen?r.current.requestFullscreen():r.current.mozRequestFullScreen?r.current.mozRequestFullScreen():r.current.webkitRequestFullscreen?r.current.webkitRequestFullscreen():r.current.msRequestFullscreen&&r.current.msRequestFullscreen(),c(!0)}},as:s?ct:Xe,boxSize:"8",margin:"3",borderRadius:"4",padding:"1",background:"secondary.700",fill:s?"var(--chakra-colors-danger-500)":"white"})),t.createElement(tc,yn({},s?v:e,{width:w,height:E,isSideView:!0}),l))},yc=function(e){var o,s,c,l=e.widthOffset,u=e.sharingScreen,p=e.peers,m=e.controlBarHeight,f=r(ua).sessionConfig,h=r(Ws),g=h.screenSharePeers,v=h.selfPeer,y=Hi(),b=(null===(o=f.theme)||void 0===o?void 0:o.dimensions)||y,E=b.width,w=b.height,S=d((function(e){return e.room.activeSpeakerPeerId})),_=d((function(e){return e.room.maxPreferredStreams})),k=d((function(e){return e.room.selectedScreenSharingPeer})),C=a(!1),x=E<1024||C.current,T=E>w,I=uo()&&T;uo();var A=n(_),O=A[0],D=A[1],N=0;f.theme.header.is_enabled&&(N-=40),f.theme.control_bar.is_enabled&&(N-=m),I?E+=N:(w+=N,E-=l);var R=w-8,M=d((function(e){return e.plugin}));i((function(){D(w>400?_:w>200?_/2:_/2-1)}),[w]);var z,j,B,F=[],V=[];p.forEach((function(e){e.id===S&&(j=e),e.isScreensharing?F.unshift(e):e.isPinned?(z=e,F.unshift(e)):F.push(e)})),g.length>0&&(""!==k&&g.find((function(e){return e.id===k}))||(k=null===(s=g[0])||void 0===s?void 0:s.id),B=g.find((function(e){return e.id===k})),V=g.filter((function(e){return e.id!==k})));var W=B||z||j,U=!!W;W||(W=F[F.length-1]);var q,H=M.main.length>0?1:0,G=B?1:0,J=O-1+G+H,Y=Math.min(250,(w-4*(J-1))/J*1.65),K=E-Y-16,Z=function(e,t,n){var i=1,r=!1;n<3&&(n=3),n>6||n>4&&e>480?(i=Math.ceil(n/4),n=4):n>3&&e<=480&&(i=2,n=3);var o=Math.floor(e/n);return t-i*o<.65*t&&(o=.35*t/i,i=Math.ceil(o*n/e)),o<140&&(r=!0),{mainViewHeightOffset:i*o,videoSizeMobile:o-12,hideBadge:r}}(E,w,p.length+V.length+G+H),Q=Z.mainViewHeightOffset,X=Z.videoSizeMobile,$=Z.hideBadge;if(M.main.length>0){var ee=M.main[0];q=t.createElement(hc,{height:w-16-(x?Q:0),width:"100%",frame:ee})}else q=I?t.createElement(vc,{height:w-16,width:E-32,isMobile:!0,contain:W.screenshare||"contain"===f.theme.grid.single.videoFit,peer:W,totalPeers:F.length,size:"sm"}):x?t.createElement(vc,{contain:!0,width:E-20,isMobile:!0,height:w-Q-8,totalPeers:F.length,peer:W,size:"sm",onFullScreen:function(){C.current=!0},onFullScreenEnd:function(){C.current=!1}}):t.createElement(vc,{totalPeers:F.length,contain:W.screenshare||"contain"===(null===(c=f.theme)||void 0===c?void 0:c.grid.single.videoFit),height:R,width:K-64,peer:W});var te="rotate("+(I?90:0)+"deg)",ne=Math.floor(w/2)+"px "+Math.floor(w/2)+"px",ie={height:w,width:E,flexDirection:"column",backgroundColor:"secondary.1000",transform:te,transformOrigin:ne,alignItems:"center",px:4},re={height:R,p:5,flex:1};return t.createElement(L,yn({},x?ie:{backgroundColor:"secondary.1000",className:"dyte-client-noSelect",flexDir:"row",flexWrap:"wrap",pt:2.5,px:5},{justifyContent:"center"}),t.createElement(L,yn({alignItems:"center"},x?{borderRadius:6,flexGrow:1,minWidth:"100%",justifyContent:"center"}:re),!x&&u&&(null==B?void 0:B.id)===v.id?t.createElement(gc,{activeVideoHeightDesktop:R,remainingWidthDesktop:K,activePeer:W}):q),x&&!I&&t.createElement(L,{mt:0,className:"dyte-client-noScrollbar",justifyContent:"center",flexWrap:"wrap",minHeight:"fit-content",width:"100%"},(w>500||uo())&&F.map((function(e){return U&&e.id===W.id?null:t.createElement(P,{key:e.id+"_video",py:1},t.createElement(tc,{width:X,height:X,peer:e,isMobile:x,totalPeers:F.length,size:"sm",hideBadge:$}))})),V.map((function(e){return t.createElement(P,{key:e.id+"_video_screen",py:1},t.createElement(tc,{width:X,height:X,peer:e,isMobile:x,totalPeers:F.length,size:"sm",hideBadge:$,isInactiveScreenShare:!0}))}))),x&&(I?F.map((function(e){var n=yn({},e);return n.videoVisible=!1,n.videoTrack=null,t.createElement(P,{key:e.id+"_video",position:"absolute",zIndex:-5,top:0,visibility:"hidden"},t.createElement(tc,{width:1,height:1,peer:n,totalPeers:F.length}))})):null),!x&&t.createElement(P,{justifyContent:"flex-end",height:R},t.createElement(P,{display:"flex",flexDirection:"column",overflowY:"scroll",overflowX:"hidden",width:Y,alignItems:"flex-start",justifyContent:"flex-start",height:R},F.map((function(e){return W.screenshare||0!==M.main.length||e.id!==W.id?t.createElement(P,{key:e.id+"_video",mb:"9px"},t.createElement(tc,{width:w<400?Y-12:Y,peer:e,size:"sm",totalPeers:F.length,isSideView:!0})):null})),V.map((function(e){return t.createElement(P,{key:e.id+"_video_screen"},t.createElement(tc,{width:Y,peer:e,size:"sm",totalPeers:F.length,isSideView:!0,isInactiveScreenShare:!0}))})))))},bc=function(e,n){var i=!e.permissions.can_present;return t.createElement(te,null,i&&t.createElement(_,{fontSize:"lg",py:"1em"},"Host will start presenting soon.",t.createElement("br",null),t.createElement("br",null),t.createElement(S,{color:"text.100",size:"lg"})),!i&&t.createElement(_,{fontSize:"lg",py:"1em"},"You are the host"),t.createElement(K,null),i&&("a446c4de-979e-4d4f-97f7-2b695e75ef90"===n.connectionConfig.clientId?t.createElement(_,{fontSize:"md",fontWeight:"300"},"Please wait for the host to go live"):t.createElement(_,{fontSize:"md",fontWeight:"300"},"Your video & audio is turned off as a viewer. You can request to",t.createElement("br",null),"ask a question or present using the",t.createElement("b",null," REQUEST "),"button below.")),!i&&("a446c4de-979e-4d4f-97f7-2b695e75ef90"===n.connectionConfig.clientId?t.createElement(_,{fontSize:"md",fontWeight:"300"},"Please click on the Go Live button below to start the session."):t.createElement(_,{fontSize:"md",fontWeight:"300"},"To begin the webinar please start presenting or accept a request",t.createElement("br",null),"to present from the participants tab.")))},Ec=function(e,t){for(var n=[],i=0;i<t.length;i+=1){var r=t[i];e.has(r)&&n.push(e.get(r))}return n},wc=function(e){var n,o,s=e.widthOffset,c=e.singleSpeakerView,l=d((function(e){return e.room.roomViewType})),u=d((function(e){return e.room.gridView})),p=d((function(e){return e.plugin})),m=d((function(e){return e.participant.hidden})),f=d((function(e){return e.participant.webinarHiddenParticipant}))&&l===Mi.webinar,h=d((function(e){return e.participant.sharingScreen})),g=a([]),v=d((function(e){return e.room.maxPreferredStreams})),y=d((function(e){return e.room.socketState})),b=d((function(e){return e.room.currentPage})),E=d((function(e){return e.peers.currentPagePeerIds})),w=d((function(e){return e.peers.activeSpeakerPagePeerIds})),S=r(ua),_=S.meeting,k=S.sessionConfig,C=r(Ws),x=Hi(),T=(null===(n=k.theme)||void 0===n?void 0:n.dimensions)||x,I=T.width;T.height;var P=C.processedPeers,A=C.screenshareVideoConsumers,O=C.joinedProcessedPeers,D=C.selfPeer,N=E;i((function(){y===Cn.NOT_STARTED&&(null==_||_.emit(_.Events.disconnect))}),[y]);var R=0,M=[],z=new Map;P.forEach((function(e){z.set(e.id,e)}));var L=I<480?42:72;if(N.length>0&&b>0?(z.set(D.id,D),M=Ec(z,N),g.current=M.map((function(e){return e.id}))):(M=Ec(z,w),g.current=M.map((function(e){return e.id})),M=M.concat(m||k.permissions.is_recorder||f||!f&&l===Mi.webinar&&D.requestToJoinType===qi.ask?[]:[D])),!D)return t.createElement(Eo,null);if(y===Cn.NOT_STARTED)return t.createElement(Eo,{inStage:!0,text:"You got disconnected! Retrying connection..."});if((null===(o=D.flags)||void 0===o?void 0:o.recorder)&&M.length<1&&O.length>=1)return t.createElement(Eo,{loading:!1,text:"Waiting for host to join the stage",inStage:!0});if(M.length<1)return t.createElement(Eo,{loading:!(l===Mi.webinar),text:l===Mi.webinar?bc(k,_):"Waiting for users to join the meeting",inStage:!0});if(A.length>0||c||h||"highlighted"===u||p.main.length>0)return t.createElement(yc,{peers:M,sharingScreen:h,widthOffset:s,controlBarHeight:L});if(l===Mi.webinar){var j=m||k.permissions.is_recorder||f||!f&&l===Mi.webinar&&D.requestToJoinType===qi.ask?P.length:P.length+1;R=j>=v?v:j}else R=M.filter((function(e){return!e.hiddenParticipant})).length;return t.createElement(cc,{peers:M,widthOffset:s,gridSize:R,showAlone:l!==Mi.webinar,controlBarHeight:L})};wc.defaultProps={singleSpeakerView:!1};var Sc=t.memo(wc),_c=function(e){return Math.trunc(e).toString().padStart(2,"0")},kc=function(){var e=d((function(e){return e.room.startedAt})),n=t.useRef(),r=t.useState(0),o=r[0],a=r[1],s=t.useRef();return i((function(){if(e){var t=function(){a((Date.now()-new Date(e).getTime())/1e3),s.current=setTimeout((function(){n.current&&(n.current=requestAnimationFrame(t))}),500)};n.current=requestAnimationFrame(t)}return function(){clearTimeout(s.current),cancelAnimationFrame(n.current)}}),[e]),t.createElement(L,{color:"text.200",display:"flex",fontWeight:"medium"},t.createElement(j,null,o>=3600&&t.createElement(t.Fragment,null,_c(o/3600),":"),_c(o%3600/60),":",_c(o%60)))};var Cc,xc,Tc,Ic,Pc=t.memo((function(e){var n=r(en).logo;return t.createElement(P,null,t.createElement(ie,yn({src:n},e)))}));function Ac(){var e=n(""),o=e[0],s=e[1],c=r(Ws).joinedProcessedPeers,l=d((function(e){return e.room.chatMessages})),u=d((function(e){return e.participant.id})),p=a([]),m=l.filter((function(e){return!0!==e.read&&e.type===Tc.poll&&e.userId!==u})),f=function(e){var t=new Audio(e);t.volume=.2;var n=t.play();null==n||n.catch((function(e){return la.warn("notif_play_failed",e)}))};return i((function(){if(c.length>p.current.length&&p.current.length>0){var e=c.find((function(e){var t=e.id;return!p.current.includes(t)}));e&&e.displayName&&c.length<10&&(f("https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_join.mp3"),s((t=e.displayName,n=10,(t.length>n?t.substring(0,n)+"...":t)+" joined the meeting")))}var t,n;p.current=c.map((function(e){return e.id}))}),[c.length]),i((function(){var e=setTimeout((function(){""!==o&&s("")}),4e3);return function(){return clearTimeout(e)}}),[o]),i((function(){if(m.length>0){var e=m[m.length-1];s("New poll by "+e.displayName),f("https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_message.mp3")}}),[m.length]),o?t.createElement(un.div,{style:{overflow:"hidden"},variants:{collapsed:function(){return{width:0}},expanded:function(){return{width:"18em"}}},initial:""!==o?"collapsed":"expanded",animate:""!==o?"expanded":"collapsed",transition:{duration:.6}},t.createElement(L,{paddingLeft:2,paddingRight:2,height:"100%",borderRadius:4,alignItems:"center",justifyContent:"flex-end",zIndex:2,bg:"transparent"},t.createElement(C,null,t.createElement(U,{as:ut,boxSize:5,fill:"primary.300"}),t.createElement(_,{fontWeight:"400",color:"primary.300",whiteSpace:"nowrap"},o)))):t.createElement(t.Fragment,null)}!function(e){e[e.NO_VIDEO=0]="NO_VIDEO",e[e.NO_MIC=1]="NO_MIC"}(Cc||(Cc={})),function(e){e[e.NOT_ALLOWED=0]="NOT_ALLOWED",e[e.REQUEST_FIRST=1]="REQUEST_FIRST",e[e.ALLOWED=2]="ALLOWED"}(xc||(xc={})),function(e){e[e.text=0]="text",e[e.image=1]="image",e[e.file=2]="file",e[e.poll=3]="poll"}(Tc||(Tc={})),function(e){e.webinar="webinar",e.groupCall="group_call",e.audioRoom="audio_room"}(Ic||(Ic={}));var Oc=function(e){e.isMobile;var o=u(),s=r(Ks).mediaRoom,c=d((function(e){return e.peers.joinedPeers})),l=d((function(e){return e.room.maxPreferredStreams})),p=d((function(e){return e.room.currentPage})),m=d((function(e){return e.peers.currentPagePeerIds}));d((function(e){return e.peers.activeSpeakerPagePeerIds}));var f=c.length>=l||0!==p,h=d((function(e){return e.room.roomViewType})),g=n("count"),v=g[0],y=g[1],b=a(p),E=a(c.length),w=r(Ws).joinedProcessedPeers;w=w.filter((function(e,t,n){return n.findIndex((function(t){return t.id===e.id}))===t}));var S=c.length+1,k=Math.ceil(S/l),C=d((function(e){return e.participant.preset})),x=function(e){o(Ci(e)),s.getPage(e)};i((function(){C&&x(0)}),[C]),i((function(){if(0!==p){if(E.current<c.length){var e=p*l>=c.length+1,t=m.length===l;e&&!t&&x(p)}if(E.current>c.length){var n=l*(p-1);0===n?x(0):c.length<n&&x(2===p?0:p-1)}}E.current=c.length}),[c]),i((function(){1===p&&0===b.current&&y("autoOff"),0===p&&y("autoOn"),setTimeout((function(){y("count")}),1e3),b.current=p}),[p]);var T=function(e){void 0===e&&(e=!0),e?0===p&&y("autoOn"):y("count")};if(h===Mi.webinar)return t.createElement(j,{minW:"5em"},t.createElement(_,{fontWeight:"600",fontSize:"md",mr:1},w.length+1),t.createElement(U,{as:ot,fill:"text.200",boxSize:"5",verticalAlign:"middle"}));var I;return t.createElement(t.Fragment,null,f&&t.createElement(W,{bg:"secondary.700",borderRadius:"4px",variant:"controls",disabled:0===p,id:"dyte-btn-pagination-prev",icon:t.createElement(U,{as:dt}),onClick:function(){return x(p-1)},"aria-label":"pagination-left",py:"5px !important"}),t.createElement(j,{minW:"6.25em",h:"100%",onMouseEnter:function(){return T(!0)},onMouseLeave:function(){return T(!1)}},"autoOff"===(I=v)?t.createElement(_,{fontSize:"sm"},"Auto Layout Off"):"autoOn"===I?t.createElement(_,{fontSize:"sm"},"Auto Layout On"):t.createElement(t.Fragment,null,0===p?t.createElement(U,{as:mt,fill:"primary.500",boxSize:"5",verticalAlign:"middle"}):t.createElement(_,{fontWeight:"600",mr:1},(p-1)*l+1,"-",Math.min(p*l,S)," / "),t.createElement(_,{fontWeight:"600",fontSize:"md",mr:1},S," "),t.createElement(U,{as:ot,fill:"text.200",boxSize:"5",verticalAlign:"middle"}))),f&&t.createElement(W,{bg:"secondary.700",id:"dyte-btn-pagination-next",borderRadius:"4px",_hover:{bg:"secondary.1000"},variant:"controls",h:"1em",w:"1em",disabled:p===k,onClick:function(){return x(p+1)},icon:t.createElement(U,{as:pt}),"aria-label":"pagination-right",py:"5px !important"}))},Dc=e.forwardRef((function(t,n){return e.createElement(Ut,yn({iconAttrs:{fill:"currentColor"},iconVerticalAlign:"middle",iconViewBox:"0 0 20 20"},t,{ref:n}),e.createElement("path",{d:"M5.453 4.167a.726.726 0 00-1.027-.01A8.225 8.225 0 002 10a8.228 8.228 0 002.604 6.015.725.725 0 001.01-.025c.316-.316.277-.819-.027-1.11A6.73 6.73 0 013.5 10c0-1.846.741-3.52 1.943-4.738.29-.295.32-.785.01-1.095z",fill:"#FF414D"}),e.createElement("path",{d:"M7.214 5.93a.714.714 0 00-1.008-.017A5.733 5.733 0 004.5 10a5.73 5.73 0 001.893 4.264.713.713 0 00.983-.037c.328-.328.267-.844-.041-1.134A4.237 4.237 0 016 10c0-1.15.457-2.194 1.2-2.96.286-.294.333-.793.014-1.11zM12.788 5.93a.714.714 0 011.008-.017A5.734 5.734 0 0115.502 10a5.73 5.73 0 01-1.893 4.264.713.713 0 01-.983-.037c-.328-.328-.267-.844.04-1.134A4.237 4.237 0 0014.003 10c0-1.15-.457-2.194-1.2-2.96-.286-.294-.333-.793-.014-1.11z",fill:"#FF414D"}),e.createElement("path",{d:"M14.549 4.167a.726.726 0 011.027-.01A8.225 8.225 0 0118 10a8.226 8.226 0 01-2.604 6.015.725.725 0 01-1.01-.025c-.316-.316-.277-.819.028-1.11A6.73 6.73 0 0016.503 10c0-1.846-.741-3.52-1.943-4.738-.29-.295-.32-.785-.01-1.095zM10 8.5a1.5 1.5 0 100 3 1.5 1.5 0 000-3z",fill:"#FF414D"}))}));Dc.displayName="OnStageIcon";var Nc=t.memo((function(e){var n,o,s,c,l,p,m,f,h=e.isMobile,g=e.title;e.copyLink,e.linkCopied;var v=d((function(e){return e.room.waitingState})),y=d((function(e){return e.room.roomViewType})),b=d((function(e){return e.peers.recordingPeer})),E=d((function(e){return e.room.pipMode})),S=u(),C=d((function(e){return e.participant.webinarHiddenParticipant}))&&y===Mi.webinar,x=a(!1),T=r(ua),I=T.meeting,A=T.sessionConfig,O=d((function(e){return e.plugin.titlebar})),D=r(dc);return i((function(){b?x.current=!0:x.current&&(x.current=!1)}),[b]),t.createElement(L,{height:"40px",bg:"secondary.1000",className:"dyte-client-noSelect",px:4,py:1},t.createElement(w,{isInline:!0,spacing:5,alignItems:"center"},(null===(n=A.theme.header.elements)||void 0===n?void 0:n.logo)&&t.createElement(Pc,{h:"7"}),!h&&(null===(o=A.theme.header.elements)||void 0===o?void 0:o.title)&&(null===(s=A.theme.header.elements)||void 0===s?void 0:s.logo)&&t.createElement(Y,{orientation:"vertical",borderColor:"text.400",bgColor:"text.400",height:"5",opacity:"0.64"}),!h&&(null===(c=A.theme.header.elements)||void 0===c?void 0:c.title)&&t.createElement(P,{overflow:"hidden",display:"-webkit-box",className:"dyte-meeting-title"},t.createElement(_,{color:"text.200"},g)),b&&t.createElement(j,{className:"dyte-client-blink"},t.createElement(U,{as:ft,color:"danger.500",mr:1}),t.createElement(_,{color:"danger.500",fontSize:"sm",lineHeight:"100%"},"REC")),y===Mi.webinar&&!C&&t.createElement(j,{className:"dyte-client-blink"},t.createElement(U,{as:Dc,h:"20px",w:"20px",color:"danger.500",mr:1}),!h&&t.createElement(_,{color:"danger.500",fontSize:h?"8px":"md"},"a446c4de-979e-4d4f-97f7-2b695e75ef90"===I.connectionConfig.clientId?"LIVE":"PRESENTING"))),t.createElement(K,null),O[0]&&t.createElement("iframe",{src:O[0].url,title:O[0].view,className:"dyte-iframe",id:"dyte-plugin-titlebar",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",ref:function(e){D.pluginManager.addIframeView(O[0],e)}}),t.createElement(K,null),t.createElement(w,{isInline:!0},!h&&t.createElement(Ac,null),t.createElement(w,{isInline:!0,spacing:h?2:5,p:1,alignItems:"center"},(null===(l=A.theme.header.elements)||void 0===l?void 0:l.participant_count)&&t.createElement(Oc,{isMobile:h}),vo()&&(null===(p=A.theme.controls)||void 0===p?void 0:p.pip_toggle)&&!h&&t.createElement(k,{px:"2",py:"1",leftIcon:E?t.createElement(ht,{size:"1.5em"}):t.createElement(gt,{size:"1.5em"}),onClick:function(){return S(Kn(!E))},fontSize:"md",fontWeight:"medium",background:E?"danger.300":"secondary.800",_hover:{bg:E?"danger.500":"secondary.900"}},E?"Disable PiP":"Enable PiP"),(null===(m=A.theme.header.elements)||void 0===m?void 0:m.participant_count)&&!h&&t.createElement(Y,{marginLeft:1,orientation:"vertical",borderColor:"text.400",bgColor:"text.400",height:"5",opacity:"0.64"}),t.createElement(j,{className:"dyte-clock"},(null===(f=A.theme.header.elements)||void 0===f?void 0:f.timer)&&v!==xn.WAITING&&t.createElement(kc,null)))))})),Rc=function(e){var n=e.isOpen,o=e.onClose,a=t.useRef(),s=d((function(e){return e.room.kicked})),c=r(Ks).mediaRoom,l=r(ua),u=l.meeting,p=l.sessionConfig,m=ln().t,f=function(){wa.callEnded(),u?(u.emit(u.Events.disconnect),u.emit(u.Events.meetingEnded,{kicked:s})):setTimeout((function(){c.stopAllProducers()}))};i((function(){u&&(u.leaveRoom=f)}),[u]),i((function(){s&&f()}),[s]);return t.createElement(re,{isCentered:!0,isOpen:n,leastDestructiveRef:a,onClose:o,portalProps:{containerRef:{current:document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")}}},t.createElement(oe,{bg:"rgba(50, 50, 50, 0.8)"},t.createElement(ae,{width:"auto",bg:"secondary.1000",color:"text.100"},t.createElement(se,{fontSize:"lg",fontWeight:"bold"},t.createElement(ee,{as:"h3",size:"md"},m("Leave"))),t.createElement(ce,null,m("confirm_leave")),t.createElement(le,null,t.createElement(w,{spacing:3,width:"100%"},t.createElement(L,null,t.createElement(k,{size:"sm",flex:"1",variant:"secondaryDefault",ref:a,onClick:o},m("Cancel")),t.createElement(k,{size:"sm",flex:"1",variant:"danger",onClick:function(){return f()},ml:3},m("Leave"))),p.permissions.kick_participant&&t.createElement(k,{size:"sm",width:"100%",variant:"danger",onClick:function(){return En(void 0,void 0,void 0,(function(){return wn(this,(function(e){switch(e.label){case 0:return[4,c.kickAll()];case 1:return e.sent(),[2]}}))}))}},m("End Meeting for All")))))))},Mc=function(e){var i,o=e.variant,s=e.label,c=e.icon,l=e.disabled,u=e.onClick,d=e.onMouseOver,p=e.onMouseOut;e.onMouseEnter,e.onMouseLeave;var m,f=e.isActive,h=e.menu,g=e.badge,v=e.dataCy,y=e.ariaLabel,b=e.fullMenu,E=e.fullMenuOptions,S=e.disableHoverEffect,C=e.permissionWarning,x=a(null),T=Hi(),I=(null===(i=r(ua).sessionConfig.theme)||void 0===i?void 0:i.dimensions)||T,P=I.height,A=I.width,O=A>P,D=uo()&&O,N=n(!1),R=N[0],M=N[1],z="rotate("+(D?90:0)+"deg)",B=A<480;return t.createElement(L,{position:"relative",onMouseOver:d,onMouseOut:p,className:"primaryDefault"===o?"dyte-control-bar-btn-wrapper-small":"dyte-control-bar-btn-wrapper",mx:"2px"},!b&&h.length>0&&t.createElement(ue,{placement:"top"},t.createElement(de,{as:W,"aria-label":"menu-"+s,icon:t.createElement(U,{as:vt,fill:"text.400"}),variant:"none",position:"absolute",top:"0",right:"0",onClick:function(){M((function(e){return!e}))},zIndex:"1",size:"md",minWidth:"2",height:"6"}),R&&(m=h,t.createElement("div",{style:{transform:z,width:0}},t.createElement(pe,{border:"2px solid",borderColor:"secondary.700",p:"0.4em"},m.map((function(e,n){var i=e.title,r=e.defaultValue,o=e.onChange,a=e.options;return t.createElement("div",{key:i+r},0!==n&&t.createElement(me,{my:"0.5em"}),t.createElement(fe,{defaultValue:r,title:i,ml:"2",onChange:o,key:i+r},a.map((function(e){var n=e.key,i=e.value,r=e.children;return t.createElement(he,{iconSpacing:"1em",fontSize:"sm",value:i,key:n,borderRadius:"md"},r)}))))})))))),!b&&t.createElement(k,{variant:o||"controls",onClick:function(){u(),x.current&&x.current.blur()},isDisabled:l,px:"2",pb:"0.3em",pt:{base:"0.3em",sm:"2"},"aria-label":y,"data-cy":v,minWidth:B?"52px":"74px",width:{base:"auto",sm:"auto"},height:B?"36px":"62px",borderRadius:8,border:"2px solid",borderColor:f?"primary.500":"transparent",ref:x,display:"flex",alignItems:"center",justifyContent:"center"},""!==g&&t.createElement(j,{bgColor:"primaryDefault"===o?"text.100":"primary.500",textColor:"primaryDefault"===o?"primary.500":"text.100",className:"primaryDefault"!==o?"dyte-client-notificationBadge dyte-badge-border":"dyte-client-notificationBadge dyte-badge-border-primary"},t.createElement("span",null,g)),t.createElement(w,{transform:z},t.createElement(j,{fontSize:{base:"1.5em",sm:"1.5em"},width:"1em",height:"1em",lineHeight:"24px",mx:"auto"},c),C&&t.createElement(j,{position:"absolute",right:1,top:-4},t.createElement(U,{as:oo,fill:"warning.500"})),!B&&t.createElement(_,{className:S?"":"dyte-control-bar-label",fontSize:"sm",marginTop:"0.25em !important",color:"text.200",display:{base:"none",sm:"block"}},s))),b&&t.createElement(ue,{placement:"top"},t.createElement(de,{as:k,variant:o||"controls",isDisabled:l,width:{base:"100%",sm:"20"},p:"2",height:{base:"40px",sm:"64px"},borderRadius:8,borderTop:f?"primary.500":"transparent",border:"2px solid","aria-label":"menu-"+s},t.createElement(w,{transform:z},t.createElement(j,{fontSize:{base:"sm",sm:"xl"}},c),t.createElement(_,{className:S?"":"dyte-control-bar-label",fontSize:"sm",marginTop:"0.25em !important",display:{base:"none",sm:"block"}},s))),t.createElement(pe,{"aria-label":"menu-list-dyte"},E.map((function(e,n){return t.createElement(ge,{key:e.key,value:e.value,"aria-label":e.key,onClick:function(){return u(e)}},e.label)})))))};function zc(e){var o=e.toggle,a=e.onLoad,s=pn(),c=s.register,l=s.handleSubmit,u=n(2),d=u[0],p=u[1],m=r(Ks).mediaRoom,f=ln().t;i((function(){a()}),[]);return t.createElement(P,{className:"dyte-client-bubble dyte-client-other",alignSelf:"flex-end !important",maxWidth:"400px !important",py:"0.8em",px:"1em",width:"85%"},t.createElement("form",{onSubmit:l((function(e){return function(e){m.newPoll(e),o()}(e)}))},t.createElement(w,{spacing:4},t.createElement(_,{textAlign:"center"},f("Poll Question")),t.createElement(ve,{name:"question",ref:c({required:!0}),rows:4,variant:"dark",className:"dyte-client-dark",placeholder:f("What is your poll for?"),"data-cy":"polls-description",autoFocus:!0}),Array.from({length:d},(function(e,t){return t})).map((function(e){return t.createElement(F,{variant:"dark",key:e,name:"options["+e+"]",ref:c({required:!0}),className:"dyte-client-dark",placeholder:f("Enter an option"),"data-cy":"polls-option-"+e})})),t.createElement(k,{onClick:function(){return p(d+1)},size:"sm",px:2,py:2,height:"auto",fontSize:"1em",variant:"alternateDark",width:"full",leftIcon:t.createElement(U,{as:yt,fill:"text.300",boxSize:5}),"data-cy":"polls-add-option",iconSpacing:"0.5em"},f("Add an option")),t.createElement(ye,{name:"anonymous",variant:"poll",ref:c},f("Anonymous")),t.createElement(ye,{name:"hideVotes",variant:"poll",ref:c,defaultIsChecked:!0},f("Hide results before voting")),t.createElement(P,{height:1}),t.createElement(k,{type:"submit","data-cy":"polls-create-poll"},f("Create Poll")))))}function Lc(e){var n=e.option;e.index;var i=e.active,r=e.selfId,o=n.votes.find((function(e){return e.id===r})),a={containerRef:{current:document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")}};return t.createElement(L,{direction:"column",bgColor:i?"primary.500":"secondary.700",borderRadius:"0.5em",p:2,className:"dyte-client-noSelect"},t.createElement(L,{px:1,justifyContent:"space-between"},t.createElement(ye,{variant:"poll",isChecked:!!o,overflowWrap:"anywhere",spacing:"0.5em"},t.createElement(P,{color:"text.100"},n.text)),null!==n.count&&t.createElement(_,null,"("+n.count+")")),t.createElement(L,{mt:2},n.votes.slice(0,3).map((function(e){return t.createElement(ne,{placement:"auto",label:e.name,key:"poll-vote-"+e.id,portalProps:a},t.createElement(G,{size:"sm",w:8,h:8,mx:"0.1em",bgColor:i?"secondary.700":"primary.500",src:Nr.apiBase+"/picture/"+e.id,color:"text.100",name:e.name,fontSize:"inherit",lineHeight:"base"}))})),n.votes.length>3&&t.createElement(ne,{placement:"auto",label:n.votes.slice(3).map((function(e){return e.name})).join(", "),portalProps:a},t.createElement(G,{size:"sm",w:8,h:8,mx:"0.1em",bgColor:i?"secondary.700":"primary.500",color:"text.100",name:"+"+(n.votes.length-3),getInitials:function(e){return e}}))))}function jc(e){var n=e.selfPeer,i=e.mediaRoom,r=e.poll;if(r){var o=Math.max.apply(Math,Sn(Sn([],r.options.map((function(e){return e.votes.length})),!1),[0],!1));return t.createElement(P,null,t.createElement(w,{spacing:2},t.createElement(_,{textAlign:"left"},r.question),r.options.map((function(e,a){return t.createElement(P,{onClick:function(){return function(e){i.votePoll({index:e,pollId:r.id})}(a)},key:a,"data-cy":"polls-vote-option-"+a},t.createElement(Lc,{active:e.votes.length===o&&e.votes.length>0,option:e,index:a,selfId:n.userId}))}))))}return t.createElement(_,{fontStyle:"italic"},"Poll wasn't found or has been deleted")}function Bc(e){var n=e.active,o=M(),s=o.isOpen,c=o.onToggle,l=r(Ks).mediaRoom,p=r(Ws).selfPeer,m=r(ua).sessionConfig,f=d((function(e){return e.room.polls})),h=a(null),g=ln().t,v=function(){bo()?h.current.scrollIntoView():h.current.scrollIntoView({behavior:"smooth",inline:"start",block:"nearest"})};i(v,[]);var y=d((function(e){return e.room.chatMessages})).filter((function(e){return!0!==e.read&&e.type===Tc.poll})),b=u();return i((function(){y.length>0&&n&&b(Ei(Tc.poll))}),[y]),t.createElement(L,{height:"100%",direction:"column",justifyContent:"space-between",overflowY:"auto"},t.createElement(_,{textAlign:"center"},g("Polls")),t.createElement(P,{marginTop:"2em",overflowY:"auto",className:"dyte-client-noScrollbar",flexGrow:1},Object.values(f).map((function(e,n){return t.createElement(P,{my:2,key:n},t.createElement(_,{ml:4},e.createdBy?"Poll by "+e.createdBy:""),t.createElement(P,{mt:1,className:"dyte-polls dyte-client-bubble dyte-client-other dyte-client-type-3"},t.createElement(jc,{mediaRoom:l,poll:e,selfPeer:p})))})),t.createElement(P,{my:3},s&&t.createElement(zc,{onLoad:v,toggle:c})),t.createElement("div",{ref:h})),m.permissions.polls.can_create&&t.createElement(k,{fontSize:"1em",variant:s?"dangerSimple":"primaryDefault",onClick:function(){c()},"data-cy":"polls-create-button",boxShadow:s?"0 0 12px rgba(0,0,0,0.3)":"0"},g(s?"Cancel Poll Creation":"Create New Poll")))}function Fc(e){fetch(e).then((function(e){return e.blob()})).then((function(e){!function(e){var t,n=[new ClipboardItem((t={},t[e.type]=e,t))];navigator.clipboard.write(n)}(e)})).catch((function(e){return la.warn("image_cp_failed",e)}))}function Vc(e){if(e){var t=new URL(e).pathname.split("/"),n=decodeURIComponent(t[t.length-1]);fetch(e).then((function(e){return e.blob()})).then((function(e){var t=URL.createObjectURL(e),i=document.createElement("a");i.href=t,i.style.display="none",n&&(i.download=n),document.body.appendChild(i),i.click(),document.body.removeChild(i)})).catch((function(e){return la.warn("image_dl_failed",e)}))}}Mc.defaultProps={disabled:!1,variant:null,menu:[],isActive:!1,badge:"",ariaLabel:"",dataCy:"",fullMenu:!1,fullMenuOptions:[],disableHoverEffect:!1,onMouseOver:function(){},onMouseOut:function(){},onMouseEnter:function(){},onMouseLeave:function(){},permissionWarning:!1};var Wc=function(e){var i,r=e.isOpen,o=e.setImageModalData,a=e.imageLink,s=e.userAvatarSrc,c=e.userDisplayName,l=t.useRef(),u=a&&a.endsWith(".png"),d=n(!0),p=d[0],m=d[1],f=n(!1),h=f[0],g=f[1];return t.createElement(re,{isCentered:!0,isOpen:r,size:"5xl",leastDestructiveRef:l,onClose:function(){return o({isOpen:!1})},portalProps:{containerRef:{current:document.getElementById("dyte-base-elem")||(null===(i=document.getElementById("dyte-shadow"))||void 0===i?void 0:i.shadowRoot.getElementById("dyte-base-elem"))}}},t.createElement(oe,{bg:"rgba(50, 50, 50, 0.8)"},t.createElement(ae,{padding:["10px","24px"],width:"auto",bg:"secondary.1000",color:"text.100"},t.createElement(C,{marginBottom:"20px"},t.createElement(Xs,{name:c,imgSrc:s,size:"sm",dimensions:30}),t.createElement(_,null,"Shared by"," ",t.createElement("b",null,c)),t.createElement(ne,{textAlign:"center",label:"Close",portalProps:{containerRef:{current:document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")}}},t.createElement(P,{onClick:function(){return o({isOpen:!1})},cursor:"pointer",_hover:{backgroundColor:"secondary.700"},transition:"background-color ease 0.3s",position:"absolute",right:["15px","27px"],top:["10px","22px"],padding:"6px 10px",paddingTop:"4px",backgroundColor:"secondary.800",verticalAlign:"middle",fontSize:"17px",borderRadius:"4px"},t.createElement(U,{fill:"danger.500",as:ct})))),p&&t.createElement(S,null),t.createElement(P,{display:p?"none":"block",onLoad:function(){return m(!1)}},t.createElement(ie,{src:a,alt:"Image shared by "+c,objectFit:"contain",maxW:"100%",maxH:"80vh",marginX:"auto"})),t.createElement(C,{marginTop:"20px",textAlign:"center",alignItems:"center",justifyContent:"center",flexWrap:"wrap"},u&&t.createElement(k,{size:"sm",fontSize:"13px",width:"40",display:["none","block"],marginRight:[0,"20px"],marginBottom:["10px",0],leftIcon:h?t.createElement(U,{as:Ke,fontSize:"18px"}):t.createElement(U,{as:Ze}),variant:"secondaryDefault",onClick:h?null:function(){Fc(a),g(!0),setTimeout((function(){g(!1)}),5e3)}},h?"Copied":"Copy Image"),t.createElement(k,{size:"sm",fontSize:"13px",width:"40",leftIcon:t.createElement(U,{as:bt}),onClick:function(){Vc(a)}},"Download")))))},Uc=function(e){var i=e.src,r=e.setImageModalData,o=e.userAvatarSrc,a=e.userDisplayName,s=i&&i.endsWith(".png"),c=n(!1),l=c[0],u=c[1],d={containerRef:{current:document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")}};return t.createElement(P,{display:"none",position:"absolute",cursor:"pointer",top:"2px",right:"2px",backgroundColor:"secondary.900",padding:"5px 10px",paddingTop:"0px",borderRadius:"5px",minWidth:s?"100px":"70px",fontSize:"20px",className:"dyte-client-chat-img-actions"},s&&(l?t.createElement(ne,{textAlign:"center",shouldWrapChildren:!0,label:"Copied",portalProps:d},t.createElement(U,{fill:"white",_hover:{fill:"primary.500"},as:Ke,marginRight:"9px"})):t.createElement(ne,{textAlign:"center",shouldWrapChildren:!0,label:"Copy Image",portalProps:d},t.createElement(U,{fill:"white",as:Ze,_hover:{fill:"primary.500"},marginRight:"9px",onClick:function(e){e.stopPropagation(),Fc(i),u(!0),setTimeout((function(){u(!1)}),5e3)}}))),t.createElement(ne,{textAlign:"center",shouldWrapChildren:!0,label:"Download Image",portalProps:d},t.createElement(U,{fill:"white",as:bt,marginRight:"9px",_hover:{fill:"primary.500"},onClick:function(e){e.stopPropagation(),Vc(i)}})),t.createElement(ne,{textAlign:"center",shouldWrapChildren:!0,label:"Expand Image",portalProps:d},t.createElement(U,{fill:"white",_hover:{fill:"primary.500"},onClick:function(){return r({isOpen:!0,imageLink:i,userAvatarSrc:o,userDisplayName:a})},as:st})))},qc=/(https?:\/\/[^\s]+)/,Hc=function(e){var n=e.msg.message.trim().split(" "),i=n.length-1;return t.createElement("div",null,n.map((function(e,n){var r=" ";return n===i&&(r=""),e.match(qc)?t.createElement("span",{key:e},t.createElement(we,{href:e,isExternal:!0},e),r):t.createElement("span",{key:e},e,r)})))},Gc=function(e){return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},Jc=function(e){var i=e.link,r=e.setImageModalData,o=e.userDisplayName,a=e.userAvatarSrc,s=i.link,c=n(!0),l=c[0],u=c[1];return t.createElement(P,{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",paddingBottom:1,className:"dyte-client-chat-img-linkbox",cursor:"zoom-in",onLoad:function(){return u(!1)},onClick:function(e){e.stopPropagation(),r({isOpen:!0,imageLink:s,userAvatarSrc:a,userDisplayName:o})},height:"10em",minW:"8em"},l&&t.createElement(S,null),t.createElement(Uc,{src:s,setImageModalData:r,userAvatarSrc:a,userDisplayName:o}),t.createElement(ie,{src:s,display:l?"none":"block",alt:"",objectFit:"cover",height:"100%",mx:"auto"}))};var Yc=function(e){var n=e.message,i=n.name,r=n.size,o=n.link;return t.createElement(L,{alignItems:"center",wordBreak:"break-word"},t.createElement(L,{direction:"column"},t.createElement(_,{textAlign:"left"},i),t.createElement(_,{textAlign:"left",fontSize:"12px"},function(e){var t=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,t)).toFixed(2)+" "+["B","kB","MB","GB","TB"][t]}(r))),t.createElement(P,{ml:3},t.createElement("a",{href:o,target:"_blank",rel:"noreferrer",download:i},t.createElement(U,{as:Ct,fill:"white",boxSize:6}))))};function Kc(e){var n=e.children,i=e.icon,r=e.variant,o=e.onClick;return t.createElement(ge,{as:k,icon:i,width:"auto",height:"2.5em",borderRadius:"full",px:4,py:2,lineHeight:"100%",verticalAlign:"middle",onClick:o,variant:r,margin:3,backgroundColor:"secondary.700",_hover:{bg:ao.secondary[800]+" !important"},iconSpacing:"1em",commandSpacing:"1em"},n)}function Zc(e){var n=e.message,i=e.setImageModalData,o=e.userDisplayName,a=e.userAvatarSrc,s=r(Ks).mediaRoom,c=d((function(e){return e.room.polls})),l=r(Ws).selfPeer;switch(n.type){case Tc.text:return t.createElement(Hc,{msg:n});case Tc.image:return t.createElement(Jc,{link:n,setImageModalData:i,userDisplayName:o,userAvatarSrc:a});case Tc.file:return t.createElement(Yc,{message:n});default:return t.createElement(jc,{mediaRoom:s,poll:c[n.pollId],selfPeer:l})}}var Qc=l((function(e){var i=e.messages,r=d((function(e){return e.participant.id})),o=d((function(e){return e.plugin.plugins})),a=n({isOpen:!1,imageLink:"",userAvatarSrc:"",userDisplayName:""}),s=a[0],c=a[1];return t.createElement(t.Fragment,null,t.createElement(Wc,{isOpen:s.isOpen,setImageModalData:c,imageLink:s.imageLink,userDisplayName:s.userDisplayName,userAvatarSrc:s.userAvatarSrc}),i.map((function(e,n){var a,s,l,u,d,p,m=o.find((function(t){return t.id===e.pluginId})),f=m?""+m.name:e.displayName,h=m?m.picture:Nr.apiBase+"/picture/"+e.userId;return p=e.userId!==(null===(a=i[n-1])||void 0===a?void 0:a.userId)&&e.userId!==(null===(s=i[n+1])||void 0===s?void 0:s.userId)||e.pluginId?"only":e.userId===(null===(l=i[n-1])||void 0===l?void 0:l.userId)&&e.userId===(null===(u=i[n+1])||void 0===u?void 0:u.userId)?"middle":e.userId!==(null===(d=i[n-1])||void 0===d?void 0:d.userId)?"first":"last",e.userId!==r||e.pluginId?t.createElement(w,{className:"dyte-client-otherText dyte-client-"+p,key:n},("first"===p||"only"===p)&&t.createElement(_,{className:"dyte-client-user",color:"text.100",size:"xs"},f," ",m&&t.createElement(be,{marginLeft:"5px",fontSize:"0.5em"},"Plugin")),t.createElement(L,{direction:"row",alignItems:"flex-end",marginTop:"0 !important"},"last"===p||"only"===p?t.createElement(Xs,{name:f,imgSrc:Nr.apiBase+"/picture/"+e.userId,size:"sm",dimensions:30}):t.createElement(P,{w:30,h:30}),t.createElement("div",{className:"dyte-client-bubble dyte-client-other dyte-client-selectable dyte-client-"+p+" dyte-client-type-"+e.type},t.createElement(Zc,{message:e,setImageModalData:c,userDisplayName:f,userAvatarSrc:h}),t.createElement(_,{color:"text.400",fontSize:"10px",className:"dyte-client-chat-timestamp dyte-client-noSelect"},e.time&&Gc(e.time))))):t.createElement(w,{className:"dyte-client-selfText dyte-client-"+p,width:"100%",key:n},t.createElement("div",{className:"dyte-client-bubble dyte-client-self dyte-client-selectable dyte-client-"+p+" dyte-client-type-"+e.type},t.createElement(Zc,{message:e,setImageModalData:c,userDisplayName:f,userAvatarSrc:h}),t.createElement(_,{color:"text.300",fontSize:"10px",className:"dyte-client-chat-timestamp dyte-client-noSelect"},e.time&&Gc(e.time))))})))}),(function(e,t){return e.messages.length===t.messages.length}));function Xc(e){var o=e.openSidebarView;e.active;var s=n(""),c=s[0],l=s[1],p=d((function(e){return e.room.roomName})),m=d((function(e){return e.room.chatMessages})),f=d((function(e){return e.participant.id})),h=m.filter((function(e){return!0!==e.read&&e.userId!==f})),g=r(Ws).selfPeer,v=r(Ks).mediaRoom,y=r(ua).sessionConfig,b=ln().t,E=a(null),w=a(null),S=a(null),C=a(null),x=Ge("\n  mutation($file: Upload!, $roomName: String!) {\n    uploadFile(file: $file, roomName: $roomName) {\n\t\tlink\n    }\n  }\n")[0],T=u(),I=a(null),A=n(!1),O=A[0],D=A[1],N=a(!1),R=a(!0),M=function(){N.current=!0,bo()?E.current.scrollIntoView():E.current.scrollIntoView({behavior:"smooth",inline:"start",block:"nearest"}),D(!1),T(Ei(null)),setTimeout((function(){N.current=!1}),600)},z=function(){N.current=!0,setTimeout((function(){M()}),400)},F=function(){var e,t,n=(null===(t=null===(e=document.getElementById("dyte-shadow"))||void 0===e?void 0:e.shadowRoot.querySelector("[data-cy=chat-input-textarea]"))||void 0===t?void 0:t.value)||"",i=c||n;if(""!==i.trim()){var r={message:i,userId:g.id,displayName:g.displayName,type:Tc.text,time:(new Date).getTime()};v.sendMessage(r),c?l(""):document.getElementById("dyte-shadow")&&(document.getElementById("dyte-shadow").shadowRoot.querySelector("[data-cy=chat-input-textarea]").value=""),z()}};function V(e){var t=e.target,n=t.validity,i=t.files[0];return En(this,void 0,void 0,(function(){return wn(this,(function(e){switch(e.label){case 0:return n.valid?[4,x({variables:{file:i,roomName:p}})]:[3,2];case 1:(function(e,t,n){var i={displayName:g.displayName,type:Tc.file,link:e,userId:g.id,name:t,size:n,time:(new Date).getTime()};v.sendMessage(i),z()})(e.sent().data.uploadFile.link,i.name,i.size),e.label=2;case 2:return[2]}}))}))}function q(e){var t=e.target,n=t.validity,i=t.files[0];return En(this,void 0,void 0,(function(){return wn(this,(function(e){switch(e.label){case 0:return n.valid?[4,x({variables:{file:i,roomName:p}})]:[3,2];case 1:(function(e){var t={displayName:g.displayName,type:Tc.image,link:e,userId:g.id,time:(new Date).getTime()};v.sendMessage(t),z()})(e.sent().data.uploadFile.link),e.label=2;case 2:return[2]}}))}))}i((function(){C.current.focus({preventScroll:!0}),M();var e=function(e){I.current.scrollTop+I.current.clientHeight+100<I.current.scrollHeight?(R.current&&!N.current&&(R.current=!1),O||N.current||D(!0)):(R.current||(R.current=!0),D(!1),T(Ei(null)))},t=function(e){var t=e.target.innerText;e.clipboardData.setData("text/plain",t)},n=I.current;return null==n||n.addEventListener("scroll",e),null==n||n.addEventListener("copy",t),function(){null==n||n.removeEventListener("scroll",e),null==n||n.removeEventListener("copy",t)}}),[]),i((function(){h.length>0&&R.current&&M()}),[h]);return t.createElement(L,{height:"100%",direction:"column",justifyContent:"space-between",p:"1",pr:"0"},t.createElement(j,null,t.createElement(_,null,b("Chat"))),t.createElement(P,{flexGrow:1,overflowY:"hidden",position:"relative"},t.createElement(P,{height:"100%",className:"dyte-client-scrollbar",paddingTop:"2em",overflowY:"auto",flexGrow:1,ref:I},t.createElement("section",{className:"dyte-client-discussion"},t.createElement(Qc,{messages:m}),t.createElement("div",{ref:E}))),t.createElement(dn,null,O&&t.createElement(un.div,{initial:{y:100},animate:{y:0},transition:{ease:"easeInOut"},exit:{y:100}},t.createElement(P,{position:"absolute",bottom:"0",w:"100%",display:"flex",flexDir:"column"},t.createElement(k,{leftIcon:t.createElement(Et,{size:"1.25em"}),onClick:M,h:"10",fontSize:"sm",w:"auto",mx:"auto",rounded:"full",mb:"-6",bg:h.length>0?"primary.500":"secondary.700",_hover:{bg:h.length>0?"primary.700":"secondary.800"}},"See latest messages"," ",h.length>0&&"("+h.length+")"),t.createElement(P,{h:"10",bgGradient:"linear(to-b, transparent, secondary.1000)"}))))),t.createElement(P,null,t.createElement(B,{alignItems:"center"},t.createElement(X,{top:"inherit",left:"0.5em"},t.createElement(ue,{variant:"chat",autoSelect:!1,placement:"top-start",isLazy:!0},(function(e){var n=e.isOpen;return t.createElement(t.Fragment,null,t.createElement("input",{onChange:q,ref:w,type:"file",id:"selectedFile",style:{display:"none"},accept:"image/*"}),t.createElement("input",{onChange:V,ref:S,type:"file",id:"selectedFile",style:{display:"none"}}),(y.permissions.chat.public.files||y.permissions.polls.can_create&&y.theme.control_bar.elements.polls)&&t.createElement(de,{as:W,bg:"secondary.700",_expanded:{bg:"primary.500"},variant:"solid",size:"md",p:"0.5em",icon:t.createElement(U,{as:yt,transitionDuration:"0.2s",transform:n?"rotate(45deg)":"none",fill:"text.100",boxSize:"6",_hover:{fill:"text.200"}}),"aria-label":"Add attachment",isRound:!0}),t.createElement(pe,{marginLeft:"-20px"},y.permissions.chat.public.files&&t.createElement(ge,{onClick:function(){return S.current.click()},p:0,pl:4,mb:4},t.createElement(_,{fontSize:"sm"},"Limit: 1MB / file")),y.permissions.chat.public.files&&t.createElement(Kc,{variant:"alternateDark",icon:t.createElement(U,{fill:"text.100",w:"1.5em",h:"1.5em",as:wt}),onClick:function(){return S.current.click()}},b("File")),y.permissions.polls.can_create&&y.theme.control_bar.elements.polls&&t.createElement(Kc,{variant:"alternateDark",icon:t.createElement(U,{fill:"text.100",w:"1.5em",h:"1.5em",as:St}),onClick:function(){return o(tl.Polls)}},b("Poll")),y.permissions.chat.public.files&&t.createElement(Kc,{variant:"alternateDark",icon:t.createElement(U,{fill:"text.100",w:"1.5em",h:"1.5em",as:_t}),onClick:function(){return w.current.click()}},b("Image"))))}))),t.createElement(ve,{className:"dyte-client-chatInput",onKeyPress:function(e){13===e.charCode&&(e.shiftKey||(F(),e.preventDefault()))},ref:C,color:"text.100",backgroundColor:"secondary.800",border:"none",focusBorderColor:"primary.500",errorBorderColor:"none",size:"sm",minHeight:"48px",lineHeight:"2",resize:"none",borderRadius:"60px",disabled:!y.permissions.chat.public.text,paddingLeft:"50px",paddingRight:"50px",fontSize:"16px",placeholder:b("Type a message..."),_placeholder:{color:"text.200"},onChange:function(e){return l(e.target.value)},value:c,"data-cy":"chat-input-textarea"}),t.createElement(Ee,{top:"inherit",right:"0.5em"},t.createElement(W,{disabled:!y.permissions.chat.public.text,onClick:function(){return F()},variant:"solid",icon:t.createElement(U,{as:kt,boxSize:"6",fill:"text.100","aria-label":"add"}),"aria-label":"Send message",size:"md",p:"0.5em","data-cy":"chat-send-button",isRound:!0})))))}function $c(e){var n,i=e.peer,o=e.mediaRoom,a=e.permissions,s=e.showPresentersAction,c=e.showAttendeesAction,l=e.showAudioVideoIcons,u=e.participantControls,p=d((function(e){return e.room.activeSpeakerPeerId})),m=d((function(e){return e.room.roomViewType})),f=i.id===p,h=r(Ws).individualControls,g=(null==a?void 0:a.pin_participant)||(null==a?void 0:a.can_allow_participant_audio)||(null==a?void 0:a.can_allow_participant_video);return t.createElement(L,{key:i.id,direction:"row",alignItems:"center",className:"dyte-client-noSelect",borderBottom:"1px solid",borderColor:"secondary.800"},t.createElement(Xs,{size:"sm",name:i.displayName,imgSrc:Nr.apiBase+"/picture/"+i.userId}),t.createElement(L,{marginLeft:3,flexGrow:1,alignItems:"center",paddingY:4},t.createElement(C,{color:"text.200"},t.createElement(_s,{name:i.displayName,charSize:20}),t.createElement(P,{backgroundColor:"primary.500",color:"text.100",fontSize:"sm",borderRadius:3,px:1},i.isMe?"me":i.label)),t.createElement(L,{marginLeft:"auto",marginRight:2},l&&(i.audioMuted?t.createElement(U,{boxSize:"1.25em",marginRight:3,as:Qe,fill:"danger.500"}):t.createElement(U,{boxSize:"1.25em",marginRight:3,as:xt,fill:f?"primary.500":"text.400"})),l&&(i.videoConsumerId?t.createElement(U,{boxSize:"1.25em",marginRight:g?3:0,as:Tt,fill:"text.400"}):t.createElement(U,{boxSize:"1.25em",marginRight:g?3:0,as:It,fill:"danger.500"})),g&&t.createElement(ue,{placement:"auto"},t.createElement(de,{as:W,"aria-label":"menu",icon:t.createElement(U,{as:vt,fill:"text.400",boxSize:"5"}),variant:"none",size:"sm",minWidth:"2",boxSize:"1.25em"}),t.createElement(pe,{zIndex:3},(null==a?void 0:a.pin_participant)&&m!==Mi.webinar&&(i.isPinned?t.createElement(ge,{onClick:function(){return o.pin(null)}},"Unpin"):t.createElement(ge,{onClick:function(){return o.pin(i.id)}},"Pin")),(null==a?void 0:a.can_allow_participant_audio)&&t.createElement(ge,{isDisabled:i.audioMuted,onClick:function(){return o.disableAudio(i.id)}},"Mute Audio"),(null==a?void 0:a.can_allow_participant_video)&&t.createElement(ge,{isDisabled:!i.videoConsumerId,onClick:function(){return o.disableVideo(i.id)}},"Disable Video"),!i.isMe&&(null==a?void 0:a.kick_participant)&&t.createElement(ge,{onClick:function(){return o.kick(i.id)}},"Kick"),m===Mi.webinar&&!i.isMe&&s&&t.createElement(ge,{onClick:function(){return o.removePeerFromStage(i.id,Li.REQUESTED_BY_MODERATOR)}},"Force Stop Presenting"),m===Mi.webinar&&!i.isMe&&c&&t.createElement(ge,{onClick:function(){return o.acceptAllRequestToJoinStage([{id:i.id,requestToJoinType:qi.present,type:Li.REQUESTED_BY_MODERATOR}])}},"Grant Premission to Present"),(null==u?void 0:u.length)>0&&t.createElement(me,{my:"2",border:"`1px solid",borderColor:"secondary.700"}),null==u?void 0:u.map((function(e){return t.createElement(ge,{onClick:function(){return e.onClick(i.id)}},e.label)})),h[i.id]&&t.createElement(me,{my:"2",border:"`1px solid",borderColor:"secondary.700"}),null===(n=h[i.id])||void 0===n?void 0:n.map((function(e){return i.id===e.id?t.createElement(ge,{key:e.id,onClick:function(){return e.onClick(i.id)}},e.label):null})))))))}function el(){var e=r(Ws),o=e.processedPeers,a=e.joinedProcessedPeers,s=e.selfPeer;o=[s].concat(o.sort((function(e,t){return e.id.localeCompare(t.id)}))).filter((function(e){return!(null==e?void 0:e.webinarHiddenParticipant)||(null==e?void 0:e.metadata.view_type)===Mi.groupCall}));var c,l=[s].concat(a).filter((function(e){return!(null==e?void 0:e.webinarHiddenParticipant)&&e.requestToJoinType===qi.ask}));o=o.concat(l).filter((c=new Set,function(e){return!c.has(e.id)&&c.add(e.id)}));var p=r(Ks).mediaRoom,m=r(ua),f=m.sessionConfig,h=m.participantControls,g=n(""),v=g[0],y=g[1],b=u(),E=d((function(e){return e.participant.organizationId})),w=ln().t,S=a.filter((function(e){return(null==e?void 0:e.metadata.view_type)===Mi.webinar})).map((function(e){return e.id})),k=d((function(e){return e.room.requestToJoinPeersList})).filter((function(e){return S.includes(e.id)})),C=k.filter((function(e){return e.requestToJoinType===qi.present})),x=k.filter((function(e){return e.requestToJoinType===qi.ask})),T=[s].concat(a).filter((function(e){return(null==e?void 0:e.webinarHiddenParticipant)&&(null==e?void 0:e.metadata.view_type)===Mi.webinar})).filter((function(e,t,n){return n.findIndex((function(t){return t.id===e.id}))===t}));i((function(){b(Pi())}),[]);var I=function(e,t){p.acceptAllRequestToJoinStage([{id:e,requestToJoinType:t,type:Li.REQUESTED_BY_PARTICIPANT}])},A=function(e){p.rejectRequestToJoinStage(e)},O=function(e){p.acceptAllRequestToJoinStage(e.map((function(e){return{id:e.id,requestToJoinType:e.requestToJoinType}})))};return t.createElement(P,{px:"0.4em",height:"100%",overflowY:"auto",className:"dyte-client-noScrollbar"},t.createElement(j,null,t.createElement(_,null,w("Participants"))),t.createElement(P,{marginTop:"1.4em"},t.createElement(_,null,"In Call (",a.filter((function(e,t,n){return n.findIndex((function(t){return t.id===e.id}))===t})).length+1,")"),"1ad1a2b3-1ed1-41f3-a491-6acfab230eaf"!==E&&t.createElement(B,{marginY:4},t.createElement(X,null,t.createElement(U,{boxSize:6,as:tt,fill:"text.400","aria-label":"Search"})),t.createElement(F,{color:"text.100",backgroundColor:"secondary.800",border:"none",borderRadius:"0.25em",focusBorderColor:"none",errorBorderColor:"none",size:"md",fontSize:"1em",placeholder:"Search",value:v,onChange:function(e){return y(e.target.value)}})),x.length>0&&t.createElement(P,{marginTop:"1.5em"},t.createElement(L,{direction:"row",justifyContent:"space-between",marginBottom:"1.5"},t.createElement(_,{color:"#FF414D"},"Request to ask   (",x.length,")"),t.createElement(_,{color:"#2160FD",cursor:"pointer",onClick:function(){return O(x)}},"Accept All")),x.filter((function(e){return""===v||e.name.toLowerCase().includes(v.toLowerCase())})).map((function(e){return t.createElement(L,{key:e.id,direction:"row",alignItems:"center"},t.createElement(Xs,{size:"sm",name:e.name}),t.createElement(L,{marginLeft:3,flexGrow:1,alignItems:"center",paddingY:2,borderBottom:"1px solid",borderColor:"secondary.800"},t.createElement(_,{color:"text.200",fontSize:"md"},e.name),t.createElement(L,{marginLeft:"auto"},t.createElement(W,{variant:"solidDarker",color:"danger.500",size:"sm","aria-label":"reject",icon:t.createElement(U,{boxSize:"5",as:at}),_hover:{borderColor:"danger.500"},onClick:function(){return A(e.id)}}),t.createElement(W,{variant:"solidDarker",color:"primary.300",size:"sm","aria-label":"accept",p:1,icon:t.createElement(U,{boxSize:"5",as:Ke}),_hover:{borderColor:"primary.500"},onClick:function(){return I(e.id,e.requestToJoinType)},ml:2}))))}))),C.length>0&&t.createElement(P,{marginTop:"1.5em"},t.createElement(L,{direction:"row",justifyContent:"space-between",marginBottom:"1.5"},t.createElement(_,{color:"#FF414D"},"Requesting to present (",C.length,")"),t.createElement(_,{color:"#2160FD",cursor:"pointer",onClick:function(){return O(C)}},"Accept All")),C.filter((function(e){return""===v||e.name.toLowerCase().includes(v.toLowerCase())})).map((function(e){return t.createElement(L,{key:e.id,direction:"row",alignItems:"center"},t.createElement(Xs,{size:"sm",name:e.name}),t.createElement(L,{marginLeft:3,flexGrow:1,alignItems:"center",paddingY:2,borderBottom:"1px solid",borderColor:"secondary.800"},t.createElement(_,{color:"text.200",fontSize:"md"},e.name),t.createElement(L,{marginLeft:"auto"},t.createElement(W,{variant:"solidDarker",color:"danger.500",size:"sm","aria-label":"reject",icon:t.createElement(U,{boxSize:"5",as:at}),_hover:{borderColor:"danger.500"},onClick:function(){return A(e.id)}}),t.createElement(W,{variant:"solidDarker",color:"primary.300",size:"sm","aria-label":"accept",p:1,icon:t.createElement(U,{boxSize:"5",as:Ke}),_hover:{borderColor:"primary.500"},onClick:function(){return I(e.id,e.requestToJoinType)},ml:2}))))}))),t.createElement(P,{marginTop:"1.5em"},o.filter((function(e){return""===v||e.displayName.toLowerCase().includes(v.toLowerCase())})).map((function(e){return t.createElement($c,{peer:e,key:e.id,mediaRoom:p,permissions:null==f?void 0:f.permissions,participantControls:h,showPresentersAction:!0})}))),f.permissions.show_participant_list&&T.length>0&&t.createElement(P,{marginTop:"1.5em"},t.createElement(L,{direction:"row",justifyContent:"space-between",mb:"2"},t.createElement(_,null,"Attendees (",T.length,")")),T.filter((function(e){return""===v||e.displayName.toLowerCase().includes(v.toLowerCase())})).map((function(e){return t.createElement($c,{peer:e,key:e.id,mediaRoom:p,permissions:null==f?void 0:f.permissions,showAttendeesAction:!0,showAudioVideoIcons:!1,participantControls:h})})))))}$c.defaultProps={showPresentersAction:!1,showAttendeesAction:!1,showAudioVideoIcons:!0,participantControls:[]};var tl,nl={hidden:{y:-20,opacity:0,scale:.96},visible:{opacity:1,y:0},hovered:{scale:1},exit:{opacity:0,scale:0},hiddenNoPlugin:{opacity:0,scale:1},exitNoPlugin:{scale:0,opacity:0,transition:{duration:0}}};function il(e){var n,i=e.plugin,o=e.activePlugins,a=e.screenSharing,s=e.openSidebarView,c=e.canStart,l=r(dc),u=r(ua).meeting;return a?n="Disable screen share to activate a plugin.":c?o>0&&(n="Stop the current plugin to start a new one"):n="You don't have the required permissions",t.createElement(un.div,{variants:nl,initial:"hidden",animate:"visible",whileHover:"hovered"},t.createElement(L,{marginY:"0.8em",borderRadius:"0.5em",padding:"0.75em",backgroundColor:"secondary.1000",direction:"column"},t.createElement(L,{direction:"row",alignItems:"center"},t.createElement(ie,{height:"2.75em",width:"2.75em",src:i.picture,marginRight:"0.75em",borderRadius:"lg"}),t.createElement(P,null,t.createElement(ee,{fontWeight:500,fontSize:"1.2em",color:"text.200"},i.name)),n?t.createElement(P,{marginLeft:"auto"},t.createElement(ne,{textAlign:"center",shouldWrapChildren:!0,label:n,openDelay:200,placement:"top-start",maxW:40,portalProps:{containerRef:{current:document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")}}},t.createElement(W,{variant:"solidDarker",icon:t.createElement(U,{boxSize:"6",as:no,fill:"primary.500"}),size:"lg","aria-label":"enable plugin",opacity:"0.5",_hover:{},borderRadius:"lg",disabled:!0}))):t.createElement(W,{variant:"solidDarker",borderRadius:"lg",marginLeft:"auto",icon:t.createElement(U,{boxSize:"6",as:no,fill:"primary.500"}),size:"lg","aria-label":"enable plugin",onClick:function(){l.pluginManager.addRoomPlugin(i),s(tl.Plugins),u.plugins.forEach((function(e){e.id===i.id&&e.data.length>0&&e.data.forEach((function(t){return e.sendData(t)}))}))},"data-cy":"plugins-"+i.name+"-enable-button"})),t.createElement(_,{marginTop:"0.5em",color:"text.400"},i.description)))}function rl(e){var n=e.plugin,i=e.pluginPermissions,o=r(dc),a=d((function(e){return e.peers.joinedPeers})),s=d((function(e){return e.participant.id})),c=ln().t,l=s===(null==n?void 0:n.enabledBy)||(null==i?void 0:i.can_close);return t.createElement(un.div,{variants:nl,initial:"hidden",animate:"visible",exit:"exit"},t.createElement(L,{marginY:"0.8em",borderRadius:"0.5em",padding:"0.5em",direction:"column"},t.createElement(L,{direction:"row",alignItems:"center"},t.createElement(ie,{height:"2.75em",width:"2.75em",src:n.picture,marginRight:"0.75em",borderRadius:"lg"}),t.createElement(P,null,t.createElement(ee,{fontWeight:500,fontSize:"1.2em",color:"text.100"},n.name),t.createElement(_,{fontSize:"0.8em",color:"text.400"},function(){if(!n.enabledBy)return c("Activated");if(n.enabledBy===s)return c("Activated by me");var e=a.find((function(e){return e.userId===n.enabledBy}));return e?"Activated by "+e.displayName:c("Activated")}())),l&&t.createElement(W,{variant:"solidDarker",marginLeft:"auto",icon:t.createElement(U,{boxSize:"6",as:at,fill:"danger.500"}),size:"lg","aria-label":"close plugin",onClick:function(){o.pluginManager.removeRoomPlugin({id:n.id})},"data-cy":"plugins-remove-button",borderRadius:"lg"}))))}function ol(e){var n=d((function(e){return e.plugin.plugins})),i=r(dc),o=ln().t,a=r(ua),s=a.sessionConfig;a.meeting;var c=(null==s?void 0:s.permissions.plugins)||{can_close:!1,can_start:!0},l=d((function(e){return e.consumers.activeConsumers})).filter((function(e){return"video"===e.kind&&e.appData.screenShare})).length,u=d((function(e){return e.participant.sharingScreen})),p=1===l||u,m=function(e){var t;return(null===(t=s.permissions.plugins.config[e])||void 0===t?void 0:t.defaultAccess)||"blacklist"},f=e.openSidebarView;return t.createElement(P,{height:"100%",overflowY:"auto",className:"dyte-client-noScrollbar"},t.createElement(j,null,t.createElement(_,null,o("Plugins"))),t.createElement(un.div,{initial:{y:-20},animate:{y:0}},t.createElement(P,{paddingY:"1em",borderBottom:"1px solid",borderColor:"secondary.800"},t.createElement(ee,{marginTop:"0.5em",marginBottom:"1em",fontSize:"1.2em",fontWeight:600,color:"text.300"},o("Active Plugin")),t.createElement(dn,{exitBeforeEnter:!0},0===n.length?t.createElement(un.div,{variants:nl,initial:"hiddenNoPlugin",animate:"visible",exit:"exitNoPlugin",key:n.length},t.createElement(j,null,t.createElement(_,{textAlign:"center",color:"text.400",maxWidth:"160px"},o("no_active_plugin")))):n.map((function(e){return t.createElement(rl,{plugin:e,key:"pluginactive",pluginPermissions:c})})))),t.createElement(P,{paddingY:"1em",borderBottom:"1px solid",borderColor:"secondary.800"},t.createElement(ee,{fontSize:"1.2em",marginTop:"0.5em",marginBottom:"1em",fontWeight:600,color:"text.300"},o("Plugin Store")),i.plugins.map((function(e){return t.createElement(il,{plugin:yn(yn({},e),{ACLType:m(e.id)}),canStart:c.can_start,activePlugins:n.length,screenSharing:p,key:e.name,openSidebarView:f})})))))}function al(e){var n=e.tab,i=e.activeTab,r=e.children;return t.createElement($,{style:{height:"100%"},in:i===n},r)}function sl(e){var n=e.activeTab,i=e.openSidebarView;d((function(e){return e.room.roomViewType}));var o=r(ua).meeting.modules.getAll().filter((function(e){return"sidebar"===e.type})),a=Sn(Sn([],Object.keys(tl).slice(0,-1),!0),o.map((function(e){return e.sidebarComponent.name})),!0);return t.createElement(P,{h:"100%"},t.createElement(Se,{h:"100%",index:a.indexOf(n),isLazy:!0},t.createElement(_e,{h:"100%"},t.createElement(ke,{h:"100%",p:"1em 0.7em"},t.createElement(al,{activeTab:n,tab:tl.Chat},t.createElement(Xc,{openSidebarView:i,active:n===tl.Chat}))),t.createElement(ke,{h:"100%",p:"1em 0.7em"},t.createElement(al,{activeTab:n,tab:tl.Polls},t.createElement(Bc,{active:n===tl.Polls}))),t.createElement(ke,{h:"100%",p:"1em 0.7em"},t.createElement(al,{activeTab:n,tab:tl.Participants},t.createElement(el,null))),t.createElement(ke,{h:"100%",p:"1em 0.7em"},t.createElement(al,{activeTab:n,tab:tl.Plugins},t.createElement(ol,{openSidebarView:i}))),o.map((function(e){return t.createElement(ke,{h:"100%",p:"1em 0.7em",key:"module_"+e.sidebarComponent.name+"_sidebar"},t.createElement(al,{activeTab:n,tab:e.sidebarComponent.name},t.createElement(e.sidebarComponent.component,null)))})))))}function cl(e){var n=e.isOpen,i=e.onOpen,r=e.onClose,o=e.onVideo,s=e.onAudio,c=e.children,l=a(null);return t.createElement(Ce,{isOpen:n,onOpen:i,onClose:r,initialFocusRef:l,placement:"top",variant:"primary",isLazy:!0},t.createElement(xe,null,t.createElement(P,null,c)),t.createElement(Te,null,t.createElement(Ie,{textAlign:"center",mt:"1.5"},"Mute All"),t.createElement(Pe,null,t.createElement(L,null,t.createElement(k,{variant:"alternateDark",onClick:function(){return o()},fontSize:"1.05em",borderRadius:"lg",px:"8"},t.createElement(U,{as:It,fill:"text.100",boxSize:"6",mr:"2"}),"Video"),t.createElement(k,{variant:"alternateDark",onClick:function(){return s()},ml:3,fontSize:"1.05em",borderRadius:"lg",px:"8"},t.createElement(U,{as:Qe,fill:"text.100",boxSize:"6",mr:"2"}),"Audio")))))}il.defaultProps={activePlugins:0,screenSharing:!1},function(e){e.Chat="Chat",e.Polls="Polls",e.Participants="Participants",e.Plugins="Plugins",e.None="None"}(tl||(tl={}));var ll=function(e){return En(void 0,void 0,void 0,(function(){var t,n,i,r,o;return wn(this,(function(a){switch(a.label){case 0:return t=e.authToken,n=e.organizationId,i=e.roomName,r=e.peerId,[4,fetch(Nr.apiBase+"/v1/organizations/"+n+"/rooms/"+i+"/recording",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","dyte-tracing-id":r,Authorization:"Bearer "+t}})];case 1:if(201!==(o=a.sent()).status)throw new Error("Recording failed to start");return[2,o.json()]}}))}))},ul=function(e){return En(void 0,void 0,void 0,(function(){var t,n,i,r,o,a;return wn(this,(function(s){switch(s.label){case 0:return t=e.authToken,n=e.organizationId,i=e.roomName,r=e.recordingId,o=e.peerId,[4,fetch(Nr.apiBase+"/v1/organizations/"+n+"/rooms/"+i+"/recordings/"+r,{method:"PUT",body:JSON.stringify({recordingAction:"stop"}),headers:{Accept:"application/json","Content-Type":"application/json","dyte-tracing-id":o,Authorization:"Bearer "+t}})];case 1:if(201!==(a=s.sent()).status)throw new Error("Recording failed to stop");return[2,a.json()]}}))}))},dl=function(e){return En(void 0,void 0,void 0,(function(){var t,n,i,r;return wn(this,(function(o){switch(o.label){case 0:return t=e.authToken,n=e.organizationId,i=e.roomName,r=e.peerId,[4,fetch(Nr.apiBase+"/v1/organizations/"+n+"/rooms/"+i+"/active-recording?limit=50",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","dyte-tracing-id":r,Authorization:"Bearer "+t}})];case 1:return[2,o.sent().json()]}}))}))},pl=function(e){var o=e.isMobile,a=n(null),s=a[0],c=a[1],l=n("NOT_INIT"),u=l[0],p=l[1],m=d((function(e){return e.peers.recordingPeer})),f=d((function(e){return e.participant.authToken})),h=d((function(e){return e.room.roomName})),g=r(ua).meeting,v=d((function(e){return e.participant.organizationId}))||g.connectionConfig.clientId,y=d((function(e){return e.participant.peerId})),b=function(e,t){return En(void 0,void 0,void 0,(function(){var t,n,i,r,o,a,s;return wn(this,(function(l){switch(l.label){case 0:return[4,dl(e)];case 1:if(t=l.sent(),0===(null===(o=t.data)||void 0===o?void 0:o.total))p("NOT_STARTED"),c(null);else switch(i=void 0,(null===(a=t.data)||void 0===a?void 0:a.recording)?(n=t.data.recording.status,i=t.data.recording.id):(null===(s=t.data)||void 0===s?void 0:s.total)>0&&(r=t.data.recordings.sort((function(e,t){return e.invokedTime>t.invokedTime?-1:e.invokedTime<t.invokedTime?1:0}))[0],n=r.status,i=r.id),n){case"UPLOADING":p("STOPPING");break;case"UPLOADED":p("NOT_STARTED");break;case"INVOKED":p("STARTING"),c(i);break;case"RECORDING":p("RECORDING"),c(i);break;default:p("NOT_STARTED"),c(null)}return[2]}}))}))};i((function(){f&&h&&v&&"NOT_INIT"===u&&b({authToken:f,roomName:h,organizationId:v,peerId:y})}),[f,h,v,s]),i((function(){"STARTING"===u&&m?p("RECORDING"):"STOPPING"!==u||m?b({authToken:f,peerId:y,organizationId:v,roomName:h}):p("NOT_STARTED")}),[m]);var E="STARTING"===u||"STOPPING"===u||"NOT_INIT"===u,w=o?Is:Mc;return t.createElement(w,{disabled:E,onClick:function(){return En(void 0,void 0,void 0,(function(){var e,t,n,i,r;return wn(this,(function(o){switch(o.label){case 0:if(e={authToken:f,roomName:h,organizationId:v,peerId:y},!s)return[3,5];p("STOPPING"),e.recordingId=s,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,ul(e)];case 2:return o.sent(),c(null),[3,4];case 3:return o.sent(),p("RECORDING"),[3,4];case 4:return[3,9];case 5:p("STARTING"),o.label=6;case 6:return o.trys.push([6,8,,9]),[4,ll(e)];case 7:return t=o.sent(),n=null===(r=null===(i=t.data)||void 0===i?void 0:i.recording)||void 0===r?void 0:r.id,c(n),[3,9];case 8:return o.sent(),p("NOT_STARTED"),[3,9];case 9:return[2]}}))}))},icon:function(){switch(u){case"NOT_STARTED":return t.createElement(U,{as:ft,fill:"danger.500"});case"RECORDING":return t.createElement(U,{as:ft,fill:"text.400"});case"STARTING":case"STOPPING":case"NOT_INIT":default:return t.createElement(S,{size:"sm"})}}(),label:function(){switch(u){case"NOT_INIT":return"Loading";case"NOT_STARTED":return"Record";case"RECORDING":return"Stop Record";case"STARTING":return"Starting";case"STOPPING":return"Stopping";default:return"Loading"}}()})},ml=e.forwardRef((function(t,n){return e.createElement(Ut,yn({iconAttrs:{fill:"none",width:24,height:24},iconVerticalAlign:"middle",iconViewBox:"0 0 24 24"},t,{ref:n}),e.createElement("path",{d:"M3 3h18c1.1 0 2 .9 2 2l-.01 12c0 1.1-.89 2-1.99 2h-2v-2h1c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h1v2H3c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2z"}),e.createElement("path",{d:"M11.293 9.293a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L13 12.414V22a1 1 0 11-2 0v-9.586l-2.293 2.293a1 1 0 01-1.414-1.414l4-4z"}))}));ml.displayName="JoinStageIcon";var fl=e.forwardRef((function(t,n){return e.createElement(Ut,yn({iconAttrs:{fill:"none",width:24,height:24},iconVerticalAlign:"middle",iconViewBox:"0 0 24 24"},t,{ref:n}),e.createElement("path",{d:"M3 3h18c1.1 0 2 .9 2 2l-.01 12c0 1.1-.89 2-1.99 2h-2v-2h1c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h1v2H3c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2z"}),e.createElement("path",{d:"M11.293 22.707a1 1 0 001.414 0l4-4a1 1 0 00-1.414-1.414L13 19.586V10a1 1 0 10-2 0v9.586l-2.293-2.293a1 1 0 00-1.414 1.414l4 4z"}))}));fl.displayName="LeaveStageIcon";var hl=e.forwardRef((function(t,n){return e.createElement(Ut,yn({iconAttrs:{fill:"currentColor"},iconVerticalAlign:"middle",iconViewBox:"0 0 24 24"},t,{ref:n}),e.createElement("path",{d:"M10.8 10.2V3.3a.9.9 0 111.8 0v6.9a.6.6 0 001.2 0V4.5a.9.9 0 111.8 0v7.8c.795-.511 1.671-.9 2.4-.9 1.166 0 2.146.389 2.382 1.338.014.058.019.117.019.175 0 .18-.085.35-.23.459l-1.574 1.181c-1.275.956-2.476 2.239-3.314 3.587-.453.729-.861 1.483-1.264 2.241-.432.813-.706 1.219-2.018 1.219H8.346c-1.145 0-1.58-.64-2.345-2.4-.765-1.76-1.2-3.533-1.2-4.2V6.3a.9.9 0 011.8 0v4.5a.6.6 0 101.2 0V4.5a.9.9 0 011.8 0v5.7a.6.6 0 101.2 0z"}))}));hl.displayName="RaiseHandIcon";var gl=function(e){var n=e.button,i=e.pluginService;return"popover"===n.type?t.createElement(Ce,{placement:"top",variant:"primary",key:n.label},t.createElement(xe,null,t.createElement(k,{variant:"controls",width:{base:"auto",sm:"auto"},minW:"74px",px:"2",pb:"2",pt:"3",height:{base:"40px",sm:"64px"},borderRadius:8},t.createElement(w,null,t.createElement(j,{fontSize:{base:"sm",sm:"xl"}},n.icon),t.createElement(_,{fontSize:"xs",marginTop:"0.25em !important",display:{base:"none",sm:"block"}},n.label)))),t.createElement(Te,{variant:"controls"},t.createElement(De,{bg:"secondary.800",boxShadow:"none !important"}),t.createElement(Ne,{color:"text.100"}),t.createElement("iframe",{src:n.url,className:"dyte-iframe",title:"Plugin content",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",ref:function(e){i.pluginManager.addIframeView(n.viewFrame,e)}}))):t.createElement(Mc,{onClick:n.onClick,icon:n.icon,label:n.label,key:n.label})},vl=t.memo((function(e){var o,a,s,c,l,p,m,f,h,g,v,b,E,w,S=e.leaveCall,_=e.copyLink,C=e.sidebarView,x=e.isSidebarOpen,T=e.openSidebarView,I=e.linkCopied,A=e.isMobile,O=r(Ks).mediaRoom,D=M(),N=D.isOpen,R=D.onOpen,z=D.onClose,j=r(Ws).allMuted,B="danger.500",F="text.300",V=r(Ka),W=V.mediaTracks,q=W.screenShareTracks,H=W.setScreenShareTracks,G=V.inputDevices,J=G.toggleAudioState,Y=G.toggleVideoState,K=G.audioInputDevices,Z=G.videoInputDevices,Q=G.speakerOutputDevices,X=G.onAudioInputChange,$=G.onVideoInputChange,ee=G.onSpeakerOutputChange,te=V.isAudioTrackSilent,ie=V.audioPermission,re=V.videoPermission,oe=V.screensharePermission,ae=V.setScreensharePermission,se=V.permissionModal.onOpen,ce=V.screensharePermissionModal.onOpen,le=r(ua),ue=le.meeting,de=le.sessionConfig,pe=Hi(),me=(null===(o=de.theme)||void 0===o?void 0:o.dimensions)||pe,fe=me.height,he=me.width,ge=uo()&&he>fe,ve=d((function(e){return e.room.roomViewType})),ye=d((function(e){return e.participant.requestToJoinType})),be=d((function(e){return e.consumers.activeConsumers})),Ee=d((function(e){return e.participant.audioMuted})),we=d((function(e){return e.participant.videoOff})),Se=d((function(e){return e.participant.videoTrackSelection})),_e=d((function(e){return e.participant.audioTrackSelection})),ke=d((function(e){return e.participant.speakerTrackSelection})),Ce=d((function(e){return e.plugin.plugins})),xe=d((function(e){return e.participant.sharingScreen})),Te=d((function(e){return e.participant.webinarHiddenParticipant}))&&ve===Mi.webinar;d((function(e){return e.participant.audioProduction})),d((function(e){return e.participant.videoProduction}));var Ie=d((function(e){return e.participant.presentingState})),Pe=d((function(e){return e.room.chatMessages})),De=d((function(e){return e.room.requestToJoinPeersList})),Ne=d((function(e){return e.room.gridView})),Re=d((function(e){return e.participant.id})),Me=Pe.filter((function(e){return!0!==e.read&&e.type!==Tc.poll&&e.userId!==Re})),ze=De.filter((function(e){return!0!==e.seen})),Le=Pe.filter((function(e){return!0!==e.read&&e.type===Tc.poll})),je=d((function(e){return e.participant.requestToJoinStageState})),Be=document.getElementsByClassName("dyte-client-root")[0],Fe=n(!1),Ve=Fe[0],We=Fe[1],Ue=yo().osName,qe=ue.modules.getAll(),He=d((function(e){return e.plugin.controlbar})),Ge=n([]),Je=Ge[0],Ye=Ge[1],Ze=n([]),et=Ze[0],tt=Ze[1],nt=de.theme.control_bar.elements,it=d((function(e){return e.room.pipMode})),rt=n(!1),ot=rt[0],at=rt[1],st=ln().t;i((function(){var e=function(){return We(!!(document.fullscreenElement||document.mozFullScreenElemen||document.webkitFullscreenElement))};return document.addEventListener("fullscreenchange",e),function(){return document.removeEventListener("fullscreenchange",e)}}),[]),i((function(){ue&&(ue.controlBar._setButtons=function(e){Ye(Sn([],e,!0))})}),[ue]),i((function(){de.permissions.view_type===Mi.groupCall&&je===Ui.ACCEPTED&&qi.ask&&O.removePeerFromStage(O.peerid,Li.REQUESTED_BY_PARTICIPANT)}),[de.permissions.view_type]),i((function(){var e=Sn([],Je,!0);He&&He.forEach((function(n){e.push({type:"popover",icon:t.createElement("img",{src:n.props.icon,width:28}),label:n.props.label,position:n.props.position,url:n.url,onClick:function(){},viewFrame:n})})),tt(e)}),[Je,He]);var ct=n(!1),ut=ct[0],dt=ct[1],pt=n(!1),mt=pt[0],ft=pt[1],vt=u(),yt=r(dc),bt=de.permissions.produce,Et=bt.audio,wt=bt.video.allow,_t=be.filter((function(e){return"video"===e.kind&&e.appData.screenShare})).length<(de.permissions.max_screenshare_count||1);i((function(){if(1===Me.length&&C!==tl.Chat&&!ut){var e=new Audio("https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_message.mp3");e.volume=.2;var t=e.play();null==t||t.catch((function(e){la.warn("notif_play_failed_2",e)})),setTimeout((function(){return dt(!1)}),2e3),dt(!0)}}),[Me.length]),i((function(){!A&&mt&&ft(!1)}),[A]);var kt={containerRef:{current:document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")}},Ct=A?Is:Mc,Ft=bo()&&uo()?null:nt.fullscreen&&t.createElement(Ct,{onClick:function(){Ve?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():Be.requestFullscreen?Be.requestFullscreen():Be.mozRequestFullScreen?Be.mozRequestFullScreen():Be.webkitRequestFullscreen?Be.webkitRequestFullscreen():Be.msRequestFullscreen&&Be.msRequestFullscreen()},icon:Ve?t.createElement(U,{as:Pt,fill:F}):t.createElement(U,{as:Xe,fill:F}),label:st(Ve?"Exit":"Full Screen"),dataCy:"control-bar-fullscreen-button"}),Vt=(null===(c=null===(s=null===(a=de.permissions)||void 0===a?void 0:a.produce)||void 0===s?void 0:s.screenshare)||void 0===c?void 0:c.allow)&&nt.screenshare&&ye!==qi.ask&&t.createElement(ne,{textAlign:"center",label:0!==Ce.length?"Disable the active plugin to screen share.":_t?xe?"Stop sharing screen":"Share your screen":"Someone else is already screen sharing",openDelay:200,placement:"top",maxW:40,portalProps:kt},t.createElement("span",null,t.createElement(Ct,{onClick:function(){return En(void 0,void 0,void 0,(function(){var e,t;return wn(this,(function(n){switch(n.label){case 0:if(xe||!_t||oe===qa.SYS_DENIED)return[3,5];void 0!==(null==q?void 0:q.video)&&(null==q||q.video.stop()),void 0!==(null==q?void 0:q.audio)&&(null==q||q.audio.stop()),n.label=1;case 1:return n.trys.push([1,3,,4]),wa.screenShareRequested(),[4,Ca()];case 2:return e=n.sent(),H({video:e.video,audio:e.audio}),[3,4];case 3:return(t=n.sent())instanceof DOMException&&po()&&"NotAllowedError"===t.name&&"Permission denied by system"===t.message?(la.error("error_screensharing",t.name),ae(qa.SYS_DENIED)):la.error("error_screensharing",t),[3,4];case 4:return[3,6];case 5:oe===qa.SYS_DENIED?ce():(O.disableScreenShare(),H(void 0)),n.label=6;case 6:return[2]}}))}))},icon:xe?t.createElement(U,{as:lt,fill:"danger.500"}):t.createElement(U,{as:$e,fill:F}),disabled:!(xe||0===Ce.length&&_t),label:st(xe?"Stop Sharing":"Share Screen"),dataCy:"control-bar-share-screen-button"}))),Wt=nt.layout&&t.createElement(Ct,{onClick:function(){return En(void 0,void 0,void 0,(function(){return wn(this,(function(e){return vt(wi("multi"===Ne?"highlighted":"multi")),[2]}))}))},icon:"multi"===Ne?t.createElement(U,{as:At,fill:F}):t.createElement(U,{as:Ot,fill:F}),label:st("Layout"),dataCy:"control-bar-layout-button"}),Ut=nt.chat&&t.createElement(Ct,{onClick:function(){return T(tl.Chat)},isActive:x&&C===tl.Chat,icon:t.createElement(U,{as:Dt,fill:F}),badge:0===Me.length?"":Me.length.toString(),label:st("Chat"),dataCy:"control-bar-chat-button"}),qt=nt.polls&&t.createElement(Ct,{onClick:function(){return T(tl.Polls)},isActive:x&&C===tl.Polls,badge:0===Le.length?"":Le.length.toString(),icon:t.createElement(U,{as:St,fill:F}),label:st("Polls"),dataCy:"control-bar-polls-button"}),Ht=nt.participants&&t.createElement(Ct,{onClick:function(){return T(tl.Participants)},isActive:x&&C===tl.Participants,icon:t.createElement(U,{as:Nt,fill:F}),label:st("Participants"),badge:0===ze.length?"":ze.length.toString(),dataCy:"control-bar-participants-button"}),Gt=nt.plugins&&t.createElement(Ct,{onClick:function(){return T(tl.Plugins)},isActive:x&&C===tl.Plugins,icon:t.createElement(U,{as:no,fill:"primary.500"}),label:"cecf293a-dd7f-4490-9464-7bb3d2a14249"===(null===(l=null==ue?void 0:ue.connectionConfig)||void 0===l?void 0:l.clientId)||"52fea1ae-f0ab-4599-af32-da1776f4e7b7"===(null===(p=null==ue?void 0:ue.connectionConfig)||void 0===p?void 0:p.clientId)?"Teach":st("Plugins"),variant:"alternateDefault"}),Jt={TOGGLE_MIC:["⌘+shift+m","ctrl+shift+m"],TOGGLE_VIDEO:["⌘+shift+v","ctrl+shift+v"]},Yt=function(e){e.preventDefault(),J()},Kt=function(e){e.preventDefault(),Y()};i((function(){return mn(Jt.TOGGLE_MIC.join(","),Yt),mn(Jt.TOGGLE_VIDEO.join(","),Kt),function(){mn.unbind(Jt.TOGGLE_MIC.join(",")),mn.unbind(Jt.TOGGLE_VIDEO.join(","))}}),[J,Y]);var Zt=function(e,t,n){var i="";return t===qa.DENIED?i=e+" permission denied.":0===n.length?i="No "+e+" devices found.":t===qa.FAILED?i="Error occured in getting "+e+".":"Microphone"===e&&!Ee&&te&&(i="We are unable to hear you. Please select a different device instead."),i},Qt=he<480,Xt=Qt?42:72,$t="a446c4de-979e-4d4f-97f7-2b695e75ef90"===ue.connectionConfig.clientId?"Go Live":st("Present"),en=Xt+"px";(document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")).style.setProperty("--dyte-controlbar-height",en);var tn=A&&(nt.chat||nt.participants||nt.polls||nt.screenshare||nt.layout||nt.screenshare||et.length>0);return t.createElement(P,{className:"dyte-client-noSelect",height:en,width:"100%",bg:"secondary.1000",style:{position:"absolute",bottom:Qt?"4px":"0px"},py:1},t.createElement(L,{direction:"column",borderRadius:4},t.createElement(L,{justify:"center"},t.createElement(L,{position:"absolute",left:"2"},A||t.createElement(t.Fragment,null,Ft,nt.invite&&t.createElement(Mc,{onClick:_,icon:I?t.createElement(U,{as:Ke,fill:"success.500"}):t.createElement(U,{as:Rt,fill:F}),label:st(I?"Link Copied":"Invite"),dataCy:"control-bar-invite-button"}),!Te&&Vt,Wt,(null===(m=de.permissions)||void 0===m?void 0:m.can_record)&&t.createElement(pl,{isMobile:!1}),et.filter((function(e){return"left"===e.position})).map((function(e){return t.createElement(gl,{button:e,pluginService:yt})})))),t.createElement(L,{width:he>480?"auto":"100%",pl:"2",pr:"4",justifyContent:"space-between"},ve===Mi.webinar&&((null===(f=de.permissions)||void 0===f?void 0:f.can_present)||(null===(h=de.permissions)||void 0===h?void 0:h.request_produce)&&je===Ui.ACCEPTED&&Ie===Wi.NOT_PRESENTING)&&t.createElement(t.Fragment,null,t.createElement(Mc,{onClick:function(){Te?vt(kr()):at(!0)},icon:t.createElement(U,{as:Te?ml:fl,fill:Te?F:B}),label:Te?$t:st("Stop"),disableHoverEffect:!0}),t.createElement(Cs,{isOpen:ot,onClose:function(){at(!1)},hasBorder:!1},t.createElement(Ae,{pt:"6"},st("leave_stage_header")),t.createElement(Oe,{px:"4",pb:"4",justifyContent:"center"},t.createElement(k,{py:"2",flex:"1",variant:"danger",mr:"2",onClick:function(){O.stopPresenting(),at(!1)}},"Yes"),t.createElement(k,{py:"2",flex:"1",variant:"solidDark",onClick:function(){return at(!1)}},"No")))),(null===(g=de.permissions)||void 0===g?void 0:g.request_produce)&&t.createElement(Mc,{onClick:function(){return e=qi.present,void(je===Ui.ACCEPTED?O.removePeerFromStage(O.peerid,Li.REQUESTED_BY_PARTICIPANT):(vt(Er(Ui.INITIATED)),vt(wr(e))));var e},icon:t.createElement(U,{as:je===Ui.ACCEPTED?fl:hl,fill:je===Ui.ACCEPTED?B:F}),disabled:je===Ui.WAITING,label:je===Ui.ACCEPTED?st("Drop"):st("Request"),ariaLabel:je===Ui.ACCEPTED?"Drop":"Request",disableHoverEffect:!0}),!A&&(null===(v=de.permissions)||void 0===v?void 0:v.can_allow_participant_audio)&&t.createElement(cl,{isOpen:N,onOpen:R,onClose:z,onAudio:function(){O.muteAll(!0),z()},onVideo:function(){O.muteAllVideo(),z()}},t.createElement(Mc,{onClick:function(){},icon:t.createElement(U,{as:Mt,fill:F}),label:st("Mute All")})),!Te&&t.createElement(t.Fragment,null,Et&&t.createElement(ne,{textAlign:"center",label:Zt("Microphone",ie,K)||!uo()&&("macOS"===Ue?"Toggle Mic (⌘ + Shift + M)":"Toggle Mic (Ctrl + Shift + M)"),openDelay:300,placement:"top",maxW:"60",portalProps:kt,isOpen:!(Ee||!te)||void 0},t.createElement("span",null,t.createElement(Mc,{disabled:ie===qa.INIT||ie===qa.FAILED||ie===qa.NOT_APPLICABLE,onClick:ie!==qa.ACCEPTED?se:J,icon:Ee||ie===qa.INIT?t.createElement(U,{as:Qe,fill:B}):t.createElement(U,{as:xt,fill:F}),label:st(Ee?"Mic Off":"Mic On"),dataCy:"control-bar-toggle-audio-button",ariaLabel:"mute-toggle",permissionWarning:ie===qa.DENIED||ie===qa.SYS_DENIED,menu:(K.length>0?[{title:st("Input Microphone Device"),options:K.map((function(e,t){return{children:e.label||"Input "+(t+1),key:e.deviceId||y(),value:e.deviceId}})),defaultValue:null==_e?void 0:_e.selectedDeviceId,onChange:X}]:[]).concat(0===Q.length?[]:[{title:st("Output Speaker Device"),options:Q.map((function(e,t){return{children:e.label||"Output "+(t+1),key:e.deviceId||y(),value:e.deviceId}})),defaultValue:null==ke?void 0:ke.selectedDeviceId,onChange:ee}]),disableHoverEffect:!0}))),wt&&t.createElement(ne,{textAlign:"center",label:Zt("Camera",re,Z)||!uo()&&("macOS"===Ue?"Toggle Video (⌘ + Shift + V)":"Toggle Video (Ctrl + Shift + V)"),openDelay:300,placement:"top",maxW:60,portalProps:kt},t.createElement("span",null,t.createElement(Mc,{disabled:re===qa.INIT||re===qa.FAILED||re===qa.NOT_APPLICABLE,onClick:re!==qa.ACCEPTED?se:Y,icon:we||re===qa.INIT?t.createElement(U,{as:It,fill:B}):t.createElement(U,{as:Tt,fill:F}),permissionWarning:re===qa.DENIED||re===qa.SYS_DENIED,label:st(we?"Video Off":"Video On"),ariaLabel:"camera-toggle",dataCy:"control-bar-toggle-video-button",menu:Z.length>0?[{title:st("Camera Device"),options:Z.map((function(e,n){return{children:t.createElement(t.Fragment,null,e.label||"Camera "+(n+1)),key:e.deviceId||y(),value:e.deviceId}})),defaultValue:null==Se?void 0:Se.selectedDeviceId,onChange:$}]:[],disableHoverEffect:!0})))),t.createElement(Mc,{onClick:S,icon:t.createElement(U,{as:zt,fill:B}),label:st("Leave"),disableHoverEffect:!0,dataCy:"control-bar-leave-button"}),!A&&et.filter((function(e){return"center"===e.position})).map((function(e){return t.createElement(gl,{button:e,pluginService:yt})})),tn&&t.createElement(Mc,{onClick:function(){ft(!mt)},icon:t.createElement(U,{transform:ge?"rotate(-90deg)":"",as:mt?Lt:jt,fill:F}),badge:Me.length+Le.length===0?"":(Me.length+Le.length).toString(),variant:"primaryDefault",label:st("More")})),t.createElement(L,{position:"absolute",right:"2"},A||t.createElement(t.Fragment,null,et.filter((function(e){return"right"===e.position})).map((function(e){return t.createElement(gl,{button:e,pluginService:yt})})),qe.map((function(e){return!e.hidden&&t.createElement(Mc,{key:"module_"+e.sidebarComponent.name+"_button",onClick:function(){return T(e.sidebarComponent.name)},isActive:x&&C===e.sidebarComponent.name,icon:e.icon,label:e.sidebarComponent.name})})),Ut,qt,Ht,Gt))),t.createElement(L,{justify:"center"},A&&mt&&t.createElement(Ts,{close:function(){return ft(!1)}},t.createElement(Cs,{isOpen:!0,onClose:function(){return ft(!1)},small:!0},t.createElement(t.Fragment,null,(null===(b=de.permissions)||void 0===b?void 0:b.can_allow_participant_audio)&&t.createElement(Ct,{onClick:function(){return O.muteAll(!0)},icon:t.createElement(U,{as:Bt,fill:F}),disabled:j,label:st(j?"All Muted":"Mute All"),dataCy:"control-bar-mute-all-button"}),Ft,Wt,(null===(E=de.permissions)||void 0===E?void 0:E.can_record)&&t.createElement(pl,{isMobile:!0}),uo()||Te?null:Vt,Ut,qt,Ht,qe.map((function(e){return!e.hidden&&t.createElement(Ct,{key:"module_"+e.sidebarComponent.name+"_button",onClick:function(){return T(e.sidebarComponent.name)},icon:e.icon,label:e.sidebarComponent.name})})),Gt,vo()&&(null===(w=de.theme.controls)||void 0===w?void 0:w.pip_toggle)&&t.createElement(Ct,{onClick:function(){return vt(Kn(!it))},icon:it?t.createElement(ht,{size:"1.5em"}):t.createElement(gt,{size:"1.5em"}),label:st(it?"Disable PIP":"Enable PIP"),dataCy:"control-bar-pip-button"}),et.map((function(e){return"popover"===e.type?t.createElement(gl,{button:e,pluginService:yt}):t.createElement(Ct,{onClick:e.onClick,icon:e.icon,label:e.label,key:e.label})}))))))))}));function yl(){var e=r(Ks).mediaRoom,n=u(),i=d((function(e){return e.room.waitlistedPeers}));i.length;return 0===i.length?null:t.createElement(D,{isOpen:!0,onClose:function(){},portalProps:{containerRef:{current:document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")}}},t.createElement(N,null),t.createElement(R,{borderRadius:"8px",className:"dyte-client-noSelect",color:"text.100",bg:"secondary.900"},t.createElement(Ae,null,"Waiting Requests"),t.createElement(Q,null,t.createElement(w,{spacing:6,height:"80"},i.map((function(i){return t.createElement(L,{direction:"row",alignItems:"center"},t.createElement(Xs,{size:"sm",name:i.name}),t.createElement(L,{marginLeft:3,flexGrow:1,alignItems:"center",paddingY:2,borderBottom:"1px solid",borderColor:"secondary.800"},t.createElement(_,{color:"text.200",fontSize:"lg"},i.name),t.createElement(L,{marginLeft:"auto"},t.createElement(W,{variant:"solidDarker",color:"danger.500",size:"md","aria-label":"reject",icon:t.createElement(U,{boxSize:"6",as:at}),_hover:{borderColor:"var(--chakra-colors-danger-500)"},onClick:function(){return t=i.id,n(yi({id:t})),void e.rejectWaitingRequest(t);var t}}),t.createElement(W,{variant:"solidDarker",color:"primary.300",size:"md","aria-label":"accept",p:1,icon:t.createElement(U,{boxSize:"6",as:Ke}),_hover:{borderColor:"var(--chakra-colors-primary-500)"},onClick:function(){return t=i.id,n(yi({id:t})),void e.acceptWaitingRequest(t);var t},ml:2}))))}))))))}var bl=function(e){return"recorder@dyte.in"!==e&&("undefined"==typeof window||!window.location.href.includes("DYTE_BOT"))},El=new(function(){function e(){this.errorCallback=null,this.device={id:null,set:!1}}return e.prototype.init=function(){this.audio=document.createElement("audio"),this.audio.autoplay=!0,this.audioStream=new MediaStream,this.audio.srcObject=this.audioStream,this.audioTracks=[]},e.prototype.onError=function(e){this.errorCallback=e},e.prototype.addPeer=function(e){var t=e.audioTrack;null!=t&&(this.audioTracks.some((function(e){return e.id===t.id}))||(this.audioStream.addTrack(t),this.audioTracks.push(t),this.play()))},e.prototype.removePeer=function(e){var t=e.audioTrack;null!=t&&(this.audioStream.removeTrack(t),this.audioTracks=this.audioTracks.filter((function(e){return e.id!==t.id})))},e.prototype.cleanup=function(e){var t=this;this.audioTracks.filter((function(t){return!e.includes(t.id)})).forEach((function(e){t.audioStream.removeTrack(e)})),this.audioTracks=this.audioTracks.filter((function(t){return e.includes(t.id)}))},e.prototype.play=function(){var e,t;return En(this,void 0,void 0,(function(){var n,i=this;return wn(this,(function(r){switch(r.label){case 0:return this.audio.srcObject=this.audioStream,n=this.audio,!this.device.id||this.device.set?[3,2]:[4,null===(e=n.setSinkId)||void 0===e?void 0:e.call(n,this.device.id)];case 1:r.sent(),this.device.set=!0,r.label=2;case 2:return null===(t=this.audio.play())||void 0===t||t.catch((function(e){"NotAllowedError"===e.name&&i.errorCallback&&i.errorCallback(),la.warn("audio_play_failed",e),wa.mediaPlaybackFailed("AUDIO")})),[2]}}))}))},e.prototype.setDeviceId=function(e){this.device={id:e,set:!1}},e}()),wl=function(e){return e.isMe?null:e.audioMuted||null==e.audioTrack?(El.removePeer(e),null):(El.addPeer(e),e.audioTrack.id)};function Sl(){var e=a(document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")),o=d((function(e){return e.participant.email})),s=n("playing"),c=s[0],l=s[1],u=d((function(e){return e.participant.speakerTrackSelection})),p=r(Ws),m=p.joinedProcessedPeers,f=p.screenSharePeers,h=m.concat(f);return i((function(){El.init(),El.play(),El.onError((function(){l("aborted")}))}),[]),i((function(){var e=h.map(wl);El.cleanup(e)}),[h]),i((function(){(null==u?void 0:u.selectedDeviceId)&&El.setDeviceId(u.selectedDeviceId)}),[null==u?void 0:u.selectedDeviceId]),t.createElement(t.Fragment,null,t.createElement(D,{isOpen:"aborted"===c&&bl(o),onClose:function(){},portalProps:{containerRef:e},variant:"primary",isCentered:!0},t.createElement(N,{bg:"secondary.900"}),t.createElement(R,{background:"secondary.1000",w:"90%",maxW:"360px",px:"4",py:"6",color:"text.100"},t.createElement(_,{fontSize:"2xl",fontWeight:"bold"},"Allow Audio Playback"),t.createElement(_,{my:"4"},"In order to play audio properly on your device, click the button below"),t.createElement(k,{mt:"2",py:"2",variant:"solid",fontWeight:"semibold",onClick:function(){El.play(),l("playing")}},t.createElement(Ft,{size:"2em"}),"Play Audio"))))}function _l(e){var n=e.isMobile,i=d((function(e){return e.room.roomViewType})),o=d((function(e){return e.participant.requestToJoinStageState})),a=d((function(e){return e.participant.requestToJoinType})),s=r(Ks).mediaRoom,c=u(),l=i===Mi.webinar&&o===Ui.INITIATED;return t.createElement(D,{isOpen:l,onClose:function(){},size:"lg",portalProps:{containerRef:{current:document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")}}},t.createElement(N,{bg:"primary.400",opacity:".4"}),t.createElement(R,{borderRadius:"8px",className:"dyte-client-noSelect",color:"text.100",bg:"secondary.1000"},t.createElement(Ae,{paddingBottom:".5em",textAlign:"center"},a===qi.ask&&"Request to Ask",a===qi.present&&"Request to Present"),t.createElement(Q,{paddingBottom:"2.5em"},t.createElement(L,{direction:n?"column":"row",justifyContent:"space-between"},t.createElement(k,{width:n?"100%":"48%",my:"0.5em",py:"0.25em",variant:"danger",fontWeight:"600",size:"md",onClick:function(){c(Er(Ui.NONE)),c(wr(void 0))},"aria-label":"cancel-present-request"},"Cancel"),t.createElement(k,{width:n?"100%":"48%",my:"0.5em",py:"0.4em",size:"md",fontSize:"md",onClick:function(){c(Er(Ui.WAITING)),s.requestToJoinStage(a),Di({title:"Requested successfully",status:"success",duration:5e3,isClosable:!0,position:"top"})},"aria-label":"confirm-present-request"},"Confirm & Request")))))}var kl=function(e){var n=e.isMobile,i=r(Ws),o=i.joinedProcessedPeers,a=i.selfPeer,s=o.concat([a]).filter((function(e){return!e.webinarHiddenParticipant&&e.requestToJoinType===qi.ask}));return t.createElement(L,{direction:"row",position:"absolute",zIndex:"3",padding:"20px 12px 20px 20px",alignItems:"flex-end",justifyContent:"flex-end",bottom:"64px",right:"64px"},s.map((function(e){return t.createElement(P,{key:e.id,zIndex:3},t.createElement(tc,{peer:e,height:n?"80px":"120px",width:n?"130px":"200px",pipMode:!0}))})))};function Cl(e){var n=e.deviceName,i=e.value,r=e.onChange,o=e.inputDevices,a=e.showLabel,s=ln().t,c=null,l="";return n.includes(s("Camera"))&&(c=Tt,l="Camera"),n.includes(s("Microphone"))&&(c=xt,l="Input"),n.includes(s("Speaker"))&&(c=Vt,l="Output"),t.createElement(P,{zIndex:10},t.createElement(ue,null,(function(e){var s=e.isOpen;return t.createElement(t.Fragment,null,t.createElement(de,{fontSize:"sm",as:k,size:"sm",variant:"",color:"text.400",isActive:s,iconSpacing:"0.5em",rightIcon:t.createElement(U,{as:s?jt:Lt,fill:"text.400",boxSize:a?5:8}),leftIcon:t.createElement(U,{as:c,fill:"text.400",boxSize:a?5:8})},a&&n),t.createElement(pe,{fontSize:"sm"},t.createElement(fe,{value:i,onChange:r},o.map((function(e,n){return t.createElement(he,{key:e.deviceId,value:e.deviceId,iconSpacing:"1em"},e.label||l+" "+(n+1))})))))})))}kl.defaultProps={isMobile:!1};var xl=l((function(e){if("macOS"===so().getOSName())return null;var n=mo();if(!n&&po()||n&&bo())return null;return t.createElement(Re,{className:"permission-denied-alert",status:"warning",my:"1em",borderRadius:"md",width:"fit-content"},t.createElement(Me,null),t.createElement(L,{flexDirection:"column"},e.height>400&&e.width<800&&t.createElement(ze,{color:"secondary.900"},function(){var e=yo();return"It looks like you are using "+e.browserName+" on "+e.osName}()),t.createElement(Le,{color:"secondary.900"},"For the best experience, switch to"," ",n?"Safari":"Google Chrome")))}));function Tl(e){var n,o=e.children,a=e.scroll,s=e.shouldSetupStreams,c=e.showBrowserWarnings,l=e.maxWidth,u=e.height,p=r(ua).sessionConfig,m=Hi(),f=((null===(n=p.theme)||void 0===n?void 0:n.dimensions)||m).width,h=ln().t,g=Math.floor(3*f/9);f<1024&&f>768?g=Math.floor(4*f/9):f<768&&(g=Math.floor(7*f/9)),l&&g>l&&(g=l);var v=Math.floor(9*g/16);u<600&&f>460&&f<768&&(v=Math.floor(3*u/8),g=Math.floor(7*v/4)),u<400&&f>460&&f<768&&(v=Math.floor(4*u/8),g=Math.floor(8*v/4));var y=d((function(e){return e.participant.id})),b=d((function(e){return e.participant.videoOff})),E=d((function(e){return e.participant.audioMuted})),w=d((function(e){return e.participant.displayName})),S=d((function(e){return e.participant.device})),_=d((function(e){return e.participant.videoProduction})),x=d((function(e){return e.participant.audioProduction})),T=d((function(e){return e.participant.audioTrackSelection})),I=d((function(e){return e.participant.videoTrackSelection})),A=d((function(e){return e.participant.speakerTrackSelection})),O=r(Ka),D=O.mediaTracks,N=D.webcamTrack,R=D.audioTrack,M=O.inputDevices,z=M.audioInputDevices,j=M.videoInputDevices,B=M.speakerOutputDevices,F=M.onAudioInputChange,V=M.onVideoInputChange,q=M.onSpeakerOutputChange,H=M.toggleAudioState,G=M.toggleVideoState,J=O.setupStreams,Y=O.isAudioTrackSilent,K=O.audioPermission,Z=O.videoPermission,Q=O.permissionModal.onOpen;i((function(){s&&J()}),[]);var X=p.permissions.produce,$=X.audio,ee=X.video.allow,te=function(){var e="",t="";return Z===qa.DENIED&&K===qa.DENIED?(e="Camera & Mic permissions denied. ",t="both"):Z===qa.DENIED?(e="Camera permission denied.",t="camera"):K===qa.DENIED?(e="Microphone permission denied.",t="microphone"):!ee||0!==j.length&&Z!==qa.NOTFOUND?!$||0!==z.length&&K!==qa.NOTFOUND?Z===qa.FAILED?(e="Check if any other application is using the camera.",t="camera"):K===qa.FAILED?(e="Check if any other application is using the microphone.",t="microphone"):!E&&Y&&(e="We are unable to hear you. Please select a different device instead.",t="microphone"):(e="No microphone found. Check if any other application is using the microphone.",t="microphone"):(e="No camera devices found. Check if any other application is using the camera.",t="camera"),{deviceError:t,message:e}},ie=[];f<800&&ie.push("mw800"),f<460&&ie.push("mw460"),u<600&&ie.push("mh600"),u<400&&ie.push("mh400");var re={id:y,device:S,displayName:w,audioMuted:E,videoVisible:!b,videoTrack:N,audioTrack:R,isMe:!0,metadata:null},oe=a?{overflow:"scroll",className:"dyte-client-noScrollbar"}:{},ae={TOGGLE_MIC:["cmd+shift+m","ctrl+shift+m"],TOGGLE_VIDEO:["cmd+shift+v","ctrl+shift+v"]},se=function(e){e.preventDefault(),H()},ce=function(e){e.preventDefault(),G()};i((function(){return mn(ae.TOGGLE_MIC.join(","),se),mn(ae.TOGGLE_VIDEO.join(","),ce),function(){mn.unbind(ae.TOGGLE_MIC.join(",")),mn.unbind(ae.TOGGLE_VIDEO.join(","))}}),[H,G]);var le=yo(),ue=le.isMobile,de=le.osName,pe={containerRef:{current:document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")}};return t.createElement(L,yn({flexDirection:"column",overflowY:"scroll",width:f,overflowX:"hidden",className:"dyte-client-noScrollbar"},oe),t.createElement(L,{alignItems:"center",width:"100%",className:"make-session-layout "+ie.join(" "),overflowX:"hidden",height:u,align:u<400&&f>460?"flex-start":"center",justifyContent:u<480&&f<460?"flex-start":"center"},t.createElement(P,{width:g,display:"flex",flexDirection:"column",alignItems:"center"},t.createElement(tc,{height:v,width:g,peer:re},$&&t.createElement(ne,{textAlign:"center",label:"microphone"===te().deviceError?te().message:!ue&&("macOS"===de?"Toggle Mic (⌘ + Shift + M)":"Toggle Mic (Ctrl + Shift + M)"),openDelay:800,placement:"top",maxW:60,portalProps:pe},t.createElement(W,{borderRadius:"4px",backgroundColor:"secondary.900",disabled:x===kn.NOT_APPLICABLE||K===qa.INIT,variant:"controls",size:f>460?"lg":"sm",onClick:H,icon:E||K===qa.INIT?t.createElement(U,{as:Qe,boxSize:"6",fill:"danger.500"}):t.createElement(U,{as:xt,boxSize:"6",fill:"text.200"}),"aria-label":"mute-toggle"})),ee&&t.createElement(ne,{textAlign:"center",label:"camera"===te().deviceError?te().message:!ue&&("macOS"===de?"Toggle Video (⌘ + Shift + V)":"Toggle Video (Ctrl + Shift + V)"),openDelay:800,placement:"top",maxW:60,portalProps:pe},t.createElement(W,{borderRadius:"4px",backgroundColor:"secondary.900",disabled:_===kn.NOT_APPLICABLE||Z===qa.INIT,variant:"controls",size:f>460?"lg":"sm",onClick:G,icon:b||Z===qa.INIT?t.createElement(U,{as:It,boxSize:"6",fill:"danger.500"}):t.createElement(U,{as:Tt,boxSize:"6",fill:"text.200"}),"aria-label":"camera-toggle"}))),t.createElement(L,{justify:"space-between",marginTop:"1em"},z.length>0&&$&&t.createElement(Cl,{deviceName:h("Microphone"),value:null==T?void 0:T.selectedDeviceId,onChange:F,inputDevices:z,showLabel:f>560}),j.length>0&&ee&&t.createElement(Cl,{deviceName:h("Camera"),value:null==I?void 0:I.selectedDeviceId,onChange:V,inputDevices:j,showLabel:f>560}),B.length>0&&t.createElement(Cl,{deviceName:h("Speaker"),value:null==A?void 0:A.selectedDeviceId,onChange:q,inputDevices:B,showLabel:f>560})),t.createElement(L,null,c&&K!==qa.INIT&&Z!==qa.INIT&&function(){var e=te(),n=e.deviceError,i=e.message;return""!==n?t.createElement(Re,{className:"permission-denied-alert "+ie.join(" "),status:"error",my:"1em",borderRadius:"md",color:"gray.800"},t.createElement(C,{justify:"space-between",flex:1},t.createElement(C,null,u>400&&f>800&&t.createElement(Me,null),t.createElement(Le,null,i)),t.createElement(L,{direction:"row",alignItems:"center"},(K===qa.DENIED||Z===qa.DENIED)&&u>400&&f>800?t.createElement(k,{className:"permission-denied-alert-button "+ie.join(" "),variant:"danger",onClick:Q},"Help?"):t.createElement(Me,{cursor:"pointer",onClick:Q})))):t.createElement(t.Fragment,null)}()),c&&t.createElement(xl,{height:u,width:f})),c&&t.createElement(P,{className:"make-session-spacer "+ie.join(" ")}),!!o&&t.createElement(P,{m:0,width:"fit-content"},o)))}function Il(e){var n,i,o=e.isMobile,a=d((function(e){return e.room.roomViewType})),s=d((function(e){return e.participant.presentingState})),c=r(Ks).mediaRoom,l=r(ua),p=l.meeting,m=l.sessionConfig,f=d((function(e){return e.participant.requestToJoinType})),h=u(),g=a===Mi.webinar&&s===Wi.INITIATED,v=null===(n=m.permissions)||void 0===n?void 0:n.accept_present_requests;return t.createElement(D,{isOpen:g,onClose:function(){},size:"2xl",scrollBehavior:"outside",portalProps:{containerRef:{current:document.getElementById("dyte-base-elem")||document.getElementById("dyte-shadow").shadowRoot.getElementById("dyte-base-elem")}}},t.createElement(N,{bg:"rgba(0,0,0,0.8)"}),t.createElement(R,{borderRadius:"8px",className:"dyte-client-noSelect",color:"text.100",bg:"secondary.1000"},t.createElement(Q,{py:"1em"},t.createElement(te,null,t.createElement(Tl,{shouldSetupStreams:!1,showBrowserWarnings:!1,maxWidth:500,height:300}),t.createElement(L,{direction:o?"column":"row",justifyContent:"space-between",width:"100%"},t.createElement(k,{width:o?"100%":"48%",my:"0.5em",variant:"danger",px:"2em",fontWeight:"600",size:"md",onClick:function(){var e;(null===(e=m.permissions)||void 0===e?void 0:e.accept_present_requests)?h(_r()):c.removePeerFromStage(c.peerid,Li.REQUESTED_BY_PARTICIPANT)},"aria-label":"cancel-present"},"Cancel"),t.createElement(k,{width:o?"100%":"48%",my:"0.5em",size:"md",px:"2em",fontSize:"md",onClick:function(){c.startPresenting()},"aria-label":"start-present"},(i="Join and\n\t\t"+(f===qi.present?"Present":"Ask"),v&&(i="a446c4de-979e-4d4f-97f7-2b695e75ef90"===p.connectionConfig.clientId?"Go Live":"Start Presenting"),i)))))))}Tl.defaultProps={scroll:!1,children:!1,shouldSetupStreams:!0,showBrowserWarnings:!0,maxWidth:null};var Pl=t.memo((function(e){var t=u(),n=r(ua),o=n.meeting,s=n.processPreset,c=n.sessionConfig;f().getState;var l=d((function(e){return e.room.roomViewType})),p=d((function(e){return e.participant.webinarHiddenParticipant}))&&l===$o.webinar,m=d((function(e){return e.room.initialGUMFetch})),h=d((function(e){return e.room.producersState})),g=d((function(e){return e.room.legacyMode})),v=d((function(e){return e.room.joined})),y=d((function(e){return e.participant.hidden})),b=d((function(e){return e.plugin.main})),E=d((function(e){return e.participant.preset})),w=d((function(e){return e.participant.audioMuted})),S=d((function(e){return e.peers.recordingPeer})),_=a(!1),k=r(Ks).mediaRoom,C=r(Ka).mediaTracks,x=C.audioTrack,T=C.webcamTrack,I=C.processedWebcamTrack,P=C.screenShareTracks,A=C.setScreenShareTracks,O=d((function(e){return e.consumers.activeConsumers})).filter((function(e){return"video"===e.kind&&e.appData.screenShare})).length<(c.permissions.max_screenshare_count||1);i((function(){S?(null==o||o.emit(o.Events.recordingStarted),_.current=!0):_.current&&(_.current=!1,null==o||o.emit(o.Events.recordingStopped))}),[S]),i((function(){k&&h===kn.LOADED&&En(void 0,void 0,void 0,(function(){return wn(this,(function(e){return g!==k.legacyMode&&(k.legacyMode=g,k.resetVideoProducers(T,null==P?void 0:P.video)),[2]}))}))}),[g,h]),i((function(){o.plugins.forEach((function(e,t){o.plugins[t].isActivated=!!b.find((function(t){return t.plugin===e.id}))}))}),[b.length]),i((function(){h===kn.NOT_STARTED&&v&&m&&!y&&!p?(k.hidden||(k.getMesssages(),k.getPolls()),k.hidden=!1,En(void 0,void 0,void 0,(function(){return wn(this,(function(e){switch(e.label){case 0:return t(ni(kn.CONNECTING)),I?[4,k.shareWebcam(I)]:[3,2];case 1:return e.sent(),[3,4];case 2:return T?[4,k.shareWebcam(T)]:[3,4];case 3:e.sent(),e.label=4;case 4:return x?[4,k.shareMic(x,w)]:[3,6];case 5:e.sent(),e.label=6;case 6:return P?[4,k.shareScreen(P)]:[3,8];case 7:e.sent(),e.label=8;case 8:return t(ni(kn.LOADED)),null==o||o.emit(o.Events.localMediaConnected),[2]}}))}))):p&&k.hidden!==p&&(k.hidden=!0,k.stopAllProducers(!0),t(ni(kn.NOT_STARTED)))}),[h,v,m,y,p]),i((function(){E&&s(E)}),[E]),i((function(){!O&&P?(void 0!==(null==P?void 0:P.video)&&(null==P||P.video.stop()),void 0!==(null==P?void 0:P.audio)&&(null==P||P.audio.stop()),A(void 0),Di({description:"Screensharing already started",status:"error",duration:5e3,isClosable:!0,position:"top"})):P&&k.shareScreen(P)}),[P]);var D=function(){return En(void 0,void 0,void 0,(function(){return wn(this,(function(e){return k.disableScreenShare(),A(void 0),[2]}))}))};return i((function(){var e;return null===(e=null==P?void 0:P.video)||void 0===e||e.addEventListener("ended",D),function(){var e;null===(e=null==P?void 0:P.video)||void 0===e||e.removeEventListener("ended",D)}}),[P]),null}));function Al(e){return"top"===e}function Ol(e){return"bottom"===e}function Dl(e){return"left"===e}function Nl(e){return"right"===e}function Rl(){return"undefined"!=typeof window}var Ml=function(e){function n(t){var n=e.call(this,t)||this;return n.MAX_NEGATIVE_SCROLL=20,n.SCROLL_TO_CLOSE=75,n.ALLOW_DRAWER_TRANSFORM=!0,n.getNegativeScroll=function(e){var t=n.props.direction,i=n.getElementSize();Ol(t)||Al(t)?n.NEGATIVE_SCROLL=i-e.scrollHeight-n.MAX_NEGATIVE_SCROLL:n.NEGATIVE_SCROLL=i-e.scrollWidth-n.MAX_NEGATIVE_SCROLL},n.getDrawerTransform=function(e){var t=n.props.direction;return Ol(t)?{transform:"translate3d(0, "+e+"px, 0)"}:Al(t)?{transform:"translate3d(0, -"+e+"px, 0)"}:Dl(t)?{transform:"translate3d(-"+Math.abs(e)+"px, 0, 0)"}:Nl(t)?{transform:"translate3d("+e+"px, 0, 0)"}:null},n.getElementSize=function(){var e=n.props.direction;return Rl()?Ol(e)||Al(e)?window.innerHeight:window.innerWidth:null},n.shouldWeCloseDrawer=function(){var e=n.state.start,t=n.props.direction,i=0;return Nl(t)&&(i=n.drawer.scrollWidth),n.MOVING_POSITION!==i&&(Nl(t)?n.NEW_POSITION<i&&n.MOVING_POSITION-e>n.SCROLL_TO_CLOSE:Dl(t)||Al(t)?n.NEW_POSITION>=i&&e-n.MOVING_POSITION>n.SCROLL_TO_CLOSE:n.NEW_POSITION>=i&&n.MOVING_POSITION-e>n.SCROLL_TO_CLOSE)},n.hideDrawer=function(){var e=n.props,t=e.allowClose,i=e.onRequestClose,r=e.direction,o=0;return Nl(r)&&(o=n.drawer.scrollWidth),!1===t?n.setState((function(){return{position:o,thumb:0,touching:!1}})):(n.setState((function(){return{position:o,touching:!1}})),n.removeListeners(),i(),null)},n.release=function(e){var t=n.props.direction;if(n.setState((function(){return{touching:!1}})),n.shouldWeCloseDrawer())n.hideDrawer();else{var i=0;Nl(t)&&(i=n.drawer.scrollWidth),n.setState((function(){return{position:i}}))}},n.drag=function(e){var t=n.props.direction,i=n.state,r=i.thumb;i.start;var o=i.position,a=e.touches[0],s=a.pageY,c=a.pageX,l=Ol(t)||Al(t)?s:c,u=l-r,d=Ol(t)?o+u:o-u;if(d>0&&n.ALLOW_DRAWER_TRANSFORM){e.preventDefault();var p=n.props,m=p.onDrag,f=p.notifyWillClose;m({newPosition:d}),n.MOVING_POSITION=l,n.NEW_POSITION=d;var h=0;Nl(t)&&(h=n.drawer.scrollWidth),d<h&&n.shouldWeCloseDrawer()?f(!0):f(!1),n.NEGATIVE_SCROLL<d&&n.setState((function(){return{thumb:l,position:h>0?Math.min(d,h):d}}))}},n.tap=function(e){var t=e.touches[0],i=t.pageY,r=t.pageX,o=n.props.direction,a=Ol(o)||Al(o)?i:r;n.NEW_POSITION=0,n.MOVING_POSITION=0,n.setState((function(){return{thumb:a,start:a,touching:!0}}))},n.removeListeners=function(){n.drawer&&(n.drawer.removeEventListener("touchend",n.release),n.drawer.removeEventListener("touchmove",n.drag),n.drawer.removeEventListener("touchstart",n.tap),n.setState({listenersAttached:!1}))},n.attachListeners=function(e){var t=n.props,i=t.dontApplyListeners,r=t.getModalRef,o=t.direction,a=n.state.listenersAttached;if(e&&!a&&!i){n.drawer=e,r(e),n.drawer.addEventListener("touchend",n.release),n.drawer.addEventListener("touchmove",n.drag),n.drawer.addEventListener("touchstart",n.tap);var s=0;Nl(o)&&(s=e.scrollWidth),n.setState({listenersAttached:!0,position:s},(function(){setTimeout((function(){n.drawer.style.display="none",n.drawer.offsetHeight,n.drawer.style.display=""}),300)}))}},n.inViewportChange=function(e){(0,n.props.inViewportChange)(e),n.ALLOW_DRAWER_TRANSFORM=e},n.preventDefault=function(e){return e.preventDefault()},n.stopPropagation=function(e){return e.stopPropagation()},n.state={open:t.open,thumb:0,start:0,position:0,touching:!1,listenersAttached:!1},n}return gn(n,e),n.prototype.componentDidUpdate=function(e,t){var n=this,i=this.props.open;!i&&e.open&&(this.removeListeners(),setTimeout((function(){n.setState((function(){return{open:!1}}))}),300)),this.drawer&&this.getNegativeScroll(this.drawer);var r=this.props.onOpen;i&&!e.open&&(r(),this.setState((function(){return{open:!0}})))},n.prototype.componentWillUnmount=function(){this.removeListeners()},n.prototype.getPosition=function(e){var t=this.state.position;return Nl(this.props.direction)?e-t:t},n.prototype.render=function(){var e,n=this.props;n.containerElementClass;var i=n.containerOpacity;n.dontApplyListeners;var r=n.id,o=n.getContainerRef;n.getModalRef;var a=n.direction,s=n.height,c=n.width,l=n.hasDimensions,u=this.state.open&&this.props.open;if(!this.state.open&&!this.props.open||!Rl())return null;this.state.touching;var d=this.getElementSize(),p=this.getPosition(d),m={backgroundColor:"rgba(55, 56, 56, "+(u?i:0)+")",position:l?"absolute":"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",flexShrink:0,alignItems:"center",zIndex:1011,width:c,height:s};return Nl(a)&&Object.assign(m,{overflowX:"hidden"}),on(t.createElement("div",{id:r,style:m,onClick:this.hideDrawer,ref:o},t.createElement(fn,{style:{position:"absolute",top:0,height:1,width:"100%"},onChange:this.inViewportChange}),t.createElement("div",{onClick:this.stopPropagation,style:this.getDrawerTransform(u?p:d),ref:this.attachListeners,className:this.props.modalElementClass.toString()||""},this.props.children)),(null===(e=document.getElementById("dyte-shadow"))||void 0===e?void 0:e.shadowRoot.getElementById("dyte-base-elem"))||document.getElementById("dyte-base-elem")||window.document.body)},n.defaultProps={id:"dyte-client-drawer",notifyWillClose:function(){},onOpen:function(){},onDrag:function(){},inViewportChange:function(){},onRequestClose:function(){},getContainerRef:function(){},getModalRef:function(){},containerOpacity:.6,direction:"bottom",parentElement:null,allowClose:!0,dontApplyListeners:!1,containerElementClass:"",modalElementClass:""},n}(s),zl=function(e){var o,a,s=e.isOpen,c=e.onClose,l=e.view,u=n(0),p=u[0],m=u[1],f=r(ua),h=f.meeting,g=f.sessionConfig;d((function(e){return e.room.roomViewType}));var v=h.modules.getAll(),y=g.theme.control_bar.elements.chat?0:1,b=y+(g.theme.control_bar.elements.participants?0:1),E=b+(g.theme.control_bar.elements.polls?0:1),w=E+(g.theme.control_bar.elements.plugins?0:1),S=function(e){if(e===tl.Chat)m(0);else if(e===tl.Participants)m(1-y);else if(e===tl.Polls)m(2-b);else if(e===tl.Plugins)m(3-E);else{var t=v.filter((function(e){return!e.hidden})).findIndex((function(e){return e.sidebarComponent.name}));m(4+t-w)}};i((function(){l&&S(l)}),[l]);var _=Hi(),k=(null===(o=g.theme)||void 0===o?void 0:o.dimensions)||_,C=k.height,x=k.width;return t.createElement(Ml,{open:s,modalElementClass:"dyte-client-mobileDrawer",onRequestClose:function(){return c()},height:C,width:x,hasDimensions:!!(null===(a=g.theme)||void 0===a?void 0:a.dimensions)},t.createElement(Se,{height:"100%",display:"flex",flexDir:"column",variant:"solid-rounded",index:p,onChange:function(e){return m(e)}},t.createElement(je,{mb:2,px:4,pt:2,dislay:"flex",justifyContent:"space-between"},t.createElement(L,null,g.theme.control_bar.elements.chat&&t.createElement(Be,{backgroundColor:"transparent",_selected:{backgroundColor:"secondary.800"}},t.createElement(U,{as:Dt,fill:"text.100",boxSize:6})),g.theme.control_bar.elements.participants&&t.createElement(Be,{backgroundColor:"transparent",_selected:{backgroundColor:"secondary.800"}},t.createElement(U,{as:Nt,fill:"text.100",boxSize:6})),g.theme.control_bar.elements.polls&&t.createElement(Be,{backgroundColor:"transparent",_selected:{backgroundColor:"secondary.800"}},t.createElement(U,{as:St,fill:"text.100",boxSize:6})),g.theme.control_bar.elements.plugins&&t.createElement(Be,{backgroundColor:"transparent",_selected:{backgroundColor:"secondary.800"}},t.createElement(U,{as:no,fill:"primary.500",boxSize:6})),!uo()&&v.map((function(e){return!e.hidden&&t.createElement(Be,{backgroundColor:"transparent",_selected:{backgroundColor:"secondary.800"}},e.icon)}))),t.createElement(P,{px:"1em",py:"0.5em",onClick:function(){return c()},cursor:"pointer"},t.createElement(U,{as:at,fill:"text.100",boxSize:6}))),t.createElement(Y,null),t.createElement(_e,{height:"100%",maxH:"90%",flex:1,display:"flex",flexDirection:"column"},g.theme.control_bar.elements.chat&&t.createElement(ke,{height:"100%",flex:1},t.createElement(Xc,{openSidebarView:S,active:0===p})),g.theme.control_bar.elements.participants&&t.createElement(ke,{height:"100%",flex:1},t.createElement(el,null)),g.theme.control_bar.elements.polls&&t.createElement(ke,{height:"100%",flex:1},t.createElement(Bc,{active:2===p})),g.theme.control_bar.elements.plugins&&t.createElement(ke,{height:"100%",flex:1},t.createElement(ol,{openSidebarView:S})),!uo()&&v.map((function(e){return!e.hidden&&t.createElement(ke,{height:"100%",flex:1},t.createElement(e.sidebarComponent.component,null))})))))},Ll=t.memo((function(e){var o,a,s,c,l,u,p,m,f=M(),h=f.isOpen,g=f.onClose,v=f.onOpen,y=e.roomName,b=r(ua),E=b.sessionConfig,w=b.meeting,S=d((function(e){return e.room.roomDisplayTitle})),_=d((function(e){return e.plugin.main})),k=M(),C=k.isOpen,x=k.onClose,T=k.onOpen,I=n(tl.None),A=I[0],O=I[1],D=Hi(),N=(null===(a=E.theme)||void 0===a?void 0:a.dimensions)||D,R=N.height,j=N.width,B=n(null),F=B[0],V=B[1],W=n(null),U=W[0],q=W[1],H=z(window.location.href.replace("/stage/","/join/")),G=H.onCopy,J=H.hasCopied,Y=j<1024,Z=function(e){if(e===A)return O(tl.None),w.activeSidebarTab=tl.None,void(Y||x());O(e),Y||T(),w.activeSidebarTab=e};i((function(){A!==tl.None&&(Y?x():T())}),[Y]);var Q=380;j<=1400&&(Q=300);var X=j>R,$=uo()&&X;$&&(j=(o=[R,j])[0],R=o[1]);var ee=C?j-Q:j;null===(c=((null===(s=document.getElementById("dyte-shadow"))||void 0===s?void 0:s.shadowRoot)||document).getElementById("dyte-base-elem"))||void 0===c||c.style.setProperty("--dyte-main-width",ee+"px");var te=j<480?42:72,ne=R-((null===(l=E.theme)||void 0===l?void 0:l.control_bar.is_enabled)?te:0),ie=R-((null===(u=E.theme)||void 0===u?void 0:u.header.is_enabled)?40:0),re="rotate("+($?-90:0)+"deg)",oe=Math.floor(j/2)+"px "+Math.floor(j/2)+"px",ae={position:"absolute",zIndex:10,top:E.theme.header.is_enabled?40:0,left:0,width:"var(--dyte-main-width)",height:"calc("+ie+"px - var(--dyte-controlbar-height))"};i((function(){w&&(w.grid.setOverlay=function(e,n){V(null==e?null:"string"==typeof e?t.createElement("div",{style:ae,dangerouslySetInnerHTML:{__html:e}}):t.createElement("div",{style:ae},e)),n&&setTimeout((function(){V(null)}),n)},w.createPopup=function(e){q(e)},w.openChatView=function(){A!==tl.Chat&&Z(tl.Chat)},w.closeChatView=function(){A===tl.Chat&&Z(tl.Chat)})}),[w,A]);var se=t.createElement(Cs,{isOpen:!!U,onClose:function(){return q(null)}},U);return t.createElement(L,{direction:"column",bg:"secondary.900",height:R,width:j,transform:re,transformOrigin:oe},t.createElement(L,{direction:"row"},t.createElement(Pl,null),t.createElement(L,{direction:"column",width:ee},se,F,t.createElement(Rc,{isOpen:h,onClose:g}),(null===(p=E.theme)||void 0===p?void 0:p.header.is_enabled)&&t.createElement(Nc,{title:""!==S?S:y,linkCopied:J,copyLink:G,isMobile:Y}),t.createElement(P,{position:"relative"},t.createElement(kl,{isMobile:Y}),t.createElement(ec,null,t.createElement(Sc,{widthOffset:C?Q:0,singleSpeakerView:_.length>0&&!Y})),t.createElement(Sl,null),t.createElement(K,null))),t.createElement(P,{bg:"secondary.1000",display:C?"unset":"none",zIndex:"1",height:ne,width:C?Q:0},t.createElement(sl,{activeTab:A,openSidebarView:Z}))),(null===(m=E.theme)||void 0===m?void 0:m.control_bar.is_enabled)&&t.createElement(vl,{sidebarView:A,isSidebarOpen:C,openSidebarView:Z,linkCopied:J,copyLink:G,isMobile:Y,leaveCall:v}),Y&&t.createElement(zl,{isOpen:A!==tl.None,view:A,onClose:function(){return Z(A)}}),t.createElement(yl,null),t.createElement(_l,{isMobile:Y}),t.createElement(Il,{isMobile:Y}))}));function jl(){var e,n,i=d((function(e){return e.room.roomDisplayTitle})),o=d((function(e){return e.room.roomName})),a=z(window.location.href.replace("/stage/","/join/")),s=a.onCopy,c=a.hasCopied,l=r(ua).sessionConfig,u=Hi(),p=(null===(n=l.theme)||void 0===n?void 0:n.dimensions)||u,m=p.height,f=p.width,h=f<1024,g=d((function(e){return e.participant.videoTrackSelection})),v=d((function(e){return e.participant.audioTrackSelection})),y=d((function(e){return e.participant.speakerTrackSelection})),b=r(Ka),E=b.mediaTracks,w=E.webcamTrack,S=E.audioTrack,_=b.inputDevices,k=_.toggleAudioState,C=_.toggleVideoState,x=_.audioInputDevices,T=_.videoInputDevices,I=_.speakerOutputDevices,A=_.onAudioInputChange,O=_.onVideoInputChange,D=_.onSpeakerOutputChange,N="danger.500",R="text.400",j=d((function(e){return e.participant.audioMuted})),B=d((function(e){return e.participant.videoOff})),F=M(),V=F.isOpen,W=F.onClose,q=F.onOpen,H=f>m,G=uo()&&H;G&&(f=(e=[m,f])[0],m=e[1]);var J="rotate("+(G?-90:0)+"deg)",Y=Math.floor(f/2)+"px "+Math.floor(f/2)+"px";return t.createElement(L,{direction:"column",bg:"secondary.1000",height:m,width:f,transform:J,transformOrigin:Y},t.createElement(Rc,{isOpen:V,onClose:W}),l.theme.header.is_enabled?t.createElement(Nc,{title:""!==i?i:o,linkCopied:c,copyLink:s,isMobile:h}):null,t.createElement(cc,{peers:[{isMe:!0,videoTrack:w,audioTrack:S,audioMuted:j,videoVisible:!B,metadata:null}],gridSize:1,waitingRoom:!0}),l.theme.waiting_room.enable_preview&&t.createElement(P,{className:"dyte-client-noSelect"},t.createElement(L,{position:"absolute",bottom:"0",width:"100%",justify:"center"},t.createElement(L,null,t.createElement(Mc,{onClick:k,icon:j?t.createElement(U,{as:Qe,fill:N}):t.createElement(U,{as:xt,fill:R}),label:j?"Mic Off":"Mic On",menu:[{title:"Input Microphone Device",options:x.map((function(e){return{children:e.label,key:e.deviceId,value:e.deviceId}})),defaultValue:null==v?void 0:v.selectedDeviceId,onChange:A},{title:"Output Speaker Device",options:I.map((function(e){return{children:e.label,key:e.deviceId,value:e.deviceId}})),defaultValue:null==y?void 0:y.selectedDeviceId,onChange:D}]}),t.createElement(Mc,{onClick:C,icon:B?t.createElement(U,{as:It,fill:N}):t.createElement(U,{as:Tt,fill:R}),label:B?"Video Off":"Video On",menu:[{title:"Camera Device",options:T.map((function(e){return{children:t.createElement(t.Fragment,null,e.label),key:e.deviceId,value:e.deviceId}})),defaultValue:null==g?void 0:g.selectedDeviceId,onChange:O}]}),t.createElement(Mc,{onClick:q,icon:t.createElement(U,{as:zt,fill:N}),label:"Leave"})))))}var Bl=function(){var e,o=d((function(e){return e.room.socketState})),s=d((function(e){return e.room.routerState})),c=d((function(e){return e.producers.activeProducers})).reduce((function(e,t){return Math.min(e,t.score)}),10),l=r(ua).sessionConfig,u=Hi(),p=(null===(e=l.theme)||void 0===e?void 0:e.dimensions)||u,m=p.width,f=p.height,h=d((function(e){return e.consumers.activeConsumers})),g=n(""),v=g[0],y=g[1],b=n(t.createElement(t.Fragment,null)),E=b[0],w=b[1],_=a(null),k=n(0),C=k[0],x=k[1],T=a(null),I=ln().t,P=function(){var e;h.length>0&&"connected"!==(null===(e=window.recvTransport)||void 0===e?void 0:e.connectionState)&&(y("We're facing issues connecting to the server."),w(t.createElement(S,{size:"lg"}))),x((function(e){return e+1}))};return i((function(){var e;if(T.current&&clearTimeout(T.current),h.length>0&&"connected"!==(null===(e=window.recvTransport)||void 0===e?void 0:e.connectionState)&&(_.current=setTimeout(P,1e4)),c<5||""!==v&&c<6){var n=uo()?". Please join from a desktop browser":"";y("You seem to be facing internet issues"+n),w(t.createElement(Me,{boxSize:"1em",as:Wt,color:"danger.500"}))}else o===Cn.DISCONNECTED?T.current=setTimeout((function(){y(I("Reconnecting")+" ..."),w(t.createElement(S,{size:"lg"}))}),1e3):s!==kn.LOADED?(y(I("Connecting")+"..."),w(t.createElement(S,{size:"lg"}))):(y(""),w(t.createElement(t.Fragment,null)))}),[c,o,h.length,C,s]),v?t.createElement(L,{width:m,height:f,justifyContent:"center",alignItems:"flex-end",position:"absolute"},t.createElement(Re,{status:"warning",padding:"0.75em 0.25em",width:"25em",opacity:"0.95",justifyContent:"center",borderRadius:"md",marginBottom:"5em",zIndex:"10"},E,t.createElement(Le,{lineHeight:"4",ml:4,color:"secondary.900"},v))):t.createElement(t.Fragment,null)},Fl=function(e){var r=n(null),o=r[0],a=r[1];return d((function(e){return e.participant.peerId})),d((function(e){return e.participant.displayName})),i((function(){var n=function(){},i=wa.onSafeInitialization((function(){En(void 0,void 0,void 0,(function(){return wn(this,(function(i){return n=wa.onPreCallTestResults((function(n,i){var r=n,o=i;if(n.connectionInfo&&(r="success",(o=n.connectionInfo).rtt=1e3*o.RTT,o.jitter=0),"success"===r){var s={speedIcon:t.createElement(U,{as:oo,color:"warning.500"}),qualityIcon:t.createElement(U,{as:oo,color:"warning.500"})};void 0!==o.fractionalLoss&&void 0!==o.jitter&&void 0!==o.rtt&&(o.fractionalLoss<.01&&o.jitter<150&&o.rtt<150?s.qualityIcon=t.createElement(U,{as:io,color:"success.500"}):o.fractionalLoss<.04&&o.jitter<300&&o.rtt<300?s.qualityIcon=t.createElement(U,{as:ro,color:"warning.500"}):s.qualityIcon=t.createElement(U,{as:ro,color:"danger.500"})),void 0!==o.throughput&&(o.throughput>2e3?s.speedIcon=t.createElement(U,{as:io,color:"success.500"}):o.throughput>1e3?s.speedIcon=t.createElement(U,{as:ro,color:"warning.500"}):s.speedIcon=t.createElement(U,{as:ro,color:"danger.500"})),a(s),e.onComplete(s)}})),[2]}))}))})),r=setTimeout((function(){a((function(e){return e||{speedIcon:t.createElement(U,{as:oo,color:"warning.500"}),qualityIcon:t.createElement(U,{as:oo,color:"warning.500"})}}))}),6e3);return function(){var e;clearTimeout(r),wa.removeInitializationListener(i),null===(e=wa.backend)||void 0===e||e.eventHandler.removeListener("precall_end",n)}}),[]),ca.hasFeature(Bi.INTERNAL_CALL_STATS)?t.createElement(P,{background:"secondary.800",px:4,py:1,borderRadius:5,userSelect:"none"},t.createElement(C,{justifyContent:"space-around",spacing:"0"},t.createElement(_,null,"Network"),t.createElement(C,{background:"secondary.700",px:4,py:1,borderRadius:5,flexGrow:.5,justifyContent:"space-around",spacing:"4"},t.createElement(C,{spacing:"3"},t.createElement(_,null,"Speed"),o?o.speedIcon:t.createElement(S,{color:"text.100",boxSize:4})),t.createElement(C,{spacing:"3"},t.createElement(_,null,"Quality"),o?o.qualityIcon:t.createElement(S,{color:"text.100",boxSize:4}))))):null},Vl=function(e){var n=e.children;return t.createElement(t.Fragment,null,n)},Wl=function(e){var n=e.modules,i=e.children;if(0===n.length)return t.createElement(t.Fragment,null,i);var r=n[0].contextComponent||Vl,o=n.slice(1);return t.createElement(r,null,t.createElement(Wl,{modules:o},i))};function Ul(e){var n,o=r(Ks).mediaRoom,a=d((function(e){return e.participant.displayName})),s=d((function(e){return e.participant.audioMuted})),c=d((function(e){return e.room.routerState})),l=d((function(e){return e.room.joined})),u=d((function(e){return e.plugin.initialized})),p=d((function(e){return e.room.waitingState})),m=e.roomName,f=r(ua),h=f.sessionConfig,g=f.meeting,v=Hi(),y=(null===(n=h.theme)||void 0===n?void 0:n.dimensions)||v,b=y.height,E=y.width;return i((function(){c===kn.LOADED&&(null==o||o.joinRoom(a,s))}),[c]),i((function(){p===xn.ACCEPTED&&(null==o||o.joinRoom(a,s))}),[p]),i((function(){l&&u&&(null==g||g.emit(g.Events.meetingJoined))}),[l,u]),l?p===xn.WAITING?t.createElement(jl,null):p===xn.REJECTED?t.createElement(w,{height:b,width:E,backgroundColor:"#202124",justify:"center",align:"center"},t.createElement(_,{color:"text.100",className:"dyte-client-noSelect"},"Host rejected you request")):t.createElement(Ll,{roomName:m}):t.createElement(Eo,{text:"This seems to be taking too long...",showTextAfter:10,showReloadButton:!0})}function ql(e){var o,s,c=u(),l=e.roomName,p=e.autoTune,m=d((function(e){return e.participant.peerId})),f=r(ua),h=f.meeting,g=f.sessionConfig,v=f.updatePreset,y=n(!0),b=y[0],E=y[1],S=Je("\nquery Session($roomName: String!, $password: String, $ipInformation: String) {\n\tsession(roomName: $roomName, password: $password) {\n\t  title,\n\t  roomNodeLink(ipInformation: $ipInformation),\n\t  roomName,\n\t  password\n\t}\n  }\n",{variables:{roomName:l,password:""}}),x=S[0],T=S[1],I=T.data,P=T.error,A=T.loading,O=ln().t,D=Hi(),N=(null===(o=g.theme)||void 0===o?void 0:o.dimensions)||D,R=N.height,M=N.width,z=r(He),j=r(Ka),B=j.setupStreams,V=j.audioPermission,W=j.videoPermission,U=d((function(e){return e.participant.authToken})),q=d((function(e){return e.participant.displayName}));d((function(e){return e.participant.email}));var H=d((function(e){return e.participant.userFetchError}));d((function(e){return e.participant.clientSpecificId}));var G=d((function(e){return e.room.presetFetched})),J=n(null);J[0];var Y=J[1],K=Fe("Input",{variant:"primary"}),Z=a(null),Q=g.permissions.produce.video.allow,X=new URLSearchParams;"undefined"!=typeof window&&(X=new URLSearchParams(window.location.search));var $=function(){var e=function(e){var t="";try{e&&(t=JSON.stringify(e))}catch(e){la.error("callstats_ip_failed",{})}z.setHeader("Authorization","Bearer "+U),x({variables:{roomName:l,password:"",ipInformation:t}})};ca.hasFeature(Bi.INTERNAL_CALL_STATS)?(Z.current=setTimeout(e,3e3),wa.onSafeInitialization((function(t){Z.current&&clearTimeout(Z.current),e(t)}))):e(null)},ee=function(){E(!1),$()};if(i((function(){c(ri(l)),c(On())}),[]),i((function(){G&&B()}),[G]),i((function(){W!==qa.INIT&&V!==qa.INIT&&(ca.hasFeature(Bi.INTERNAL_CALL_STATS)?(wa.initialize(m,q),wa.setRoomName(l)):wa.stallCallStats())}),[W,V]),i((function(){}),[I]),i((function(){U&&U!==localStorage.getItem("dyte-authtoken")&&(h.showSetupScreen||$(),v(l,U))}),[U]),i((function(){P&&(la.error("graphql_error",{error:P}),P.graphQLErrors[0].message.indexOf("No open session")>=0&&(null==h||h._onError("MEETING_NOTFOUND")))}),[P,h]),mo()&&!bo())try{if(Number.parseFloat(lo())<14.3)return t.createElement(Eo,{loading:!1,text:"This browser is not supported on this version of iOS, please update to iOS 14.3 or newer"})}catch(e){}if(ho())return t.createElement(Eo,{loading:!1,text:"The current version of this browser is unsupported, please update the version or try another browser."});if(go()){var te=co();return t.createElement(Eo,{loading:!1,text:te+" is not supported, please try another browser."})}if(H)return t.createElement(Eo,{loading:!1,text:"Error occured while fetching user. Error: "+H.code+" "+H.message});if(V===qa.INIT||W===qa.INIT)return t.createElement(Eo,{text:O("Waiting for permissions")+"..."});if(P){var ne=P.graphQLErrors[0].message;return"UNAUTHORIZED"===ne?(la.trace("graphql_unauth"),t.createElement(Eo,{loading:!1,text:"You are not authorized to join this meeting"})):(null==ne?void 0:ne.indexOf("No open session"))>=0?t.createElement(Eo,{loading:!1,text:"The room is closed or doesn't exist. Please contact your adminstrator"}):t.createElement(Eo,{loading:!1,text:"Some error occured"})}return((null==h?void 0:h.showSetupScreen)||X.get("showSetupScreen"))&&b?t.createElement(L,{height:R,width:M,justifyContent:"center",backgroundColor:"secondary.1000"},t.createElement(Tl,{scroll:!0,shouldSetupStreams:!1,height:R},t.createElement(w,{justifyContent:"center",width:R>600?[.8*M,.8*M,.4*M,.25*M]:"fit-content"},t.createElement(Fl,{onComplete:function(e){return Y(e)}}),q&&!g.permissions.can_edit_display_name&&t.createElement(t.Fragment,null,t.createElement(_,{fontSize:"1.4em",color:"text.100",textAlign:"center"},O("Hi")," ",q)),g.permissions.can_edit_display_name&&t.createElement(t.Fragment,null,t.createElement(Ve,null,t.createElement(C,{justifyContent:"space-between"},t.createElement(We,null,t.createElement(C,null,t.createElement(_,null,O("Your name"))))),t.createElement(F,{type:"text",sx:K,value:q,onChange:function(e){return c(Qi(e.target.value))},autoComplete:"name",placeholder:"Steve Jobs",name:"displayName",autoFocus:!0,required:!0,isRequired:!0,onKeyDown:function(e){"Enter"===e.key&&""!==q.trim()&&ee()}}))),R>500&&M>768&&t.createElement(_,{mb:"20px !important",fontSize:"16",color:"text.300",textAlign:"center"},O(Q?"check_audio_video":"check_audio")),t.createElement(k,{autoFocus:!0,onClick:ee},O("Join"))))):A?t.createElement(Eo,{text:"Starting Meeting..."}):t.createElement(Ms,{url:null===(s=null==I?void 0:I.session)||void 0===s?void 0:s.roomNodeLink,roomURL:l,peerId:m},t.createElement(Zs,{peerId:m,roomName:l,autoTune:p},t.createElement(Us,null,t.createElement(pc,{roomName:l,peerId:m},t.createElement(Wl,{modules:h.modules.getAll()},t.createElement(Bl,null),t.createElement(Ul,{roomName:l}))))))}ql.defaultProps={autoTune:!0};var Hl,Gl=function(e){function n(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return gn(n,e),n.getDerivedStateFromError=function(e){return{hasError:!0}},n.prototype.componentDidCatch=function(e){la.error("caught_boundary_error",e)},n.prototype.render=function(){return this.state.hasError?t.createElement(Eo,{text:"Something went wrong.."}):this.props.children},n}(t.Component),Jl=function(e){var r=e.clientId,o=e.uiConfig,a=e.onInit,s=e.onError,c=e.lang,l=e.useShadowDom,u=e.meetingConfig,d=n(null),p=d[0],f=d[1],h=n(null),g=h[0],v=h[1],b=n(!1),E=b[0],w=b[1];return u||(u={roomName:"",authToken:""}),i((function(){var e,t={clientId:r,authToken:u.authToken,roomName:u.roomName,endpoints:[],lang:c};u.devicePreferences&&(t.devicePreferences=u.devicePreferences),(null==u?void 0:u.apiBase)&&Rr(u.apiBase);var n=new Ys(t,o);Hl=n,n.showSetupScreen=null===(e=u.showSetupScreen)||void 0===e||e;var i=y();la.trace("renderKey",i),v(i),f(n),n.on(n.Events.meetingEnded,(function(){return w(!0)})),n.onError((function(e){return s(e)})),a(n)}),[u.roomName,u.authToken,u.apiBase]),!p||E?null:t.createElement("div",{className:"dyte-client dyte-client-root",key:g},t.createElement("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css?family=Inter:400,500,600|Lato:300,400,600"}),t.createElement(Gs,{useShadowDom:l},t.createElement("div",{id:"dyte-base-elem"},t.createElement(Gl,null,t.createElement(m,{store:eo},t.createElement(He.Provider,{value:to(p.connectionConfig.apiBase)},t.createElement(da,{meeting:p},t.createElement(Za,null,t.createElement(ql,{roomName:u.roomName,autoTune:void 0===u.autoTune||u.autoTune})))))))))};function Yl(e,t){function n(e){return null!=e&&"object"==typeof e}var i=Object.keys(e||{}),r=Object.keys(t||{});if(i.length!==r.length)return!1;for(var o=0,a=i;o<a.length;o++){var s=e[d=a[o]],c=t[d];if((p=n(s)&&n(c))&&!Yl(s,c)||!p&&s!==c)return!1}for(var l=0,u=r;l<u.length;l++){var d,p;s=e[d=u[l]],c=t[d];if((p=n(s)&&n(c))&&!Yl(s,c)||!p&&s!==c)return!1}return!0}Jl.defaultProps={uiConfig:null,onError:function(e){},lang:null,useShadowDom:!1};var Kl,Zl=Object.assign(t.memo(Jl,(function(e,t){return!!Yl(t.meetingConfig,e.meetingConfig)&&(Yl(t.uiConfig,e.uiConfig)||Hl&&Hl.updateUIConfig(t.uiConfig),!0)})),{version:"0.37.0"});!function(e){e.CLIENTID_INVALID="CLIENTID_INVALID",e.MEETING_UNAUTHORIZED="MEETING_UNAUTHORIZED",e.MEETING_NOTFOUND="MEETING_NOTFOUND"}(Kl||(Kl={}));var Ql=Kl;export{Ql as DyteErrors,Zl as DyteMeeting,Ys as Meeting};
